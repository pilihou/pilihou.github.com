var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),BaseGameObject=function(t){function e(e){var i=t.call(this)||this;return i.originX=0,i.originY=0,i.originZ=0,i.trueY=0,i.armature=new DragonBonesArmatureContainer,i.addChild(i.armature),i.controller=e,i}return __extends(e,t),e.prototype.init=function(){this.hp=300,this.isDie=!1,App.TimerManager.doFrame(1,0,this.onFrame,this)},e.prototype.destory=function(){this.armature.stop(),App.TimerManager.remove(this.onFrame,this),App.DisplayUtils.removeFromParent(this),ObjectPool.push(this)},e.prototype.onFrame=function(t){this.update(t),this.setPos()},e.prototype.setPos=function(){this.$getX()!=this.originX&&this.$setX(this.originX),this.$getY()!=this.trueY&&this.$setY(this.trueY)},e.prototype.update=function(t){},e.prototype.registerArmature=function(t){},Object.defineProperty(e.prototype,"x",{get:function(){return this.originX},set:function(t){this.originX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.originY},set:function(t){this.originY=t,this.trueY=this.originY+this.originZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this.originZ},set:function(t){this.originZ=t,this.trueY=this.originY+this.originZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gameController",{get:function(){return this.controller},enumerable:!0,configurable:!0}),e.prototype.isMyFront=function(t){return 1==this.scaleX?this.x<=t.x:this.x>=t.x},e.prototype.isMyBack=function(t){return-1==this.scaleX?this.x<=t.x:this.x>=t.x},e.prototype.isMyLeft=function(t){return-1==this.scaleX?this.y<=t.y:this.y>=t.y},e.prototype.isMyRight=function(t){return 1==this.scaleX?this.y<=t.y:this.y>=t.y},e.prototype.isMyTop=function(t){return this.z>=t.z},e.prototype.isMyDown=function(t){return this.z<=t.z},e.ACTION_Idle="daiji",e.ACTION_Move="yidong",e.ACTION_Hart="beiji",e.ACTION_Fly="jifei",e.ACTION_Land="daodi",e.ACTION_jump="jump",e}(egret.DisplayObjectContainer);__reflect(BaseGameObject.prototype,"BaseGameObject");var BaseMoveGameObject=function(t){function e(e){var i=t.call(this,e)||this;return i.maxSpeedZ=30,i.gravitySpeed=1,i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.speed=0,this.speedX=0,this.speedY=0,this.speedZ=0,this.endX=0,this.endY=0,this.radian=0,this.alpha=1,this.isCommand=!1},e.prototype.destory=function(){t.prototype.destory.call(this)},e.prototype.update=function(e){t.prototype.update.call(this,e);var i="state_"+this.currState;this.currState&&this[i](e)},e.prototype.state_idle=function(t){},e.prototype.state_move=function(t){var e=this.speed/(1e3/60)*t;if(this.endX&&this.endY){this.radian=App.MathUtils.getRadian2(this.x,this.y,this.endX,this.endY),this.speedX=Math.cos(this.radian)*e,this.speedY=Math.sin(this.radian)*e*.65;var i=this.x+this.speedX,o=this.y+this.speedY;if((i<GameData.MIN_X||i>GameData.MAX_X||o<GameData.MIN_Y||o>GameData.MAX_Y)&&!this.isCommand)return void this.stopMove();var r=App.MathUtils.getDistance(this.x,this.y,this.endX,this.endY);if(r<Math.abs(this.speedX)+Math.abs(this.speedY))return void this.stopMove();this.x=i,this.y=o}else{this.speedX=Math.cos(this.radian)*e,this.speedY=Math.sin(this.radian)*e*.65;var i=this.x+this.speedX,o=this.y+this.speedY;(i<GameData.MIN_X||i>GameData.MAX_X)&&(i=this.x),(o<GameData.MIN_Y||o>GameData.MAX_Y)&&(o=this.y),this.x=i,this.y=o}},e.prototype.state_attack=function(t){this.speedZ?this.state_jump(t):this.speed&&this.state_move(t)},e.prototype.state_jump=function(t){this.speed&&this.state_move(t),this.speedZ>this.maxSpeedZ?this.speedZ=this.maxSpeedZ:this.speedZ+=this.gravitySpeed;var e=this.z+this.speedZ/(1e3/60)*t;e>0&&(e=0,this.stopJump()),this.z=e},e.prototype.state_land=function(t){this.isDie||(this.landTime+=t,this.landTime>=1500&&this.leave())},e.prototype.state_hurt=function(t){this.speedZ||this.z<0?this.state_jump(t):this.speed&&this.state_move(t)},e.prototype.stopJump=function(){this.speedZ=0,this.isAttack||this.gotoLand(),this.isDie&&egret.Tween.get(this).to({alpha:0},2e3).call(function(){this.disappear(),this.destory()},this)},e.prototype.disappear=function(){},e.prototype.stopMove=function(){this.speed=0,this.isCommand=!1,this.isHurt||this.isAttack||0!=this.z||this.gotoIdle()},e.prototype.leave=function(){this.gotoIdle()},e.prototype.moveTo=function(t,e,i){this.speed=t,this.endX=e,this.endY=i,this.radian=0},e.prototype.walkTo=function(t,e,i){this.moveTo(t,e,i),this.scaleX=this.endX>=this.x?1:-1,this.gotoMove()},e.prototype.walk=function(t,e,i){this.speed=i,this.endX=0,this.endY=0,this.radian=Math.atan2(e,t),this.scaleX=t>0?1:-1,this.gotoMove()},e.prototype.moveToZ=function(t){this.speedZ=t},e.prototype.standLand=function(){this.speedZ=0,this.z=0},e.prototype.jump=function(t,e){void 0===e&&(e=0),this.speed=Math.abs(e),this.radian=Math.atan2(0,e>0?1:-1),this.endX=0,this.endY=0,this.speedZ=t,this.gotoJump()},e.prototype.gotoIdle=function(){this.speed=0,this.currState=e.STATE_IDLE,this.armature.play(e.ACTION_Idle,0)},e.prototype.gotoMove=function(){this.currState=e.STATE_MOVE,this.armature.play(e.ACTION_Move,0)},e.prototype.gotoAttack=function(){this.currState=e.STATE_ATTACK},e.prototype.gotoJump=function(){this.currState=e.STATE_JUMP},e.prototype.gotoLand=function(){this.landTime=0,this.currState=e.STATE_LAND,this.armature.play(e.ACTION_Land,1)},e.prototype.gotoHurtState=function(){this.currState=e.STATE_HURT},e.prototype.gotoHurt=function(){this.gotoHurtState(),this.armature.play(e.ACTION_Hart,1)},e.prototype.command_in=function(t,e,i){this.isCommand=!0,this.walkTo(t,e,i)},Object.defineProperty(e.prototype,"isInScreen",{get:function(){return this.x>GameData.MIN_X&&this.x<GameData.MAX_X&&this.y>GameData.MIN_Y&&this.y<GameData.MAX_Y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isIdle",{get:function(){return this.currState==e.STATE_IDLE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAttack",{get:function(){return this.currState==e.STATE_ATTACK},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMove",{get:function(){return this.currState==e.STATE_MOVE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isJump",{get:function(){return this.currState==e.STATE_JUMP},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLand",{get:function(){return this.currState==e.STATE_LAND},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHurt",{get:function(){return this.currState==e.STATE_HURT},enumerable:!0,configurable:!0}),e.STATE_IDLE="idle",e.STATE_MOVE="move",e.STATE_ATTACK="attack",e.STATE_JUMP="jump",e.STATE_LAND="land",e.STATE_HURT="hurt",e}(BaseGameObject);__reflect(BaseMoveGameObject.prototype,"BaseMoveGameObject");var BaseAIGameObject=function(t){function e(e){var i=t.call(this,e)||this;return i.move_time=3e3,i.attack_time=3e3,i.ai_attack_dis=[100,0,30,30,0,0],i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.move_time=App.RandomUtils.limitInteger(2e3,5e3),this.attack_time=App.RandomUtils.limitInteger(2e3,4e3),this.ai_attack_dis=[100,0,30,30,0,0],this.ai_currTime=0,this.isAi=!0},e.prototype.destory=function(){t.prototype.destory.call(this)},e.prototype.isCanAttack=function(){return this.attackObj=this.gameController.getMyAttackObjects(this,this.ai_attack_dis)[0],null!=this.attackObj},e.prototype.update=function(e){if(t.prototype.update.call(this,e),this.isAi&&!this.isCommand){var i="state_"+this.currAiState;this.currAiState&&(this.ai_currTime+=e,this[i](e))}},e.prototype.state_ai_none=function(t){},e.prototype.state_ai_idle=function(t){this.isCanAttack()?this.ai_currTime>=this.attack_time&&this.gotoAttack():this.ai_currTime>=this.move_time&&this.aiMove()},e.prototype.state_ai_move=function(t){this.isCanAttack()&&(this.stopMove(),this.gotoAttack())},e.prototype.state_ai_attack=function(t){},e.prototype.gotoIdle=function(){t.prototype.gotoIdle.call(this),this.isAi&&this.gotoAiIdle()},e.prototype.gotoMove=function(){t.prototype.gotoMove.call(this),this.isAi&&this.gotoAiMove()},e.prototype.gotoAttack=function(){t.prototype.gotoAttack.call(this),this.isAi&&(this.gotoAiAttack(),this.attackObj&&(this.scaleX=this.attackObj.x>=this.x?1:-1))},e.prototype.gotoHurt=function(){t.prototype.gotoHurt.call(this),this.isAi&&this.stopAi()},e.prototype.gotoJump=function(){t.prototype.gotoJump.call(this),this.isAi&&this.stopAi()},e.prototype.gotoLand=function(){t.prototype.gotoLand.call(this),this.isAi&&this.stopAi()},e.prototype.leave=function(){t.prototype.leave.call(this),this.isAi&&this.moveRandom()},e.prototype.stopMove=function(){t.prototype.stopMove.call(this),this.ai_currTime=this.attack_time},e.prototype.gotoAiIdle=function(){this.ai_currTime=0,this.currAiState=e.STATE_AI_IDLE},e.prototype.gotoAiMove=function(){this.ai_currTime=0,this.currAiState=e.STATE_AI_MOVE},e.prototype.gotoAiAttack=function(){this.ai_currTime=0,this.currAiState=e.STATE_AI_ATTACK},e.prototype.stopAi=function(){this.ai_currTime=0,this.currAiState=e.STATE_AI_NONE},e.prototype.aiMove=function(){Math.random()>.7?this.moveRandom():this.moveToTarget()},e.prototype.moveToTarget=function(){var t,e,i=this.gameController.getMyNearAttackObjects(this);i.isMyFront(this)?t=i.x+this.scaleX*App.RandomUtils.limit(0,this.ai_attack_dis[0]):i.isMyBack(this)&&(t=i.x-this.scaleX*App.RandomUtils.limit(0,this.ai_attack_dis[1])),i.isMyLeft(this)?e=i.y-this.scaleX*App.RandomUtils.limit(0,this.ai_attack_dis[2]):i.isMyRight(this)&&(e=i.y+this.scaleX*App.RandomUtils.limit(0,this.ai_attack_dis[3])),this.walkTo(3,t,e)},e.prototype.moveRandom=function(){var t=App.RandomUtils.limit(GameData.MIN_X,GameData.MAX_X),e=App.RandomUtils.limit(GameData.MIN_Y,GameData.MAX_Y);this.walkTo(3,t,e)},e.STATE_AI_NONE="ai_none",e.STATE_AI_IDLE="ai_idle",e.STATE_AI_MOVE="ai_move",e.STATE_AI_ATTACK="ai_attack",e}(BaseMoveGameObject);__reflect(BaseAIGameObject.prototype,"BaseAIGameObject");var BaseEuiView=function(t){function e(e,i){var o=t.call(this)||this;return o._resources=null,o._controller=e,o._myParent=i,o._isInit=!1,o.percentHeight=100,o.percentWidth=100,o}return __extends(e,t),Object.defineProperty(e.prototype,"myParent",{get:function(){return this._myParent},enumerable:!0,configurable:!0}),e.prototype.setResources=function(t){this._resources=t},e.prototype.isInit=function(){return this._isInit},e.prototype.applyFunc=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this._controller.applyFunc.apply(this._controller,arguments)},e.prototype.applyControllerFunc=function(t,e){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];return this._controller.applyControllerFunc.apply(this._controller,arguments)},e.prototype.isShow=function(){return null!=this.stage&&this.visible},e.prototype.addToParent=function(){this._myParent.addChild(this)},e.prototype.removeFromParent=function(){App.DisplayUtils.removeFromParent(this)},e.prototype.initUI=function(){this._isInit=!0},e.prototype.initData=function(){},e.prototype.destroy=function(){this._controller=null,this._myParent=null,this._resources=null},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.loadResource=function(t,e){this._resources&&this._resources.length>0?(App.ResourceUtils.loadResource(this._resources,[],t,null,this),this.once(eui.UIEvent.CREATION_COMPLETE,e,this)):(t(),e())},e.prototype.setVisible=function(t){this.visible=t},e}(eui.Component);__reflect(BaseEuiView.prototype,"BaseEuiView",["IBaseView"]);var BaseHitGameObject=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.onAttack=function(){return this.isAttack?!1:(this.isMove&&this.stopMove(),this.stopAi(),!0)},e.prototype.loseHp=function(){var t=Math.random()>=.95,e=ObjectPool.pop("egret.Bitmap");e.alpha=1,this.x<50?e.x=this.x+App.RandomUtils.limit(0,100):this.x>App.StageUtils.getHeight()-50?e.x=this.x-App.RandomUtils.limit(0,100):e.x=this.x+(Math.random()>.5?App.RandomUtils.limit(0,100):-App.RandomUtils.limit(0,100)),e.y=this.y+this.z-100,AnchorUtil.setAnchorX(e,.5),e.texture=t?RES.getRes("losehp_baoji_png"):RES.getRes("losehp_png"),egret.Tween.get(e).to({y:this.y+this.z-300},1e3,egret.Ease.backOut).to({alpha:0,y:this.y+this.z-400},300).call(function(){App.DisplayUtils.removeFromParent(e),ObjectPool.push(e)},this),LayerManager.Game_Main.addChild(e),t?this.hp-=30:this.hp-=10,this.hp<=0&&this.die()},e.prototype.die=function(){this.isDie=!0,0==this.z&&(this.jump(-20,5),this.armature.play(BaseGameObject.ACTION_Fly,1))},e.prototype.fly=function(t,e,i){if(this.onAttack()){var o=this.x>t.x?1:-1;this.scaleX=t.isMyFront(this)?-t.scaleX:t.scaleX,this.jump(e,o*i),this.armature.play(BaseGameObject.ACTION_Fly,1)}this.loseHp()},e.prototype.hart=function(t,e,i){this.onAttack()&&(this.scaleX=t.isMyFront(this)?-t.scaleX:t.scaleX,this.moveTo(e,this.x-this.scaleX*i,this.y),this.gotoHurt()),this.loseHp()},e.prototype.hartFly=function(t,e,i){this.onAttack()&&(i?(this.moveTo(1,t.x,t.y),this.moveToZ(e)):this.moveToZ(e),0==this.z&&(this.scaleX=t.isMyFront(this)?-t.scaleX:t.scaleX,this.armature.play(BaseGameObject.ACTION_Fly,1),this.gotoHurtState())),this.loseHp()},e}(BaseAIGameObject);__reflect(BaseHitGameObject.prototype,"BaseHitGameObject");var starlingswf;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getTextField=function(t){return this.getChildByName(t)},e.prototype.getMovie=function(t){return this.getChildByName(t)},e.prototype.getSprite=function(t){return this.getChildByName(t)},e.prototype.getImage=function(t){return this.getChildByName(t)},e}(egret.DisplayObjectContainer);t.SwfSprite=e,__reflect(e.prototype,"starlingswf.SwfSprite")}(starlingswf||(starlingswf={}));var BasePanelView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.skinName="resource/skins/PanelSkin.exml",o}return __extends(e,t),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},set:function(t){this._icon=t,this.iconDisplay&&(this.iconDisplay.source=this._icon)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"btn",{get:function(){return this._btn},set:function(t){this._btn=t,this.button&&(this.button.source=this._btn)},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.closeBtnClickHandler,this)},e.prototype.initData=function(){t.prototype.initData.call(this),this.iconDisplay.source=this._icon,this.button.source=this._btn},e.prototype.closeBtnClickHandler=function(t){App.ViewManager.closeView(this)},e}(BaseEuiView);__reflect(BasePanelView.prototype,"BasePanelView");var BaseFrameGameObject=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.initFrameData=function(t){this.attackConfig=RES.getRes("attack_json")[t],this.attackConfig&&this.armature.addFrameCallFunc(this.armatureEventHandle,this)},e.prototype.armatureEventHandle=function(t){for(var e=t.eventObject.name,i=this.attackConfig[e].action||"",o=i.split(","),r=0,n=o.length;n>r;r++){var a=o[r].split("_"),s=a[0];a[0]=e,this[s].apply(this,a)}},e.prototype.frameEnemyHart=function(t,e,i,o){void 0===o&&(o="0");var r=this.attackConfig[t].dis,n=this.gameController.getMyAttackObjects(this,r);n.length&&"1"==o&&this.frameShock();for(var a=0,s=n.length;s>a;a++)n[a].hart(this,parseInt(e),parseInt(i))},e.prototype.frameEnemyFly=function(t,e,i,o){void 0===o&&(o="0");var r=this.attackConfig[t].dis,n=this.gameController.getMyAttackObjects(this,r);n.length&&"1"==o&&this.frameShock();for(var a=0,s=n.length;s>a;a++)n[a].fly(this,parseInt(e),parseInt(i))},e.prototype.frameEnemyHartMoveToZ=function(t,e,i){void 0===i&&(i="0");for(var o=this.attackConfig[t].dis,r=this.gameController.getMyAttackObjects(this,o),n=0,a=r.length;a>n;n++)r[n].hartFly(this,parseInt(e),1==parseInt(i))},e.prototype.frameThisMoveTo=function(t,e,i){this.moveTo(parseInt(e),this.x+this.scaleX*parseInt(i),this.y)},e.prototype.frameThisMoveToZ=function(t,e){this.moveToZ(parseInt(e))},e.prototype.frameThisStandLand=function(t){this.standLand()},e.prototype.frameShock=function(t){void 0===t&&(t=null),this.gameController.shock()},e}(BaseHitGameObject);__reflect(BaseFrameGameObject.prototype,"BaseFrameGameObject");var BaseSound=function(){function t(){this._cache={},this._loadingCache=new Array,App.TimerManager.doTimer(6e4,0,this.dealSoundTimer,this)}return t.prototype.dealSoundTimer=function(){for(var t=egret.getTimer(),e=Object.keys(this._cache),i=0,o=e.length;o>i;i++){var r=e[i];this.checkCanClear(r)&&t-this._cache[r]>=SoundManager.CLEAR_TIME&&(delete this._cache[r],RES.destroyRes(r))}},t.prototype.getSound=function(t){var e=RES.getRes(t);if(e)this._cache[t]&&(this._cache[t]=egret.getTimer());else{if(-1!=this._loadingCache.indexOf(t))return null;this._loadingCache.push(t),RES.getResAsync(t,this.onResourceLoadComplete,this)}return e},t.prototype.onResourceLoadComplete=function(t,e){var i=this._loadingCache.indexOf(e);-1!=i&&(this._loadingCache.splice(i,1),this._cache[e]=egret.getTimer(),this.loadedPlay(e))},t.prototype.loadedPlay=function(t){},t.prototype.checkCanClear=function(t){return!0},t}();__reflect(BaseSound.prototype,"BaseSound");var BaseEuiLayer=function(t){function e(){var e=t.call(this)||this;return e.percentWidth=100,e.percentHeight=100,e.touchEnabled=!1,e}return __extends(e,t),e}(eui.Group);__reflect(BaseEuiLayer.prototype,"BaseEuiLayer");var BaseScene=function(){function t(){this._layers=new Array}return t.prototype.onEnter=function(){},t.prototype.onExit=function(){App.ViewManager.closeAll(),this.removeAllLayer()},t.prototype.addLayer=function(t){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().addChild(t),this._layers.push(t)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().addChild(t),this._layers.push(t))},t.prototype.addLayerAt=function(t,e){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().addChildAt(t,e),this._layers.push(t)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().addChildAt(t,e),this._layers.push(t))},t.prototype.removeLayer=function(t){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1))},t.prototype.layerRemoveAllChild=function(t){t instanceof BaseSpriteLayer?t.removeChildren():t instanceof BaseEuiLayer&&t.removeChildren()},t.prototype.removeAllLayer=function(){for(;this._layers.length;){var t=this._layers[0];this.layerRemoveAllChild(t),this.removeLayer(t)}},t}();__reflect(BaseScene.prototype,"BaseScene");var BaseSpriteLayer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(BaseSpriteLayer.prototype,"BaseSpriteLayer");var BaseClass=function(){function t(){}return t.getInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;if(!i._instance){var o=t.length;0==o?i._instance=new i:1==o?i._instance=new i(t[0]):2==o?i._instance=new i(t[0],t[1]):3==o?i._instance=new i(t[0],t[1],t[2]):4==o?i._instance=new i(t[0],t[1],t[2],t[3]):5==o&&(i._instance=new i(t[0],t[1],t[2],t[3],t[4]))}return i._instance},t}();__reflect(BaseClass.prototype,"BaseClass");var starlingswf;!function(t){var e=function(e){function i(t,i,o,r){var n=e.call(this)||this;return n._isPlay=!1,n.loop=!0,n._completeFunction=null,n._frames=t,n._labels=i,n._displayObjects=o,n._startFrame=0,n._endFrame=n._frames.length-1,n._ownerSwf=r,n.setCurrentFrame(0),n.play(),n}return __extends(i,e),i.prototype.update=function(){if(this._isPlay)if(this._currentFrame>this._endFrame){if(this.hasCompleteListener()&&this.dispatchEventWith(egret.Event.COMPLETE),this._currentFrame=this._startFrame,!this.loop)return void(this._ownerSwf&&this.stop(!1));if(this._startFrame==this._endFrame)return void(this._ownerSwf&&this.stop(!1));this.setCurrentFrame(this._startFrame)}else this.setCurrentFrame(this._currentFrame),this._currentFrame+=1},i.prototype.setCurrentFrame=function(e){this.$children.length=0,this._currentFrame=e,this.__frameInfos=this._frames[this._currentFrame];for(var i,o,r,n,a=this.__frameInfos.length,s=0;a>s;s++)i=this.__frameInfos[s],n=i[10],o=this._displayObjects[i[0]][n],o.skewX=i[6],o.skewY=i[7],o.alpha=i[8],o.name=i[9],o.x=i[2],o.y=i[3],i[1]==t.Swf.dataKey_Scale9?(o.width=i[11],o.height=i[12]):(o.scaleX=i[4],o.scaleY=i[5]),this.$children.push(o),o.$parent=this,i[1]==t.Swf.dataKey_TextField&&(r=o,r.width=i[11],r.height=i[12],r.textColor=i[14],r.size=i[15],r.textAlign=i[16],i[19]&&"\r"!=i[19]&&""!=i[19]&&(r.text=i[19]))},i.prototype.getCurrentFrame=function(){return this._currentFrame},i.prototype.play=function(){this._isPlay=!0,this._ownerSwf.swfUpdateManager.addSwfAnimation(this);var e,i,o;for(e in this._displayObjects)if(0==e.indexOf(t.Swf.dataKey_MovieClip)){i=this._displayObjects[e],o=i.length;for(var r=0;o>r;r++)i[r].play()}},i.prototype.stop=function(e){if(void 0===e&&(e=!0),this._isPlay=!1,this._ownerSwf.swfUpdateManager.removeSwfAnimation(this),e){var i,o,r;for(i in this._displayObjects)if(0==i.indexOf(t.Swf.dataKey_MovieClip)){o=this._displayObjects[i],r=o.length;for(var n=0;r>n;n++)o[n].stop(e)}}},i.prototype.gotoAndStop=function(t,e){void 0===e&&(e=!0),this.goTo(t),this.stop(e)},i.prototype.gotoAndPlay=function(t){this.goTo(t),this.play()},i.prototype.goTo=function(t){if("string"==typeof t){var e=this.getLabelData(t);this._currentLabel=e[0],this._currentFrame=this._startFrame=e[1],this._endFrame=e[2]}else"number"==typeof t&&(this._currentFrame=this._startFrame=t,this._endFrame=this._frames.length-1);this.setCurrentFrame(this._currentFrame)},i.prototype.getLabelData=function(t){for(var e,i=this._labels.length,o=0;i>o;o++)if(e=this._labels[o],e[0]==t)return e;return null},i.prototype.isPlay=function(){return this._isPlay},i.prototype.totalFrames=function(){return this._frames.length},i.prototype.currentLabel=function(){return this._currentLabel},i.prototype.labels=function(){for(var t=this._labels.length,e=[],i=0;t>i;i++)e.push(this._labels[i][0]);return e},i.prototype.hasCompleteListener=function(){return this.hasEventListener(egret.Event.COMPLETE)},i.prototype.hasLabel=function(t){var e=this.labels();return!(-1==e.indexOf(t))},i.prototype.getLabelStartFrame=function(t){return this.getLabelData(t)[1]},i.prototype.getLabelEndFrame=function(t){return this.getLabelData(t)[2]},i}(t.SwfSprite);t.SwfMovieClip=e,__reflect(e.prototype,"starlingswf.SwfMovieClip",["starlingswf.ISwfAnimation"])}(starlingswf||(starlingswf={}));var BaseController=function(){function t(){this._messages={}}return t.prototype.registerFunc=function(t,e,i){this._messages[t]=[e,i]},t.prototype.applyFunc=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=this._messages[t];return o?o[0].apply(o[1],e):(Log.trace("消息"+t+"不存在侦听"),null)},t.prototype.applyControllerFunc=function(t,e){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];return App.ControllerManager.applyFunc.apply(App.ControllerManager,arguments)},t.prototype.setModel=function(t){this._model=t},t.prototype.getModel=function(){return this._model},t.prototype.getControllerModel=function(t){return App.ControllerManager.getControllerModel(t)},t}();__reflect(BaseController.prototype,"BaseController");var BaseModel=function(){function t(t){this._controller=t,this._controller.setModel(this)}return t}();__reflect(BaseModel.prototype,"BaseModel");var BaseProxy=function(){function t(t){this._controller=t}return t.prototype.applyFunc=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this._controller.applyFunc.apply(this._controller,arguments)},t.prototype.applyControllerFunc=function(t,e){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];return this._controller.applyControllerFunc.apply(this._controller,arguments)},t.prototype.receiveServerMsg=function(t,e,i){App.MessageCenter.addListener(t,e,i)},t.prototype.receiveServerMsgOnce=function(t,e,i){var o=function(r){this.removeServerMsg(t,o,this),e.apply(i,r)};this.receiveServerMsg(t,o,this)},t.prototype.receiveServerHttpUpdateMsg=function(t,e,i){this.receiveServerMsg(t+"_HttpUpdate",e,i)},t.prototype.receiveServerHttpUpdateMsgOnce=function(t,e,i){this.receiveServerMsgOnce(t+"_HttpUpdate",e,i)},t.prototype.removeServerMsg=function(t,e,i){App.MessageCenter.removeListener(t,e,i)},t.prototype.removeServerHttpUpdateMsg=function(t,e,i){this.removeServerMsg(t+"_HttpUpdate",e,i)},t.prototype.sendSocketMsg=function(t){App.Socket.send(t)},t.prototype.sendHttpMsg=function(t,e){void 0===e&&(e=null),App.Http.send(t,this.getURLVariables(t,e))},t.prototype.getURLVariables=function(t,e){var i=t.split("."),o={};o.mod=i[0],o["do"]=i[1],null!=e&&(o.p=e);var r=JSON.stringify(o),n=new egret.URLVariables("data="+r+"&h="+App.ProxyUserFlag);return n},t}();__reflect(BaseProxy.prototype,"BaseProxy");var BaseTaskView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.dataProvider=new eui.ArrayCollection,o}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this);var e=new eui.VerticalLayout;e.horizontalAlign="center",this.taskList=new eui.List,this.taskList.itemRenderer=TaskItemRenderer,this.taskList.itemRendererSkinName="resource/skins/TaskItemRendererSkin.exml",this.taskList.dataProvider=this.dataProvider,this.taskList.layout=e,this.scroller=new eui.Scroller,this.scroller.percentWidth=this.scroller.percentHeight=100,this.scroller.top=5,this.scroller.viewport=this.taskList,this.contentGroup.addChild(this.scroller)},e.prototype.initData=function(){t.prototype.initData.call(this)},e}(BasePanelView);__reflect(BaseTaskView.prototype,"BaseTaskView");var BaseSpriteView=function(t){function e(e,i){var o=t.call(this)||this;return o._resources=null,o._controller=e,o._myParent=i,o._isInit=!1,App.StageUtils.getStage().addEventListener(egret.Event.RESIZE,o.onResize,o),o}return __extends(e,t),e.prototype.setResources=function(t){this._resources=t},Object.defineProperty(e.prototype,"myParent",{get:function(){return this._myParent},enumerable:!0,configurable:!0}),e.prototype.isInit=function(){return this._isInit},e.prototype.applyFunc=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this._controller.applyFunc.apply(this._controller,arguments)},e.prototype.applyControllerFunc=function(t,e){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];return this._controller.applyControllerFunc.apply(this._controller,arguments)},e.prototype.isShow=function(){return null!=this.stage&&this.visible},e.prototype.addToParent=function(){this._myParent.addChild(this)},e.prototype.removeFromParent=function(){App.DisplayUtils.removeFromParent(this)},e.prototype.initUI=function(){this._isInit=!0},e.prototype.initData=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.destroy=function(){this._controller=null,this._myParent=null,this._resources=null},e.prototype.onResize=function(){},e.prototype.loadResource=function(t,e){this._resources&&this._resources.length>0?App.ResourceUtils.loadResource(this._resources,[],function(){t(),e()},null,this):(t(),e())},e.prototype.setVisible=function(t){this.visible=t},e}(egret.DisplayObjectContainer);__reflect(BaseSpriteView.prototype,"BaseSpriteView",["IBaseView"]);var ByteArrayMsg=function(){function t(){this._msgBuffer=new egret.ByteArray}return t.prototype.receive=function(t){t.readBytes(this._msgBuffer);var e=this.decode(this._msgBuffer);e&&App.MessageCenter.dispatch(e.key,e.body),0==this._msgBuffer.bytesAvailable&&this._msgBuffer.clear()},t.prototype.send=function(t,e){var i=this.encode(e);i&&(i.position=0,t.writeBytes(i,0,i.bytesAvailable))},t.prototype.decode=function(t){return Log.trace("decode需要子类重写，根据项目的协议结构解析"),null},t.prototype.encode=function(t){return Log.trace("encode需要子类重写，根据项目的协议结构解析"),null},t}();__reflect(ByteArrayMsg.prototype,"ByteArrayMsg",["BaseMsg"]);var UTFMsg=function(){function t(){}return t.prototype.receive=function(t){var e=t.readUTF(),i=this.decode(e);i&&App.MessageCenter.dispatch(i.key,i.body)},t.prototype.send=function(t,e){var i=this.encode(e);i&&(t.type=egret.WebSocket.TYPE_STRING,t.writeUTF(i))},t.prototype.decode=function(t){return Log.trace("decode需要子类重写，根据项目的协议结构解析"),null},t.prototype.encode=function(t){return Log.trace("encode需要子类重写，根据项目的协议结构解析"),null},t}();__reflect(UTFMsg.prototype,"UTFMsg",["BaseMsg"]);var Enemy=function(t){function e(e){var i=t.call(this,e)||this;return i.createArmature(),i}return __extends(e,t),e.prototype.createArmature=function(){this.armature.register(App.DragonBonesFactory.makeArmature("guaiwu001","guaiwu001",1.2),[BaseGameObject.ACTION_Idle,BaseGameObject.ACTION_Move,BaseGameObject.ACTION_Hart,BaseGameObject.ACTION_Fly,BaseGameObject.ACTION_Land,BaseGameObject.ACTION_jump,e.ACTION_Attack]),this.armature.addCompleteCallFunc(this.armaturePlayEnd,this),this.initFrameData("guaiwu001")},e.prototype.init=function(){t.prototype.init.call(this),this.gotoIdle()},e.prototype.disappear=function(){t.prototype.disappear.call(this),this.controller.applyFunc(GameConst.Remove_Enemy,this)},e.prototype.armaturePlayEnd=function(t,i){i==e.ACTION_Attack?this.gotoIdle():i==e.ACTION_Hart?this.gotoIdle():i==e.ACTION_Fly?this.armature.stop():i==e.ACTION_Land&&this.armature.stop()},e.prototype.gotoAttack=function(){t.prototype.gotoAttack.call(this),this.playAttackArmature()},e.prototype.playAttackArmature=function(){this.armature.play(e.ACTION_Attack,1),App.SoundManager.playEffect("sound_enemyAttack")},e.prototype.gotoLand=function(){t.prototype.gotoLand.call(this),this.isDie||(App.SoundManager.playEffect("sound_enenyLand"),this.gameController.shock())},e.prototype.fly=function(e,i,o){t.prototype.fly.call(this,e,i,o),App.SoundManager.playEffect("sound_beiji")},e.prototype.hart=function(e,i,o){t.prototype.hart.call(this,e,i,o),App.SoundManager.playEffect("sound_beiji")},e.prototype.hartFly=function(e,i,o){t.prototype.hartFly.call(this,e,i,o),App.SoundManager.playEffect("sound_beiji")},e.ACTION_Attack="gongji",e.ACTION_Skill1="jineng",e.ACTION_Skill2="jineng2",e}(BaseFrameGameObject);__reflect(Enemy.prototype,"Enemy");var Component=function(){function t(){}return t.prototype.start=function(){this.dealTime=0,this.dealInterval=0,this.isRuning=!0},t.prototype.stop=function(){this.dealTime=null,this.dealInterval=null,this.entity=null,this.isRuning=!1,this.type=null},t.prototype.update=function(t){},t}();__reflect(Component.prototype,"Component");var RpgGameObject=function(){function t(){this._components={}}return t.prototype.init=function(t){this.id=t.id,this.col=t.col,this.row=t.row,this.gameView=t.gameView,this.mcPath=t.mcPath,this.mcName=t.mcName,this.skillPath=t.skillPath,this.speed=t.speed||RpgGameData.WalkSpeed,this.dir=t.dir||Dir.Bottom,this.propertyData=t.propertyData;var e=RpgGameUtils.convertCellToXY(this.col,this.row);this.x=e.x,this.y=e.y,this.action=Action.Stand},t.prototype.destory=function(){for(var t=Object.keys(this._components);t.length;){var e=t[0];this.removeComponent(e),t=Object.keys(this._components)}this._path=null,this.gameView=null,this.battleObj=null,this.propertyData=null},t.prototype.addComponent=function(t){if(!this._components[t]){var e=ObjectPool.pop(t);
e.type=t,e.entity=this,e.start(),ComponentSystem.addComponent(e),this._components[t]=e}},t.prototype.removeComponent=function(t){var e=this._components[t];e&&(ComponentSystem.removeComponent(e),e.stop(),ObjectPool.push(e),this._components[t]=null,delete this._components[t])},t.prototype.getComponent=function(t){var e=this._components[t];return e},Object.defineProperty(t.prototype,"path",{get:function(){return this._path},set:function(t){this._path=t,this.pathChange=!0,this._path?this.action=Action.Move:this.action=Action.Stand},enumerable:!0,configurable:!0}),t.prototype.setInCamera=function(t){this._inCamera=t},t.prototype.getInCamera=function(){return this._inCamera},t}();__reflect(RpgGameObject.prototype,"RpgGameObject");var HttpConst=function(){function t(){}return t.USER_LOGIN="User.login",t}();__reflect(HttpConst.prototype,"HttpConst");var DynamicChange=function(){function t(){this._dataCache=[],this._pUpdate=new ProxyUpdate(this._dataCache)}return Object.defineProperty(t.prototype,"pUpdate",{get:function(){return this._pUpdate},enumerable:!0,configurable:!0}),t.prototype.getCacheData=function(t){return this._dataCache[t]?this._dataCache[t]:null},t.prototype.clearCache=function(){for(var t=Object.keys(this._dataCache),e=0,i=t.length;i>e;e++){var o=t[e];this._dataCache[o]=null,delete this._dataCache[o]}},t.prototype.getCacheKeyInfos=function(){for(var t=[],e=Object.keys(this._dataCache),i=0,o=e.length;o>i;i++){var r=e[i],n=this._dataCache[r];t.push(n)}return t},t.prototype.isCache=function(t){return this._dataCache[t]},t}();__reflect(DynamicChange.prototype,"DynamicChange");var ProxyUpdate=function(){function t(t){this._cache=t}return t.prototype.isArray=function(t){return t instanceof Array},t.prototype.isObject=function(t){return t.indexOf("object")>-1},t.prototype.isNormal=function(t){var e=t.indexOf("@")>-1,i=t.indexOf(".")>-1,o=t.indexOf("_")>-1;return!e&&!i&&!o},t.prototype.isAddToArray=function(t){return"@a"==t},t.prototype.isRemoveToArray=function(t){var e=t.split("_");return e.length<=3&&"@d"==e[0]},t.prototype.isFilter=function(t){var e=t.split("_");return"@f"==e[0]},t.prototype.isNumeric=function(t){return parseFloat(t).toString()==t.toString()},t.prototype._updateObject=function(t,e,i){var o=t.split(".");"@a"==o[0]||"@s"==o[0]?i[o[1]]=e:"@d"==o[0]&&delete i[o[1]]},t.prototype._getFilterObject=function(t,e){if(e){var i=t.split("_");if(3==i.length&&"@f"==i[0]&&this.isArray(e))for(var o=i[1],r=i[2],n=0;n<e.length;n++){var a=e[n];if(3==i.length&&this.isObject(a.toString())){var s=a[o];if(s&&("@"==r[0]&&(r=r.replace("@","")),r==s))return a}}}return null},t.prototype._addObjectToArray=function(t,e){if(this.isArray(e))for(var i=0;i<e.length;i++)t.push(e[i]);else t.push(e)},t.prototype._removeObjectFromArray=function(t,e,i){var o=e.split("_");if(o.length<=3&&"@d"==o[0]&&this.isArray(t))for(var r=t.length,n=r-1;n>=0;n--){var a=t[n];if(3==o.length){if(a.hasOwnProperty(o[1])){var s=o[2];"@"==s[0]&&(s=s.replace("@","")),s==a[o[1]]&&t.splice(n,1)}}else 2==o.length&&a.hasOwnProperty(o[1])?i==a[o[1]]&&t.splice(n,1):1==o.length&&i==a&&t.splice(n,1)}},t.prototype.update=function(t,e){if(this._cache[t]=e,e.hasOwnProperty("c"))for(var i=e.c,o=Object.keys(i),r=0,n=o.length;n>r;r++){var a=o[r];this._cache[a]&&(this._update(this._cache[a],i[a]),App.MessageCenter.dispatch(a+"_HttpUpdate"))}},t.prototype._update=function(t,e){if(t&&e&&this.isObject(e.toString()))for(var i=Object.keys(e),o=0,r=i.length;r>o;o++){var n=i[o],a=e[n];if(this.isNormal(n)&&this.isObject(a.toString()))t.hasOwnProperty(n)&&this._update(t[n],a);else if(this.isNormal(n)&&this.isNumeric(a)){var s=t[n];t[n]=s+a}else if(this.isNormal(n))t[n]=a;else if(this.isAddToArray(n))this._addObjectToArray(t,a);else if(this.isRemoveToArray(n))this._removeObjectFromArray(t,n,a);else if(this.isFilter(n)){var h=this._getFilterObject(n,t);h&&this._update(h,a)}else this._updateObject(n,a,t)}},t}();__reflect(ProxyUpdate.prototype,"ProxyUpdate");var Http=function(t){function e(){var e=t.call(this)||this;return e._data=new DynamicChange,e._cache=[],e._request=new egret.URLRequest,e._request.method=egret.URLRequestMethod.POST,e._urlLoader=new egret.URLLoader,e._urlLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,e.onError,e),e}return __extends(e,t),e.prototype.initServer=function(t){this._serverUrl=t},Object.defineProperty(e.prototype,"Data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.onError=function(t){this.nextPost()},e.prototype.send=function(t,e){this._cache.push([t,e]),this.post()},e.prototype.post=function(){if(!this._isRequesting&&0!=this._cache.length){var t=this._cache.shift(),e=t[0],i=t[1];this._type=e,this._request.url=this._serverUrl,this._request.data=i,this._urlLoader.addEventListener(egret.Event.COMPLETE,this.onLoaderComplete,this),this._urlLoader.load(this._request),this._isRequesting=!0}},e.prototype.onLoaderComplete=function(t){this._urlLoader.removeEventListener(egret.Event.COMPLETE,this.onLoaderComplete,this);var e=JSON.parse(this._urlLoader.data);e.hasOwnProperty("s")&&0!=e.s?Log.trace("Http错误:"+e.s):(this._data.pUpdate.update(this._type,e),App.MessageCenter.dispatch(this._type,e)),this.nextPost()},e.prototype.nextPost=function(){this._isRequesting=!1,this.post()},e}(BaseClass);__reflect(Http.prototype,"Http");var Keyboard=function(){function t(){}return t.LEFT=37,t.RIGHT=39,t.UP=38,t.DOWN=40,t.W=87,t.A=65,t.S=83,t.D=68,t.J=74,t.K=75,t.L=76,t.U=85,t.I=73,t.O=79,t.P=80,t.SPACE=32,t}();__reflect(Keyboard.prototype,"Keyboard");var ByteArrayMsgByProtobuf=function(t){function e(){var e=t.call(this)||this;e.msgClass=null,e.protoConfig=null,e.protoConfigSymmetry=null,e.msgClass={},e.protoConfig=App.ProtoConfig,e.protoConfigSymmetry={};for(var i=Object.keys(e.protoConfig),o=0,r=i.length;r>o;o++){var n=i[o],a=e.protoConfig[n];e.protoConfigSymmetry[a]=n}return e}return __extends(e,t),e.prototype.getMsgClass=function(t){var e=this.msgClass[t];return null==e&&(e=App.ProtoFile.build(t),this.msgClass[t]=e),e},e.prototype.getMsgID=function(t){return this.protoConfigSymmetry[t]},e.prototype.getMsgKey=function(t){return this.protoConfig[t]},e.prototype.decode=function(t){var e=t.readShort(),i=t.readShort();if(t.bytesAvailable>=i){var o=new egret.ByteArray;t.readBytes(o,0,i);var r={};return r.key=this.getMsgKey(e),App.DebugUtils.start("Protobuf Decode"),r.body=this.getMsgClass(r.key).decode(o.buffer),App.DebugUtils.stop("Protobuf Decode"),Log.trace("收到数据：","["+e+" "+r.key+"]",r.body),r}return null},e.prototype.encode=function(t){var e=this.getMsgID(t.key),i=new(this.getMsgClass(t.key))(t.body);App.DebugUtils.start("Protobuf Encode");var o=new egret.ByteArray(i.toArrayBuffer());App.DebugUtils.stop("Protobuf Encode"),Log.trace("发送数据：","["+e+" "+t.key+"]",t.body);var r=new egret.ByteArray;return r.writeShort(e),r.writeShort(o.length),r.writeBytes(o),r},e}(ByteArrayMsg);__reflect(ByteArrayMsgByProtobuf.prototype,"ByteArrayMsgByProtobuf");var Socket=function(t){function e(){var e=t.call(this)||this;return e._needReconnect=!1,e._maxReconnectCount=10,e._reconnectCount=0,e}return __extends(e,t),e.prototype.addEvents=function(){this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},e.prototype.removeEvents=function(){this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},e.prototype.onSocketOpen=function(){this._reconnectCount=0,this._isConnecting=!0,this._connectFlag&&this._needReconnect?App.MessageCenter.dispatch(SocketConst.SOCKET_RECONNECT):App.MessageCenter.dispatch(SocketConst.SOCKET_CONNECT),this._connectFlag=!0},e.prototype.onSocketClose=function(){this._isConnecting=!1,this._needReconnect?(App.MessageCenter.dispatch(SocketConst.SOCKET_START_RECONNECT),this.reconnect()):App.MessageCenter.dispatch(SocketConst.SOCKET_CLOSE)},e.prototype.onSocketError=function(){this._needReconnect?this.reconnect():App.MessageCenter.dispatch(SocketConst.SOCKET_NOCONNECT),this._isConnecting=!1},e.prototype.onReceiveMessage=function(t){this._msg.receive(this._socket)},e.prototype.initServer=function(t,e,i){this._host=t,this._port=e,this._msg=i},e.prototype.connect=function(){return App.DeviceUtils.IsHtml5&&!window.WebSocket?void Log.trace("不支持WebSocket"):(this._socket=new egret.WebSocket,this._msg instanceof ByteArrayMsg&&(this._socket.type=egret.WebSocket.TYPE_BINARY),Log.trace("WebSocket: "+this._host+":"+this._port),this.addEvents(),void this._socket.connect(this._host,this._port))},e.prototype.reconnect=function(){this.closeCurrentSocket(),this._reconnectCount++,this._reconnectCount<this._maxReconnectCount?this.connect():(this._reconnectCount=0,this._connectFlag?App.MessageCenter.dispatch(SocketConst.SOCKET_CLOSE):App.MessageCenter.dispatch(SocketConst.SOCKET_NOCONNECT))},e.prototype.send=function(t){this._msg.send(this._socket,t)},e.prototype.close=function(){this._connectFlag=!1,this.closeCurrentSocket()},e.prototype.closeCurrentSocket=function(){this.removeEvents(),this._socket.close(),this._socket=null,this._isConnecting=!1},e.prototype.isConnecting=function(){return this._isConnecting},e.prototype.debugInfo=function(t){App.MessageCenter.dispatch(SocketConst.SOCKET_DEBUG_INFO,t)},e}(BaseClass);__reflect(Socket.prototype,"Socket");var SocketConst=function(){function t(){}return t.SOCKET_CONNECT="SOCKET_CONNECT",t.SOCKET_RECONNECT="SOCKET_RECONNECT",t.SOCKET_START_RECONNECT="SOCKET_START_RECONNECT",t.SOCKET_CLOSE="SOCKET_CLOSE",t.SOCKET_DATA="SOCKET_DATA",t.SOCKET_NOCONNECT="SOCKET_NOCONNECT",t.SOCKET_DEBUG_INFO="SOCKET_DEBUG_INFO",t}();__reflect(SocketConst.prototype,"SocketConst");var BitmapNumber=function(t){function e(){var e=t.call(this)||this;return e._imgPool=[],e._containerPool=[],e}return __extends(e,t),e.prototype.createNumPic=function(t,e){var i,o=this.getContainer(),r=t.toString(),n=0;for(n;n<r.length;n++)i=this.getSingleNumPic(r.charAt(n),e),o.addChild(i);return this.repositionNumPic(o),o},e.prototype.desstroyNumPic=function(t){this.clearContainer(t),t.parent&&t.parent.removeChild(t),this._containerPool.push(t)},e.prototype.changeNum=function(t,e,i){var o=e.toString();if(t.numChildren>o.length)for(;t.numChildren>o.length;)this.recycleBM(t.getChildAt(t.numChildren-1));var r,n=0;for(n;n<o.length;n++)n>=t.numChildren&&t.addChild(this.getBitmap()),r=o.charAt(n),r="."==r?"dot":r,t.getChildAt(n).texture=this.getTexture(r,i);this.repositionNumPic(t)},e.prototype.repositionNumPic=function(t){var e,i=0,o=0;for(i;i<t.numChildren;i++)e=t.getChildAt(i),e.x=o,o=e.x+e.width},e.prototype.clearContainer=function(t){for(;t.numChildren;)this.recycleBM(t.removeChildAt(0))},e.prototype.recycleBM=function(t){t&&t.parent&&(t.parent.removeChild(t),t.texture=null,this._imgPool.push(t))},e.prototype.getContainer=function(){return this._containerPool.length?this._containerPool.shift():new egret.DisplayObjectContainer},e.prototype.getSingleNumPic=function(t,e){"."==t&&(t="dot");var i=this.getBitmap();return i.texture=this.getTexture(t,e),i},e.prototype.getTexture=function(t,e){return RES.getRes(e+t)},e.prototype.getBitmap=function(){return this._imgPool.length?this._imgPool.shift():new egret.Bitmap},e}(BaseClass);__reflect(BitmapNumber.prototype,"BitmapNumber");var UTFMsgByJson=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.decode=function(t){return JSON.parse(t)},e.prototype.encode=function(t){return JSON.stringify(t)},e}(UTFMsg);__reflect(UTFMsgByJson.prototype,"UTFMsgByJson");var HotspotBitmap=function(t){function e(){var e=t.call(this)||this;return e._hotspot=[],e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouch,e),e}return __extends(e,t),e.prototype.addHotspotArea=function(t,e,i,o){this._hotspot.push({rect:t,callBack:e,thisObj:i,para:o})},e.prototype.onTouch=function(t){for(var e,i=t.localX,o=t.localY,r=0;r<this._hotspot.length;r++)e=this._hotspot[r],e.rect.contains(i,o)&&(e.para?e.callBack.call(e.thisObj,e.para):e.callBack.call(e.thisObj))},e}(egret.Bitmap);__reflect(HotspotBitmap.prototype,"HotspotBitmap");var DragonBonesArmature=function(t){function e(e,i){var o=t.call(this)||this;return o._armature=e,o._clock=i,o.addChild(o._armature.display),o._completeCalls=[],o._frameCalls=[],o._isPlay=!1,o._playName="",o}return __extends(e,t),e.prototype.addListeners=function(){this._armature.eventDispatcher.addEvent(dragonBones.EventObject.COMPLETE,this.completeHandler,this),this._armature.eventDispatcher.addEvent(dragonBones.EventObject.FRAME_EVENT,this.frameHandler,this)},e.prototype.removeListeners=function(){this._armature.eventDispatcher.removeEvent(dragonBones.EventObject.COMPLETE,this.completeHandler,this),this._armature.eventDispatcher.removeEvent(dragonBones.EventObject.FRAME_EVENT,this.frameHandler,this)},e.prototype.completeHandler=function(t){for(var e=t.eventObject.animationState.name,i=0,o=this._completeCalls.length;o>i;i++){var r=this._completeCalls[i];r[0].apply(r[1],[t,e])}e==this._playName&&(this._playName="")},e.prototype.frameHandler=function(t){for(var e=0,i=this._frameCalls.length;i>e;e++){var o=this._frameCalls[e];o[0].apply(o[1],[t])}},e.prototype.play=function(t,e){return void 0===e&&(e=void 0),this._playName==t?this._currAnimationState:(this._playName=t,this.start(),void 0==e?this._currAnimationState=this.getAnimation().play(t):this._currAnimationState=this.getAnimation().play(t,e),this._currAnimationState)},e.prototype.start=function(){this._isPlay||(this._clock.add(this._armature),this._isPlay=!0,this.addListeners())},e.prototype.stop=function(){this._isPlay&&(this._clock.remove(this._armature),this._isPlay=!1,this._playName="",this.removeListeners())},e.prototype.destroy=function(){this.stop(),this.parent&&this.parent.removeChild(this),this.removeChildren(),this._armature=null,this._clock=null,this._completeCalls=null,this._frameCalls=null},e.prototype.addCompleteCallFunc=function(t,e){for(var i=0;i<this._completeCalls.length;i++){var o=this._completeCalls[i];if(o[0]==t&&o[1]==e)return}this._completeCalls.unshift([t,e])},e.prototype.removeCompleteCallFunc=function(t,e){for(var i=0;i<this._completeCalls.length;i++){var o=this._completeCalls[i];o[0]==t&&o[1]==e&&(this._completeCalls.splice(i,1),i--)}},e.prototype.addFrameCallFunc=function(t,e){for(var i=0;i<this._frameCalls.length;i++){var o=this._frameCalls[i];if(o[0]==t&&o[1]==e)return}this._frameCalls.push([t,e])},e.prototype.removeFrameCallFunc=function(t,e){for(var i=0;i<this._frameCalls.length;i++){var o=this._frameCalls[i];o[0]==t&&o[1]==e&&(this._frameCalls.splice(i,1),i--)}},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.stop()},e.prototype.getArmature=function(){return this._armature},e.prototype.getCurrAnimationState=function(){return this._currAnimationState},e.prototype.getClock=function(){return this._clock},e.prototype.getAnimation=function(){return this._armature.animation},e.prototype.getBone=function(t){return this._armature.getBone(t)},e.prototype.getPlayName=function(){return this._playName},e.prototype.getBoneDisplay=function(t){return t.slot.display},e.prototype.changeBone=function(t,e){var i=this.getBone(t);i&&i.slot.setDisplay(e)},e}(egret.DisplayObjectContainer);__reflect(DragonBonesArmature.prototype,"DragonBonesArmature");var DragonBonesArmatureContainer=function(t){function e(){var e=t.call(this)||this;return e.armatures=new Array,e.actions={},e.cacheBones={},e}return __extends(e,t),e.prototype.register=function(t,e){this.armatures.push(t);for(var i=0,o=e.length;o>i;i++)this.actions[e[i]]=this.armatures.length-1},Object.defineProperty(e.prototype,"armature",{get:function(){return this.armatures[this.currArmatureIndex]},enumerable:!0,configurable:!0}),e.prototype.getCacheBone=function(t){if(!this.cacheBones[t]){this.cacheBones[t]=[];for(var e=0,i=this.armatures.length;i>e;e++){var o=this.armatures[e];this.cacheBones[t].push(o.getBone(t))}}return this.cacheBones[t][this.currArmatureIndex]},e.prototype.play=function(t,e){if(void 0===e&&(e=void 0),null==this.actions[t])return void Log.trace("DragonBonesArmatureContainer不存在动作：",t);var i=this.actions[t];i!=this.currArmatureIndex&&this.remove();var o=this.armatures[i];return o?(this.addChild(o),this.currArmatureIndex=i,o.play(t,e)):null},e.prototype.stop=function(){var t=this.armatures[this.currArmatureIndex];t&&t.stop()},e.prototype.start=function(){var t=this.armatures[this.currArmatureIndex];t&&t.start()},e.prototype.remove=function(){var t=this.armatures[this.currArmatureIndex];t&&(t.stop(),App.DisplayUtils.removeFromParent(t),this.currArmatureIndex=null)},e.prototype.addCompleteCallFunc=function(t,e){for(var i=0,o=this.armatures.length;o>i;i++){var r=this.armatures[i];r.addCompleteCallFunc(t,e)}},e.prototype.removeCompleteCallFunc=function(t,e){for(var i=0,o=this.armatures.length;o>i;i++){var r=this.armatures[i];r.removeCompleteCallFunc(t,e)}},e.prototype.addFrameCallFunc=function(t,e){for(var i=0,o=this.armatures.length;o>i;i++){var r=this.armatures[i];r.addFrameCallFunc(t,e)}},e.prototype.removeFrameCallFunc=function(t,e){for(var i=0,o=this.armatures.length;o>i;i++){var r=this.armatures[i];r.removeFrameCallFunc(t,e)}},e.prototype.clear=function(){for(;this.armatures.length;){var t=this.armatures.pop();App.DisplayUtils.removeFromParent(t),t.destroy()}this.cacheBones={},this.actions={}},e.prototype.destroy=function(){this.clear(),this.armatures=null,this.cacheBones=null,this.actions=null},e}(egret.DisplayObjectContainer);__reflect(DragonBonesArmatureContainer.prototype,"DragonBonesArmatureContainer");var SceneManager=function(t){function e(){var e=t.call(this)||this;return e._scenes={},e}return __extends(e,t),e.prototype.clear=function(){var t=this._scenes[this._currScene];t&&(t.onExit(),this._currScene=void 0),this._scenes={}},e.prototype.register=function(t,e){this._scenes[t]=e},e.prototype.runScene=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=this._scenes[t];if(null==o)return void Log.trace("场景"+t+"不存在");var r=this._scenes[this._currScene];r&&r.onExit(),o.onEnter.apply(o,e),this._currScene=t},e.prototype.getCurrScene=function(){return this._currScene},e}(BaseClass);__reflect(SceneManager.prototype,"SceneManager");var DragonBonesFactory=function(t){function e(){var e=t.call(this)||this;return e.averageUtils=new AverageUtils,e.factory=new dragonBones.EgretFactory,e.clocks=new Array,e.clocksLen=0,e.files=[],e.start(),e}return __extends(e,t),e.prototype.initArmatureFile=function(t,e,i){-1==this.files.indexOf(t.name)&&(this.addSkeletonData(t),this.addTextureAtlas(e,i),this.files.push(t.name))},e.prototype.removeArmatureFile=function(t){var e=this.files.indexOf(t);-1!=e&&(this.removeSkeletonData(t),this.removeTextureAtlas(t),this.files.splice(e,1))},e.prototype.clear=function(){for(;this.files.length;)this.removeArmatureFile(this.files[0])},e.prototype.addSkeletonData=function(t){this.factory.parseDragonBonesData(t)},e.prototype.addTextureAtlas=function(t,e){this.factory.parseTextureAtlasData(e,t)},e.prototype.removeSkeletonData=function(t){this.factory.removeDragonBonesData(t)},e.prototype.removeTextureAtlas=function(t){this.factory.removeTextureAtlasData(t)},e.prototype.makeArmature=function(t,e,i){void 0===i&&(i=1);var o=this.factory.buildArmature(t,e);if(null==o)return Log.trace("不存在Armature： "+t),null;var r=this.createWorldClock(i),n=new DragonBonesArmature(o,r);return n},e.prototype.makeFastArmature=function(t,e,i){void 0===i&&(i=1);var o=this.makeArmature(t,e,i);return o.getArmature().cacheFrameRate=24,o},e.prototype.createWorldClock=function(t){for(var e=0;e<this.clocksLen;e++)if(this.clocks[e].timeScale==t)return this.clocks[e];var i=new dragonBones.WorldClock;return i.timeScale=t,this.clocks.push(i),this.clocksLen=this.clocks.length,i},e.prototype.onEnterFrame=function(t){this.averageUtils.push(t);for(var e=.001*this.averageUtils.getValue(),i=0;i<this.clocksLen;i++){var o=this.clocks[i];o.advanceTime(e)}},e.prototype.stop=function(){this.isPlay&&(App.TimerManager.remove(this.onEnterFrame,this),this.isPlay=!1)},e.prototype.start=function(){this.isPlay||(this.isPlay=!0,App.TimerManager.doFrame(1,0,this.onEnterFrame,this))},e}(BaseClass);__reflect(DragonBonesFactory.prototype,"DragonBonesFactory");var SoundBg=function(t){function e(){var e=t.call(this)||this;return e._currBg="",e}return __extends(e,t),e.prototype.stop=function(){this._currSoundChannel&&this._currSoundChannel.stop(),this._currSoundChannel=null,this._currSound=null,this._currBg=""},e.prototype.play=function(t){if(this._currBg!=t){this.stop(),this._currBg=t;var e=this.getSound(t);e&&this.playSound(e)}},e.prototype.playSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(0,1),this._currSoundChannel.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.loadedPlay=function(t){this._currBg==t&&this.playSound(RES.getRes(t))},e.prototype.checkCanClear=function(t){return this._currBg!=t},e}(BaseSound);__reflect(SoundBg.prototype,"SoundBg");var SoundEffects=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.play=function(t){var e=this.getSound(t);e&&this.playSound(e)},e.prototype.playSound=function(t){var e=t.play(0,1);e.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t},e.prototype.loadedPlay=function(t){this.playSound(RES.getRes(t))},e}(BaseSound);__reflect(SoundEffects.prototype,"SoundEffects");var SoundManager=function(t){function e(){var e=t.call(this)||this;return e.bgOn=!0,e.effectOn=!0,e.bgVolume=.5,e.effectVolume=.5,e.bg=new SoundBg,e.bg.setVolume(e.bgVolume),e.effect=new SoundEffects,e.effect.setVolume(e.effectVolume),e}return __extends(e,t),e.prototype.playEffect=function(t){this.effectOn&&this.effect.play(t)},e.prototype.playBg=function(t){this.currBg=t,this.bgOn&&this.bg.play(t)},e.prototype.stopBg=function(){this.bg.stop()},e.prototype.setEffectOn=function(t){this.effectOn=t},e.prototype.setBgOn=function(t){this.bgOn=t,this.bgOn?this.currBg&&this.playBg(this.currBg):this.stopBg()},e.prototype.setBgVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.bgVolume=t,this.bg.setVolume(this.bgVolume)},e.prototype.getBgVolume=function(){return this.bgVolume},e.prototype.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.effectVolume=t,this.effect.setVolume(this.effectVolume)},e.prototype.getEffectVolume=function(){return this.effectVolume},e.CLEAR_TIME=18e4,e}(BaseClass);__reflect(SoundManager.prototype,"SoundManager");var starlingswf;!function(t){var e=function(){function e(i,o,r){void 0===r&&(r=24),this._swfData=i,this._assetManager=o,this._createDisplayFuns=new Object,this._createDisplayFuns[e.dataKey_Sprite]=this.createSprite,this._createDisplayFuns[e.dataKey_MovieClip]=this.createMovie,this._createDisplayFuns[e.dataKey_Image]=this.createImage,this._createDisplayFuns[e.dataKey_Scale9]=this.createS9Image,this._createDisplayFuns[e.dataKey_ShapeImg]=this.createShapeImage,this._createDisplayFuns[e.dataKey_TextField]=this.createTextField,this.swfUpdateManager=t.SwfUpdateManager.createSwfUpdateManager(r)}return e.prototype.createSprite=function(i,o,r){void 0===o&&(o=null),void 0===r&&(r=null),null==r&&(r=this._swfData[e.dataKey_Sprite][i]);for(var n,a,s,h=new t.SwfSprite,p=r.length,l=0;p>l;l++)n=r[l],s=this._createDisplayFuns[n[1]],null!=s&&(a=s.apply(this,[n[0],n]),a.name=n[9],a.x=n[2],a.y=n[3],n[0]==e.dataKey_TextField,n[1]!=e.dataKey_Scale9&&n[1]!=e.dataKey_ShapeImg&&(a.scaleX=n[4],a.scaleY=n[5]),a.skewX=n[6],a.skewY=n[7],a.alpha=n[8],h.addChild(a));return h},e.prototype.createMovie=function(i,o,r){void 0===o&&(o=null),void 0===r&&(r=null);var n,a,s,h,p,l=this._swfData[e.dataKey_MovieClip][i],c=l.objCount,u={};for(p in c){a=c[p][0],s=c[p][1],n=null==u[p]?[]:u[p];for(var d=0;s>d;d++)h=this._createDisplayFuns[a],null!=h&&n.push(h.apply(this,[p,null]));u[p]=n}var g;return g=null==r?new t.SwfMovieClip(l.frames,l.labels,u,this):new r(l.frames,l.labels,u,this),g.loop=l.loop,g},e.prototype.createImage=function(t,i){void 0===i&&(i=null);var o=this._swfData[e.dataKey_Image][t],r=this._assetManager.createBitmap(t);return r.anchorOffsetX=o[0],r.anchorOffsetY=o[1],r},e.prototype.getTexture=function(t){return this._assetManager.getTexture(t)},e.prototype.createS9Image=function(t,i){void 0===i&&(i=null);var o=this._swfData[e.dataKey_Scale9][t],r=this._assetManager.createBitmap(t);return r.scale9Grid=new egret.Rectangle(o[0],o[1],o[2],o[3]),null!=i&&(r.width=i[10],r.height=i[11]),r},e.prototype.createShapeImage=function(t,e){void 0===e&&(e=null);var i=this._assetManager.createBitmap(t);return i.fillMode=egret.BitmapFillMode.REPEAT,null!=e&&(i.width=e[10],i.height=e[11]),i},e.prototype.createTextField=function(t,e){void 0===e&&(e=null);var i=new egret.TextField;return null!=e&&(i.width=e[10],i.height=e[11],i.textColor=e[13],i.size=e[14],i.textAlign=e[15],i.text=e[18]),i},e.prototype.hasSprite=function(t){return null!=this._swfData[e.dataKey_Sprite][t]},e.prototype.hasMovieClip=function(t){return null!=this._swfData[e.dataKey_MovieClip][t]},e.prototype.hasImage=function(t){return null!=this._swfData[e.dataKey_Image][t]},e.prototype.hasS9Image=function(t){return null!=this._swfData[e.dataKey_Scale9][t]},e.prototype.hasShapeImage=function(t){return null!=this._swfData[e.dataKey_ShapeImg][t]},e.dataKey_Sprite="spr",e.dataKey_Image="img",e.dataKey_MovieClip="mc",e.dataKey_TextField="text",e.dataKey_Button="btn",e.dataKey_Scale9="s9",e.dataKey_ShapeImg="shapeImg",e.dataKey_Component="comp",e.dataKey_Particle="particle",e}();t.Swf=e,__reflect(e.prototype,"starlingswf.Swf")}(starlingswf||(starlingswf={}));var starlingswf;!function(t){var e=function(){function t(){this._sheets={},this._textures={}}return t.prototype.addSpriteSheet=function(t,e){this._sheets[t]=e},t.prototype.addTexture=function(t,e){this._textures[t]=e},t.prototype.createBitmap=function(t){var e=this.getTexture(t);if(null==e)return null;var i=new egret.Bitmap;return i.texture=e,i},t.prototype.getTexture=function(t){var e,i,o;for(o in this._sheets)if(i=this._sheets[o],e=i.getTexture(t),null!=e)break;return null==e&&(e=this._textures[t]),e},t}();t.SwfAssetManager=e,__reflect(e.prototype,"starlingswf.SwfAssetManager")}(starlingswf||(starlingswf={}));var starlingswf;!function(t){var e=function(){function t(){}return t.createSwfUpdateManager=function(e){var i=new t;return i._animations=[],i._addQueue=[],i._removeQueue=[],i._currentTime=0,i.setFps(e),App.TimerManager.doFrame(1,0,i.update,i),i},t.prototype.clear=function(){this._addQueue.splice(0),this._removeQueue.splice(0),this._animations.splice(0)},t.prototype.stop=function(){this.clear(),App.TimerManager.remove(this.update,this)},t.prototype.play=function(){App.TimerManager.doFrame(1,0,this.update,this)},t.prototype.setFps=function(t){this._fps=t,this._fpsTime=1e3/t},t.prototype.addSwfAnimation=function(t){this._addQueue.push(t)},t.prototype.removeSwfAnimation=function(t){this._removeQueue.push(t);var e=this._addQueue.indexOf(t);-1!=e&&this._addQueue.splice(e,1)},t.prototype.updateAdd=function(){for(var t,e,i=this._addQueue.length,o=0;i>o;o++)e=this._addQueue.pop(),t=this._animations.indexOf(e),-1==t&&this._animations.push(e)},t.prototype.updateRemove=function(){for(var t,e,i=this._removeQueue.length,o=0;i>o;o++)e=this._removeQueue.pop(),t=this._animations.indexOf(e),-1!=t&&this._animations.splice(t,1)},t.prototype.update=function(t){if(this._currentTime+=t,!(this._currentTime<this._fpsTime)){this._currentTime-=this._fpsTime,this._update();for(var e=0;this._currentTime>this._fpsTime;)this._currentTime-=this._fpsTime,e++,4>e&&this._update()}},t.prototype._update=function(){this.updateRemove(),this.updateAdd();for(var t=this._animations.length,e=0;t>e;e++)this._animations[e].update()},t}();t.SwfUpdateManager=e,__reflect(e.prototype,"starlingswf.SwfUpdateManager")}(starlingswf||(starlingswf={}));var GuideMaskBackgroud=function(t){function e(){var e=t.call(this)||this;return e._stageWidth=0,e._stageHeight=0,e._bgs=new Array,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.init=function(t,e){this._stageWidth=t,this._stageHeight=e},e.prototype.draw=function(t){this.cacheAsBitmap=!1,this._deductRec=t,this.removeAllChild();var e=Math.max(t.x,0),i=Math.max(t.y,0),o=Math.min(t.x+t.width,this._stageWidth),r=Math.min(t.y+t.height,this._stageHeight);this.addBg(0,0,this._stageWidth,i),this.addBg(0,i,e,t.height),this.addBg(o,i,this._stageWidth-o,t.height),this.addBg(0,r,this._stageWidth,this._stageHeight-r),this.width=this._stageWidth,this.height=this._stageHeight,this.cacheAsBitmap=!0},e.prototype.destroy=function(){this.removeChildren(),this._bgs=[]},e.prototype.removeAllChild=function(){for(;this.numChildren;){var t=this.removeChildAt(0);this._bgs.push(t)}},e.prototype.addBg=function(t,e,i,o){var r;this._bgs.length?(r=this._bgs.pop(),r.graphics.clear()):r=new egret.Shape,r.graphics.beginFill(0,.5),r.graphics.drawRect(t,e,i,o),r.graphics.endFill(),this.addChild(r)},e.prototype.hitTest=function(t,e,i){return this._deductRec&&this._deductRec.contains(t,e)?null:this},e}(egret.Sprite);__reflect(GuideMaskBackgroud.prototype,"GuideMaskBackgroud");var GuideUtils=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.configData={1:{1:{txt:"点击这里，去设置宠物出战",txtdir:1,handDir:1},2:{txt:"点击选择一个宠物出战",txtdir:3,handDir:1},3:{txt:"点击宠物出战",txtdir:3,handDir:1}},2:{1:{txt:"更多宠物，可以抽取获得哦！",txtdir:1,handDir:2},2:{txt:"点击抽取宠物",txtdir:1,handDir:1}},3:{1:{txt:"点击选择另一个宠物",txtdir:1,handDir:1},2:{txt:"点击宠物出战",txtdir:3,handDir:1}},4:{1:{txt:"点击查看宠物属性",txtdir:4,handDir:1},2:{txt:"点击宠物升级",txtdir:1,handDir:2},3:{txt:"点击选择升级材料",txtdir:3,handDir:1},4:{txt:"选择一个宠物或卡牌作为材料",txtdir:3,handDir:1},5:{txt:"选择材料后点击确定回到升级界面",txtdir:1,handDir:2},6:{txt:"点击完成升级",txtdir:1,handDir:2}},5:{1:{txt:"现在立刻享受\n炫酷的飞行吧",txtdir:1,handDir:2},2:{txt:"每天前3次购买免费",txtdir:1,handDir:1},3:{txt:"开始战斗吧",txtdir:1,handDir:2}},6:{1:{txt:"点击这里查看战机",txtdir:1,handDir:1},2:{txt:"点击升级战机，\n可以提高战力",txtdir:1,handDir:2}}},e.currPart=0,e.currStep=0,e}return __extends(e,t),e.prototype.next=function(){null!=this.view&&null!=this.view.parent&&(this.currStep++,this.configData[this.currPart][this.currStep]||(this.currPart++,this.currStep=1),this.configData[this.currPart]||(this.currPart=0,this.currStep=0),this.hide())},e.prototype.show=function(t,e,i){this.currPart==e&&this.currStep==i&&(null==this.view&&(this.view=new GuideView),this.view.setData(t,this.configData[this.currPart][this.currStep]),egret.MainContext.instance.stage.addChild(this.view))},e.prototype.hide=function(){App.DisplayUtils.removeFromParent(this.view)},e.prototype.isShow=function(){return null!=this.view&&null!=this.view.parent},e}(BaseClass);__reflect(GuideUtils.prototype,"GuideUtils");var StarlingSwfFactory=function(t){function e(){var e=t.call(this)||this;return e.swfAssetsManager=new starlingswf.SwfAssetManager,e.swfAssetsNames=new Array,e.swfAssets=new Array,e.swfData={},e}return __extends(e,t),e.prototype.addSwf=function(t,e,i){if(-1==this.swfAssetsNames.indexOf(t)){if(null==e||null==i)return void console.log("SWF加载失败:"+t);this.swfAssetsManager.addSpriteSheet(t,i);var o=new starlingswf.Swf(e,this.swfAssetsManager,24);o.name=t,StarlingSwfUtils.addSwf(o),this.swfAssetsNames.push(t),this.swfAssets.push(o)}},e.prototype.stopSwfs=function(t){for(var e=0,i=t.length;i>e;e++){var o=StarlingSwfUtils.getSwf(t[e]);o&&o.swfUpdateManager.stop()}},e.prototype.playSwfs=function(t){for(var e=0,i=t.length;i>e;e++){var o=StarlingSwfUtils.getSwf(t[e]);o&&o.swfUpdateManager.play()
}},e.prototype.clearSwfs=function(){for(;this.swfAssets.length;)StarlingSwfUtils.removeSwf(this.swfAssets.pop());for(;this.swfAssetsNames.length;)this.swfAssetsNames.pop();this.swfAssetsManager=new starlingswf.SwfAssetManager},e.prototype.clear=function(){this.clearSwfs()},e.prototype.makeMc=function(t){var e=StarlingSwfUtils.createMovie("mc_"+t,null,StarlingSwfMovieClip);return null==e&&console.log("SWF创建失败: "+t),e},e.prototype.makeImage=function(t){return StarlingSwfUtils.createImage("img_"+t)},e.prototype.getTexture=function(t){return StarlingSwfUtils.getTexture("img_"+t)},e}(BaseClass);__reflect(StarlingSwfFactory.prototype,"StarlingSwfFactory");var StarlingSwfMovieClip=function(t){function e(e,i,o,r){var n=t.call(this,e,i,o,r)||this;return n.frameActions={},n.preFrame=-1,n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.onRemove,n),n}return __extends(e,t),e.prototype.onRemove=function(){this.stop()},e.prototype.setFrameAction=function(t,e,i,o){void 0===o&&(o=null),this.frameActions[t]=[e,i,o]},e.prototype.setCompleteAction=function(t,e){this.complateFunc=t,this.complateObj=e,this.addEventListener(egret.Event.COMPLETE,this.onPlayend,this)},e.prototype.onPlayend=function(){this.complateFunc&&this.complateFunc.call(this.complateObj)},e.prototype.goToPlay=function(t){this.preFrame=-1,this.currFrameName=t,this.gotoAndPlay(t)},e.prototype.setCurrentFrame=function(e){t.prototype.setCurrentFrame.call(this,e);var i=this.getCurrentFrame();if(this.preFrame!=i&&(this.preFrame=i,this.frameActions&&this.frameActions[i])){var o=this.frameActions[i];o[2]?o[0].call(o[1],o[2]):o[0].call(o[1])}},e.prototype.dispose=function(){this.stop(),this.removeEventListener(egret.Event.COMPLETE,this.onPlayend,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),App.DisplayUtils.removeFromParent(this),this.complateFunc=null,this.complateObj=null,this.frameActions=null},e}(starlingswf.SwfMovieClip);__reflect(StarlingSwfMovieClip.prototype,"StarlingSwfMovieClip");var StarlingSwfUtils=function(){function t(){}return t.addSwf=function(e){t.swfList.push(e)},t.removeSwf=function(e){var i=t.swfList.indexOf(e);-1!=i&&t.swfList.splice(i,1)},t.createSprite=function(e,i,o){void 0===i&&(i=null),void 0===o&&(o=null);for(var r=t.swfList.length,n=0;r>n;n++){var a=t.swfList[n];if(a.hasSprite(e))return a.createSprite(e,i,o)}return null},t.createImage=function(e,i){void 0===i&&(i=null);for(var o=t.swfList.length,r=0;o>r;r++){var n=t.swfList[r];if(n.hasImage(e))return n.createImage(e,i)}return null},t.getTexture=function(e){for(var i=t.swfList.length,o=0;i>o;o++){var r=t.swfList[o];if(r.hasImage(e))return r.getTexture(e)}return null},t.createMovie=function(e,i,o){void 0===i&&(i=null),void 0===o&&(o=null);for(var r=t.swfList.length,n=0;r>n;n++){var a=t.swfList[n];if(a.hasMovieClip(e))return a.createMovie(e,i,o)}return null},t.createS9Image=function(e,i){void 0===i&&(i=null);for(var o=t.swfList.length,r=0;o>r;r++){var n=t.swfList[r];if(n.hasS9Image(e))return n.createS9Image(e,i)}return null},t.createShapeImage=function(e,i){void 0===i&&(i=null);for(var o=t.swfList.length,r=0;o>r;r++){var n=t.swfList[r];if(n.hasShapeImage(e))return n.createShapeImage(e,i)}return null},t.getSwf=function(e){for(var i=t.swfList.length,o=0;i>o;o++){var r=t.swfList[o];if(r.name==e)return r}return null},t.fixButton=function(e,i,o){t.firstAddBtn&&(t.firstAddBtn=!1,egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),egret.MainContext.instance.stage.addEventListener(egret.Event.LEAVE_STAGE,this.onTouchEnd,this));var r=new StarlingSwfButtonData;r.btn=e,r.onClick=i,r.thisObj=o,t.btnList.push(r),e.touchEnabled=!0,e.gotoAndStop(0),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBtnTouchBegin,e)},t.onBtnTouchBegin=function(e){for(var i=e.currentTarget,o=t.btnList.length,r=0;o>r;r++){var n=t.btnList[r];if(n.btn==i){n.touchStageX=e.stageX,n.touchStageY=e.stageY,i.gotoAndStop(1);break}}},t.onTouchEnd=function(e){for(var i=t.btnList.length,o=0;i>o;o++){var r=t.btnList[o];-1!=r.touchStageX&&(e.stageX&&Math.abs(r.touchStageX-e.stageX)<10&&Math.abs(r.touchStageY-e.stageY)<10&&r.onClick&&r.onClick.call(r.thisObj,e),r.touchStageX=-1,r.touchStageY=-1,r.btn.gotoAndStop(0))}},t.swfList=[],t.btnList=[],t.firstAddBtn=!0,t}();__reflect(StarlingSwfUtils.prototype,"StarlingSwfUtils");var StarlingSwfButtonData=function(){function t(){this.touchStageX=-1,this.touchStageY=-1}return t}();__reflect(StarlingSwfButtonData.prototype,"StarlingSwfButtonData");var AllAsyncExecutor=function(){function t(){this._functions=new Array,this._complateNum=0}return t.prototype.setCallBack=function(t,e){this._callBack=t,this._callBackTarget=e},t.prototype.regist=function(t,e){this._functions.push([t,e])},t.prototype.start=function(){App.ArrayUtils.forEach(this._functions,function(t){t[0].call(t[1])},this)},t.prototype.complate=function(){this._functions&&(this._complateNum++,this._complateNum==this._functions.length&&(this._callBack&&this._callBack.call(this._callBackTarget),this._callBack=null,this._callBackTarget=null,this._functions=null))},t}();__reflect(AllAsyncExecutor.prototype,"AllAsyncExecutor");var AnchorUtil=function(){function t(){}return t.init=function(){t._propertyChange=Object.create(null),t._anchorChange=Object.create(null),t.injectAnchor()},t.setAnchorX=function(t,e){t.anchorX=e},t.setAnchorY=function(t,e){t.anchorY=e},t.setAnchor=function(t,e){t.anchorX=t.anchorY=e},t.getAnchor=function(t){return t.anchorX!=t.anchorY&&console.log("target's anchorX != anchorY"),t.anchorX||0},t.getAnchorY=function(t){return t.anchorY||0},t.getAnchorX=function(t){return t.anchorX||0},t.injectAnchor=function(){Object.defineProperty(egret.DisplayObject.prototype,"width",{get:function(){return this.$getWidth()},set:function(e){var i=this;this.$setWidth(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"height",{get:function(){return this.$getHeight()},set:function(e){var i=this;this.$setHeight(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorX",{get:function(){return this._anchorX},set:function(e){var i=this;this._anchorX=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorY",{get:function(){return this._anchorY},set:function(e){var i=this;this._anchorY=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0})},t.changeAnchor=function(e){t._propertyChange[e.hashCode]&&t._anchorChange[e.hashCode]&&(e.anchorOffsetX=e._anchorX*e.width,e.anchorOffsetY=e._anchorY*e.height,delete t._propertyChange[e.hashCode])},t}();__reflect(AnchorUtil.prototype,"AnchorUtil");var ArrayUtils=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.forEach=function(t,e,i){for(var o=0,r=t.length;r>o;o++)e.apply(i,[t[o]])},e}(BaseClass);__reflect(ArrayUtils.prototype,"ArrayUtils");var AverageUtils=function(){function t(t){void 0===t&&(t=10),this.nums=[],this.numsLen=0,this.numSum=0,this.maxNum=t}return t.prototype.push=function(t){this.numsLen>this.maxNum&&(this.numsLen--,this.numSum-=this.nums.shift()),this.nums.push(t),this.numSum+=t,this.numsLen++},t.prototype.getValue=function(){return this.numSum/this.numsLen},t.prototype.clear=function(){this.nums.splice(0),this.numsLen=0,this.numSum=0},t}();__reflect(AverageUtils.prototype,"AverageUtils");var CommonUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.addLableStrokeColor=function(t,e,i){t.strokeColor=e,t.stroke=i},e.copyDataHandler=function(t){var e;if(t instanceof Array)e=[];else{if(!(t instanceof Object))return t;e={}}for(var i=Object.keys(t),o=0,r=i.length;r>o;o++){var n=i[o];e[n]=this.copyDataHandler(t[n])}return e},e.lock=function(){App.StageUtils.getStage().touchEnabled=App.StageUtils.getStage().touchChildren=!1},e.unlock=function(){App.StageUtils.getStage().touchEnabled=App.StageUtils.getStage().touchChildren=!0},e.int64ToNumber=function(t){return parseInt(t.toString())},e.labelIsOverLenght=function(t,e){var i=null;i=1e5>e?e:1e6>e?Math.floor(e/1e3/10).toString()+"万":Math.floor(e/1e4).toString()+"万",t.text=i},e}(BaseClass);__reflect(CommonUtils.prototype,"CommonUtils");var DateUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getFormatBySecond=function(t,e){void 0===e&&(e=1);var i="";switch(e){case 1:i=this.getFormatBySecond1(t);break;case 2:i=this.getFormatBySecond2(t);break;case 3:i=this.getFormatBySecond3(t);break;case 4:i=this.getFormatBySecond4(t);break;case 5:i=this.getFormatBySecond5(t)}return i},e.prototype.getFormatBySecond1=function(t){void 0===t&&(t=0);var e,i=Math.floor(t/3600);e=0==i?"00":10>i?"0"+i:""+i;var o,r,n=Math.floor((t-3600*i)/60),a=Math.floor((t-3600*i)%60);return o=0==n?"00":10>n?"0"+n:""+n,r=0==a?"00":10>a?"0"+a:""+a,e+":"+o+":"+r},e.prototype.getFormatBySecond3=function(t){void 0===t&&(t=0);var e,i,o=Math.floor(t/3600),r=Math.floor((t-3600*o)/60),n=Math.floor((t-3600*o)%60);return e=0==r?"00":10>r?"0"+r:""+r,i=0==n?"00":10>n?"0"+n:""+n,e+":"+i},e.prototype.getFormatBySecond2=function(t){var e=new Date(t),i=e.getFullYear(),o=e.getMonth()+1,r=e.getDate(),n=e.getHours(),a=e.getMinutes(),s=e.getSeconds();return i+"-"+o+"-"+r+" "+n+":"+a+":"+s},e.prototype.getFormatBySecond4=function(t){var e=Math.floor(t/3600);return e>0?e>24?Math.floor(e/24)+"天前":e+"小时前":Math.floor(t/60)+"分钟前"},e.prototype.getFormatBySecond5=function(t){var e=86400,i=3600,o=60,r=Math.floor(t/e),n=Math.floor(t%e/i),a=Math.floor((t-n*i)/o),s=Math.floor((t-n*i)%o),h="",p="",l="",c="";return t>0?0==r?(h="",0==n?(p="",0==a?(l="",c=0==s?"":10>s?"0"+s+"秒":""+s+"秒"):(l=""+a+"分",c=0==s?"":10>s?"0"+s+"秒":""+s+"秒",l+c)):(p=n+"小时",0==a?(l="",c=0==s?"":10>s?"0"+s+"秒":""+s+"秒"):(l=10>a?"0"+a+"分":""+a+"分",p+l))):(h=r+"天",p=0==n?"":10>n?"0"+n+"小时":""+n+"小时",h+p):""},e}(BaseClass);__reflect(DateUtils.prototype,"DateUtils");var DebugUtils=function(t){function e(){var e=t.call(this)||this;return e._threshold=3,e._startTimes={},e}return __extends(e,t),e.prototype.isOpen=function(t){this._isOpen=t},Object.defineProperty(e.prototype,"isDebug",{get:function(){return this._isOpen},enumerable:!0,configurable:!0}),e.prototype.start=function(t){this._isOpen&&(this._startTimes[t]=egret.getTimer())},e.prototype.stop=function(t){if(!this._isOpen)return 0;if(!this._startTimes[t])return 0;var e=egret.getTimer()-this._startTimes[t];return e>this._threshold&&Log.trace(t+": "+e),e},e.prototype.setThreshold=function(t){this._threshold=t},e}(BaseClass);__reflect(DebugUtils.prototype,"DebugUtils");var DelayOptManager=function(t){function e(){var e=t.call(this)||this;return e.TIME_THRESHOLD=2,e._delayOpts=[],App.TimerManager.doFrame(1,0,e.runCachedFun,e),e}return __extends(e,t),e.prototype.addDelayOptFunction=function(t,e,i,o,r){this._delayOpts.push({fun:e,funPara:i,thisObj:t,callBack:o,para:r})},e.prototype.clear=function(){this._delayOpts.length=0},e.prototype.stop=function(){App.TimerManager.remove(this.runCachedFun,this)},e.prototype.runCachedFun=function(t){if(0!=this._delayOpts.length)for(var e,i=egret.getTimer();this._delayOpts.length&&(e=this._delayOpts.shift(),e.funPara?e.fun.call(e.thisObj,e.funPara):e.fun.call(e.thisObj),e.callBack&&(void 0!=e.para?e.callBack.call(e.thisObj,e.para):e.callBack()),!(egret.getTimer()-i>this.TIME_THRESHOLD)););},e}(BaseClass);__reflect(DelayOptManager.prototype,"DelayOptManager");var DeviceUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"IsHtml5",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsMobile",{get:function(){return egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsPC",{get:function(){return!egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsQQBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MQQBrowser")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsIEBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MSIE")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsFirefoxBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Firefox")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsChromeBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Chrome")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsSafariBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Safari")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsOperaBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Opera")},enumerable:!0,configurable:!0}),e}(BaseClass);__reflect(DeviceUtils.prototype,"DeviceUtils");var DisplayUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createBitmap=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.createEuiImage=function(t){var e=new eui.Image,i=RES.getRes(t);return e.source=i,e},e.prototype.removeFromParent=function(t){null!=t.parent&&t.parent.removeChild(t)},e}(BaseClass);__reflect(DisplayUtils.prototype,"DisplayUtils");var EffectUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.macIconShake=function(t,e){for(var i=[[20,300],[15,300],[10,300],[5,300]],o="egret.Tween.get("+t+")",r=0,n=i.length;n>r;r++)o+=".to({'y':"+e+"-"+i[r][0]+"}, "+i[r][1]+")",o+=".to({'y':"+e+"}, "+i[r][1]+")";return o+=";"},e.prototype.startFlicker=function(t,e){t.alpha=1,egret.Tween.get(t).to({alpha:0},e).to({alpha:1},e).call(this.startFlicker,this,[t,e])},e.prototype.stopFlicker=function(t){egret.Tween.removeTweens(t)},e}(BaseClass);__reflect(EffectUtils.prototype,"EffectUtils");var EgretExpandUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){AnchorUtil.init()},e}(BaseClass);__reflect(EgretExpandUtils.prototype,"EgretExpandUtils");var FrameDelay=function(){function t(){}return t.prototype.delayCall=function(t,e,i){this.func=e,this.thisObj=i,egret.callLater(function(){App.TimerManager.doFrame(t,1,this.listener_enterFrame,this)},this)},t.prototype.listener_enterFrame=function(){this.func.call(this.thisObj)},t}();__reflect(FrameDelay.prototype,"FrameDelay");var FrameExecutor=function(){function t(t){this.delayFrame=t,this.frameDelay=new FrameDelay,this.functions=new Array}return t.prototype.regist=function(t,e){this.functions.push([t,e])},t.prototype.execute=function(){if(this.functions.length){var t=this.functions.shift();t[0].call(t[1]),this.frameDelay.delayCall(this.delayFrame,this.execute,this)}},t}();__reflect(FrameExecutor.prototype,"FrameExecutor");var KeyboardUtils=function(t){function e(){var e=t.call(this)||this;if(e.key_ups=new Array,e.key_downs=new Array,App.DeviceUtils.IsHtml5){var i=e;document.addEventListener("keyup",function(t){for(var e=0,o=i.key_ups.length;o>e;e++){var r=i.key_ups[e][0],n=i.key_ups[e][1];n?r.call(n,t.keyCode):r(t.keyCode)}}),document.addEventListener("keydown",function(t){for(var e=0,o=i.key_downs.length;o>e;e++){var r=i.key_downs[e][0],n=i.key_downs[e][1];n?r.call(n,t.keyCode):r(t.keyCode)}})}return e}return __extends(e,t),e.prototype.addKeyUp=function(t,e){this.key_ups.push([t,e])},e.prototype.addKeyDown=function(t,e){this.key_downs.push([t,e])},e.prototype.removeKeyUp=function(t,e){for(var i=0;i<this.key_ups.length;i++)this.key_ups[i][0]==t&&this.key_ups[i][1]==e&&(this.key_ups.splice(i,1),i--)},e.prototype.removeKeyDown=function(t,e){for(var i=0;i<this.key_downs.length;i++)this.key_downs[i][0]==t&&this.key_downs[i][1]==e&&(this.key_downs.splice(i,1),i--)},e}(BaseClass);__reflect(KeyboardUtils.prototype,"KeyboardUtils");var LocationProperty=function(){function t(){}return t.getPara=function(t,e){if(egret.MainContext.runtimeType==egret.MainContext.RUNTIME_NATIVE)return null;var i=e||location.href;if(-1!=i.indexOf("?")){var o="&"+i.split("?")[1],r=new RegExp("&"+t+"=.*?(?:&|$)"),n=r.exec(o);if(n){var a=n[0];return a.split("&")[1].split("=")[1]}}return null},t.setProperty=function(t,e,i){var o=i||location.href,r="&"+o.split("?")[1];if(-1==o.indexOf("?"))return o+="?"+t+"="+e;var r=o.split("?")[1];if(""==r)return o+=t+"="+e;var n=new RegExp("(?:^|&)"+t+"=.*?(?:&|$)"),a=n.exec(r);if(a&&""!=a[0]){var s=a[0],h=new RegExp("=.*$"),p=s.replace(h,"="+e);return o.replace(s,p)}return o+="&"+t+"="+e},t.hasProperty=function(t,e){var i=e||location.href,o="&"+i.split("?")[1];return-1!=o.indexOf("&"+t+"=")},t}();__reflect(LocationProperty.prototype,"LocationProperty");var Log=function(){function t(){}return t.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];App.DebugUtils.isDebug&&(t[0]="[DebugLog]"+t[0],console.log.apply(console,t))},t}();__reflect(Log.prototype,"Log");var MathUtils=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getAngle=function(t){return 180*t/Math.PI},e.prototype.getRadian=function(t){return t/180*Math.PI},e.prototype.getRadian2=function(t,e,i,o){var r=i-t,n=o-e;return Math.atan2(n,r)},e.prototype.getDistance=function(t,e,i,o){var r=i-t,n=o-e,a=r*r+n*n;return Math.sqrt(a)},e}(BaseClass);__reflect(MathUtils.prototype,"MathUtils");var md5=function(){function t(){this.hexcase=0,this.b64pad=""}return t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var o=Array(16),r=Array(16),n=0;16>n;n++)o[n]=909522486^i[n],r[n]=1549556828^i[n];var a=this.binl_md5(o.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(r.concat(a),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var i,o=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",r="",n=0;n<t.length;n++)i=t.charCodeAt(n),r+=o.charAt(i>>>4&15)+o.charAt(15&i);return r},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="",r=t.length,n=0;r>n;n+=3)for(var a=t.charCodeAt(n)<<16|(r>n+1?t.charCodeAt(n+1)<<8:0)|(r>n+2?t.charCodeAt(n+2):0),s=0;4>s;s++)o+=8*n+6*s>8*t.length?this.b64pad:i.charAt(a>>>6*(3-s)&63);return o},t.prototype.rstr2any=function(t,e){var i,o,r,n,a,s=e.length,h=Array(Math.ceil(t.length/2));for(i=0;i<h.length;i++)h[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var p=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),l=Array(p);for(o=0;p>o;o++){for(a=Array(),n=0,i=0;i<h.length;i++)n=(n<<16)+h[i],r=Math.floor(n/s),n-=r*s,(a.length>0||r>0)&&(a[a.length]=r);l[o]=n,h=a}var c="";for(i=l.length-1;i>=0;i--)c+=e.charAt(l[i]);return c},t.prototype.str2rstr_utf8=function(t){for(var e,i,o="",r=-1;++r<t.length;)e=t.charCodeAt(r),i=r+1<t.length?t.charCodeAt(r+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),r++),127>=e?o+=String.fromCharCode(e):2047>=e?o+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?o+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(o+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return o},t.prototype.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},t.prototype.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var i=1732584193,o=-271733879,r=-1732584194,n=271733878,a=0;a<t.length;a+=16){var s=i,h=o,p=r,l=n;i=this.md5_ff(i,o,r,n,t[a+0],7,-680876936),n=this.md5_ff(n,i,o,r,t[a+1],12,-389564586),r=this.md5_ff(r,n,i,o,t[a+2],17,606105819),o=this.md5_ff(o,r,n,i,t[a+3],22,-1044525330),i=this.md5_ff(i,o,r,n,t[a+4],7,-176418897),n=this.md5_ff(n,i,o,r,t[a+5],12,1200080426),r=this.md5_ff(r,n,i,o,t[a+6],17,-1473231341),o=this.md5_ff(o,r,n,i,t[a+7],22,-45705983),i=this.md5_ff(i,o,r,n,t[a+8],7,1770035416),n=this.md5_ff(n,i,o,r,t[a+9],12,-1958414417),r=this.md5_ff(r,n,i,o,t[a+10],17,-42063),o=this.md5_ff(o,r,n,i,t[a+11],22,-1990404162),i=this.md5_ff(i,o,r,n,t[a+12],7,1804603682),n=this.md5_ff(n,i,o,r,t[a+13],12,-40341101),r=this.md5_ff(r,n,i,o,t[a+14],17,-1502002290),o=this.md5_ff(o,r,n,i,t[a+15],22,1236535329),i=this.md5_gg(i,o,r,n,t[a+1],5,-165796510),n=this.md5_gg(n,i,o,r,t[a+6],9,-1069501632),r=this.md5_gg(r,n,i,o,t[a+11],14,643717713),o=this.md5_gg(o,r,n,i,t[a+0],20,-373897302),i=this.md5_gg(i,o,r,n,t[a+5],5,-701558691),n=this.md5_gg(n,i,o,r,t[a+10],9,38016083),r=this.md5_gg(r,n,i,o,t[a+15],14,-660478335),o=this.md5_gg(o,r,n,i,t[a+4],20,-405537848),i=this.md5_gg(i,o,r,n,t[a+9],5,568446438),n=this.md5_gg(n,i,o,r,t[a+14],9,-1019803690),r=this.md5_gg(r,n,i,o,t[a+3],14,-187363961),o=this.md5_gg(o,r,n,i,t[a+8],20,1163531501),i=this.md5_gg(i,o,r,n,t[a+13],5,-1444681467),n=this.md5_gg(n,i,o,r,t[a+2],9,-51403784),r=this.md5_gg(r,n,i,o,t[a+7],14,1735328473),o=this.md5_gg(o,r,n,i,t[a+12],20,-1926607734),i=this.md5_hh(i,o,r,n,t[a+5],4,-378558),n=this.md5_hh(n,i,o,r,t[a+8],11,-2022574463),r=this.md5_hh(r,n,i,o,t[a+11],16,1839030562),o=this.md5_hh(o,r,n,i,t[a+14],23,-35309556),i=this.md5_hh(i,o,r,n,t[a+1],4,-1530992060),n=this.md5_hh(n,i,o,r,t[a+4],11,1272893353),r=this.md5_hh(r,n,i,o,t[a+7],16,-155497632),o=this.md5_hh(o,r,n,i,t[a+10],23,-1094730640),i=this.md5_hh(i,o,r,n,t[a+13],4,681279174),n=this.md5_hh(n,i,o,r,t[a+0],11,-358537222),r=this.md5_hh(r,n,i,o,t[a+3],16,-722521979),o=this.md5_hh(o,r,n,i,t[a+6],23,76029189),i=this.md5_hh(i,o,r,n,t[a+9],4,-640364487),n=this.md5_hh(n,i,o,r,t[a+12],11,-421815835),r=this.md5_hh(r,n,i,o,t[a+15],16,530742520),o=this.md5_hh(o,r,n,i,t[a+2],23,-995338651),i=this.md5_ii(i,o,r,n,t[a+0],6,-198630844),n=this.md5_ii(n,i,o,r,t[a+7],10,1126891415),r=this.md5_ii(r,n,i,o,t[a+14],15,-1416354905),o=this.md5_ii(o,r,n,i,t[a+5],21,-57434055),i=this.md5_ii(i,o,r,n,t[a+12],6,1700485571),n=this.md5_ii(n,i,o,r,t[a+3],10,-1894986606),r=this.md5_ii(r,n,i,o,t[a+10],15,-1051523),o=this.md5_ii(o,r,n,i,t[a+1],21,-2054922799),i=this.md5_ii(i,o,r,n,t[a+8],6,1873313359),n=this.md5_ii(n,i,o,r,t[a+15],10,-30611744),r=this.md5_ii(r,n,i,o,t[a+6],15,-1560198380),o=this.md5_ii(o,r,n,i,t[a+13],21,1309151649),i=this.md5_ii(i,o,r,n,t[a+4],6,-145523070),n=this.md5_ii(n,i,o,r,t[a+11],10,-1120210379),r=this.md5_ii(r,n,i,o,t[a+2],15,718787259),o=this.md5_ii(o,r,n,i,t[a+9],21,-343485551),i=this.safe_add(i,s),o=this.safe_add(o,h),r=this.safe_add(r,p),n=this.safe_add(n,l)}return[i,o,r,n]},t.prototype.md5_cmn=function(t,e,i,o,r,n){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(o,n)),r),i)},t.prototype.md5_ff=function(t,e,i,o,r,n,a){return this.md5_cmn(e&i|~e&o,t,e,r,n,a)},t.prototype.md5_gg=function(t,e,i,o,r,n,a){return this.md5_cmn(e&o|i&~o,t,e,r,n,a)},t.prototype.md5_hh=function(t,e,i,o,r,n,a){return this.md5_cmn(e^i^o,t,e,r,n,a)},t.prototype.md5_ii=function(t,e,i,o,r,n,a){return this.md5_cmn(i^(e|~o),t,e,r,n,a)},t.prototype.safe_add=function(t,e){var i=(65535&t)+(65535&e),o=(t>>16)+(e>>16)+(i>>16);return o<<16|65535&i},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();__reflect(md5.prototype,"md5");var MessageCenter=function(t){function e(e){var i=t.call(this)||this;return i.type=e,i.dict={},i.eVec=new Array,i.lastRunTime=0,0==i.type&&App.TimerManager.doFrame(1,0,i.run,i),i}return __extends(e,t),e.prototype.clear=function(){this.dict={},this.eVec.splice(0)},e.prototype.addListener=function(t,e,i){var o=this.dict[t];null==o&&(o=new Array,this.dict[t]=o);var r=0,n=o.length;for(r;n>r;r++)if(o[r][0]==e&&o[r][1]==i)return;o.push([e,i])},e.prototype.removeListener=function(t,e,i){var o=this.dict[t];if(null!=o){var r=0,n=o.length;for(r;n>r;r++)if(o[r][0]==e&&o[r][1]==i){o.splice(r,1);break}0==o.length&&(this.dict[t]=null,delete this.dict[t])}},e.prototype.removeAll=function(t){for(var e=Object.keys(this.dict),i=0,o=e.length;o>i;i++){for(var r=e[i],n=this.dict[r],a=0;a<n.length;a++)n[a][1]==t&&(n.splice(a,1),a--);0==n.length&&(this.dict[r]=null,delete this.dict[r])}},e.prototype.dispatch=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(null!=this.dict[t]){var o=ObjectPool.pop("MessageVo");o.type=t,o.param=e,0==this.type?this.eVec.push(o):1==this.type?this.dealMsg(o):Log.trace("MessageCenter未实现的类型")}},e.prototype.run=function(){var t=egret.getTimer(),e=t-this.lastRunTime>100;if(this.lastRunTime=t,e)for(;this.eVec.length>0;)this.dealMsg(this.eVec.shift());else for(;this.eVec.length>0&&(this.dealMsg(this.eVec.shift()),!(egret.getTimer()-t>5)););},e.prototype.dealMsg=function(t){for(var e=this.dict[t.type],i=0,o=e.length,r=null;o>i;)r=e[i],r[0].apply(r[1],t.param),e.length!=o&&(o=e.length,i--),i++;t.dispose(),ObjectPool.push(t)},e}(BaseClass);__reflect(MessageCenter.prototype,"MessageCenter");var MessageVo=function(){function t(){}return t.prototype.dispose=function(){this.type=null,this.param=null},t}();__reflect(MessageVo.prototype,"MessageVo");var ObjectPool=function(){function t(){this._objs=new Array}return t.prototype.pushObj=function(t){this._objs.push(t)},t.prototype.popObj=function(){return this._objs.length>0?this._objs.pop():null},t.prototype.clear=function(){for(;this._objs.length>0;)this._objs.pop()},t.pop=function(e){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t._content[e]||(t._content[e]=[]);var r=t._content[e];if(r.length)return r.pop();var n,a=egret.getDefinitionByName(e),s=i.length;return 0==s?n=new a:1==s?n=new a(i[0]):2==s?n=new a(i[0],i[1]):3==s?n=new a(i[0],i[1],i[2]):4==s?n=new a(i[0],i[1],i[2],i[3]):5==s&&(n=new a(i[0],i[1],i[2],i[3],i[4])),n.ObjectPoolKey=e,n},t.popWithExtraKey=function(e,i){t._content[e]||(t._content[e]=[]);var o,r=t._content[e];if(r.length)for(var n=0;n<r.length;n++)if(r[n].extraKey==i){o=r[n],r.splice(n,1);break}if(!o){var a=egret.getDefinitionByName(e);o=new a(i),o.extraKey=i,o.ObjectPoolKey=e}return o},t.push=function(e){if(null==e)return!1;var i=e.ObjectPoolKey;return t._content[i]?(t._content[i].push(e),!0):!1},t.clear=function(){t._content={}},t.clearClass=function(e,i){void 0===i&&(i=null);for(var o=t._content[e];o&&o.length;){var r=o.pop();i&&r[i](),r=null}t._content[e]=null,delete t._content[e]},t.dealFunc=function(e,i){var o=t._content[e];if(null!=o){var r=0,n=o.length;for(r;n>r;r++)o[r][i]()}},t._content={},t}();__reflect(ObjectPool.prototype,"ObjectPool");var Percent=function(){function t(t,e){this.currentValue=t,this.totalValue=e}return t.prototype.computePercent=function(){return this.currentValue/this.totalValue*100},t.prototype.computeRate=function(){return this.currentValue/this.totalValue},t.prototype.reverse=function(){return this.currentValue=this.totalValue-this.currentValue,this},t.prototype.copy=function(){return new t(this.currentValue,this.totalValue)},t.prototype.computePercentReverse=function(){return(this.totalValue-this.currentValue)/this.totalValue*100},t.prototype.computeRateReverse=function(){return(this.totalValue-this.currentValue)/this.totalValue},t}();__reflect(Percent.prototype,"Percent");var QueueExecutor=function(){function t(){this._functions=new Array}return t.prototype.setCallBack=function(t,e){this._callBack=t,this._callBackTarget=e},t.prototype.regist=function(t,e){this._functions.push([t,e])},t.prototype.start=function(){this.next()},t.prototype.next=function(){if(this._functions)if(0==this._functions.length)this._callBack&&this._callBack.call(this._callBackTarget),this._callBack=null,this._callBackTarget=null,this._functions=null;else{var t=this._functions.shift();t[0].call(t[1])}},t}();__reflect(QueueExecutor.prototype,"QueueExecutor");var RandomUtils=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.limit=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var i=e-t;return t+Math.random()*i},e.prototype.limitInteger=function(t,e){return Math.round(this.limit(t,e))},e.prototype.randomArray=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},e}(BaseClass);__reflect(RandomUtils.prototype,"RandomUtils");var RenderTextureManager=function(t){function e(){var e=t.call(this)||this;return e._pool=[],e._useNum=0,e.isLowerQQBrowser()?e._maxNum=18:e._maxNum=-1,e}return __extends(e,t),e.prototype.isLowerQQBrowser=function(){if(App.DeviceUtils.IsQQBrowser){for(var t=["2013022","Lenovo A630t","SM-G3818","vivo X3t","GT-I9100"],e=!1,i=0,o=t.length;o>i;i++)if(-1!=navigator.userAgent.indexOf(t[i])){e=!0;break}return e}return!1},e.prototype.pop=function(){var t=this._pool.pop();return t||(-1==this._maxNum||this._useNum<this._maxNum)&&(t=new egret.RenderTexture,this._useNum++),t},e.prototype.push=function(t){for(var e=!1,i=0,o=this._pool.length;o>i;i++)if(this._pool[i]==t){e=!0;break}e||this._pool.push(t)},e}(BaseClass);__reflect(RenderTextureManager.prototype,"RenderTextureManager");var ResourceUtils=function(t){function e(){var e=t.call(this)||this;return e._groupIndex=0,e._configs=new Array,e._groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e.onResourceLoadComplete,e),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,e.onResourceLoadProgress,e),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,e.onResourceLoadError,e),e}return __extends(e,t),e.prototype.addConfig=function(t,e){this._configs.push([t,e])},e.prototype.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},e.prototype.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},e.prototype.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},e.prototype.loadGroup=function(t,e,i,o){this._groups[t]=[e,i,o],RES.loadGroup(t)},e.prototype.loadGroups=function(t,e,i,o,r){RES.createGroup(t,e,!0),this.loadGroup(t,i,o,r)
},e.prototype.pilfererLoadGroup=function(t,e){void 0===e&&(e=null);var i="pilferer_"+t;e||(e=[t]),RES.createGroup(i,e,!0),RES.loadGroup(i,-1)},e.prototype.onResourceLoadComplete=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][0],o=this._groups[e][2];null!=i&&i.apply(o,[e]),this._groups[e]=null,delete this._groups[e]}},e.prototype.onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][1],o=this._groups[e][2];null!=i&&i.call(o,t.itemsLoaded,t.itemsTotal)}},e.prototype.onResourceLoadError=function(t){Log.trace(t.groupName+"资源组有资源加载失败"),this.onResourceLoadComplete(t)},e.prototype.loadResource=function(t,e,i,o,r){void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===r&&(r=null);var n=t.concat(e),a="loadGroup"+this._groupIndex++;RES.createGroup(a,n,!0),this._groups[a]=[i,o,r],RES.loadGroup(a)},e.prototype.createGroup=function(t,e){RES.createGroup(t,e,!0)},e.prototype.createResource=function(t,e,i){var o={name:t,type:e,url:i};RES.parseConfig({resources:[o]})},e}(BaseClass);__reflect(ResourceUtils.prototype,"ResourceUtils");var ResVersionManager=function(t){function e(){var e=t.call(this)||this;return e.res_loadByVersion(),e}return __extends(e,t),e.prototype.res_loadByVersion=function(){RES.web.Html5VersionController.prototype.getVirtualUrl=function(t){var i="",o=e.resVersionData,r=t.substring(9);return o&&o[r]&&(i=o[r]),0==i.length&&(i=Math.random()+""),t+=-1==t.indexOf("?")?"?v="+i:"&v="+i}},e.prototype.loadConfig=function(t,e,i){this.complateFunc=e,this.complateFuncTarget=i,RES.getResByUrl(t,this.loadResVersionComplate,this)},e.prototype.loadResVersionComplate=function(t){e.resVersionData=t,this.complateFunc.call(this.complateFuncTarget)},e}(BaseClass);__reflect(ResVersionManager.prototype,"ResVersionManager");var RockerUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t,e,i,o){this.keys=[0,0],this.mouseX=-1,this.mouseY=-1,this.moveFlag=e,this.moveFlagX=e.x,this.moveFlagY=e.y,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.moveFlagWidthHelf=.5*t.width,this.moveFlagRec=new egret.Rectangle(this.moveFlagX-.5*t.width,this.moveFlagY-.5*t.height,t.width,t.height),this.moveFlagCheckRec=new egret.Rectangle(0,0,.5*App.StageUtils.getWidth(),App.StageUtils.getHeight()),this.dealKeyFunc=i,this.dealKeyTarget=o,this.moveFlag.touchEnabled=!0,this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startMove,this),this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this),this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_TAP,this.stopEvent,this),App.StageUtils.getStage().addEventListener(egret.TouchEvent.TOUCH_END,this.leaveStateEvent,this),App.StageUtils.getStage().addEventListener(egret.TouchEvent.TOUCH_MOVE,this.heroMoveEvent,this),App.KeyboardUtils.addKeyDown(this.onKeyDown,this),App.KeyboardUtils.addKeyUp(this.onKeyUp,this)},e.prototype.onKeyDown=function(t){switch(t){case Keyboard.A:this.keys[0]=-1,this.startCheckKey();break;case Keyboard.D:this.keys[0]=1,this.startCheckKey();break;case Keyboard.W:this.keys[1]=-1,this.startCheckKey();break;case Keyboard.S:this.keys[1]=1,this.startCheckKey()}},e.prototype.onKeyUp=function(t){switch(t){case Keyboard.A:-1==this.keys[0]&&(this.keys[0]=0);break;case Keyboard.D:1==this.keys[0]&&(this.keys[0]=0);break;case Keyboard.W:-1==this.keys[1]&&(this.keys[1]=0);break;case Keyboard.S:1==this.keys[1]&&(this.keys[1]=0)}},e.prototype.stopEvent=function(t){t.stopPropagation()},e.prototype.leaveStateEvent=function(t){t.stageX==this.mouseX&&t.stageY==this.mouseY&&this.stopMove()},e.prototype.startMove=function(t){this.isMoveing=!0,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.mouseX=t.stageX,this.mouseY=t.stageY},e.prototype.stopMove=function(){this.isMoveing=!1,this.keys[0]=0,this.keys[1]=0,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.mouseX=-1,this.mouseY=-1},e.prototype.resetRockerPos=function(){this.moveFlag.x=this.moveFlagX,this.moveFlag.y=this.moveFlagY},e.prototype.heroMoveEvent=function(t){this.runMove(t.stageX,t.stageY)},e.prototype.runMove=function(t,e){if(this.isMoveing&&(this.moveFlagCheckRec.contains(t,e)||!(Math.abs(this.mouseX-t)>50||Math.abs(this.mouseY-e)>50))){if(this.mouseX=t,this.mouseY=e,this.moveFlagRec.contains(this.mouseX,this.mouseY))this.moveFlagGoX=this.mouseX,this.moveFlagGoY=this.mouseY;else{var i=App.MathUtils.getRadian2(this.moveFlagX,this.moveFlagY,this.mouseX,this.mouseY);this.moveFlagGoX=this.moveFlagX+Math.cos(i)*this.moveFlagWidthHelf,this.moveFlagGoY=this.moveFlagY+Math.sin(i)*this.moveFlagWidthHelf}this.moveFlagGoX>this.moveFlagX&&Math.abs(this.moveFlagGoX-this.moveFlagX)>10?this.keys[0]=1:this.moveFlagGoX<this.moveFlagX&&Math.abs(this.moveFlagGoX-this.moveFlagX)>10?this.keys[0]=-1:this.keys[0]=0,this.moveFlagGoY>this.moveFlagY&&Math.abs(this.moveFlagGoY-this.moveFlagY)>10?this.keys[1]=1:this.moveFlagGoY<this.moveFlagY&&Math.abs(this.moveFlagGoY-this.moveFlagY)>10?this.keys[1]=-1:this.keys[1]=0,this.startCheckKey()}},e.prototype.startCheckKey=function(){this.checkKeying||(this.checkKeying=!0,App.TimerManager.doFrame(1,0,this.delKeys,this))},e.prototype.stopCheckKey=function(){this.keys[0]=0,this.keys[1]=0,this.checkKeying&&(App.TimerManager.remove(this.delKeys,this),this.checkKeying=!1)},e.prototype.delKeys=function(){-1==this.mouseX||this.moveFlagCheckRec.contains(this.mouseX,this.mouseY)||this.stopMove(),this.moveFlag.x!=this.moveFlagGoX&&(this.moveFlag.x=this.moveFlagGoX),this.moveFlag.y!=this.moveFlagGoY&&(this.moveFlag.y=this.moveFlagGoY),this.keys[0]||this.keys[1]||this.stopCheckKey(),this.dealKeyFunc.call(this.dealKeyTarget,this.keys[0],this.keys[1])||this.resetRockerPos()},e.prototype.stop=function(){this.stopCheckKey(),this.stopMove()},e}(BaseClass);__reflect(RockerUtils.prototype,"RockerUtils");var ShockUtils=function(t){function e(){var e=t.call(this)||this;return e.MAP=0,e.SPRITE=1,e.mapPoss=[new egret.Point(0,3),new egret.Point(0,0),new egret.Point(0,-2)],e.spritePoss=[new egret.Point(5,0),new egret.Point(-5,0),new egret.Point(5,0)],e._shockLength=0,e._shockCount=0,e._rx=0,e._ry=0,e._type=0,e._repeatCount=0,e}return __extends(e,t),e.prototype.destroy=function(){this.stop()},e.prototype.shock=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=null),void 0===i&&(i=3),this._target||(this._type=t,this._target=e,this._type==this.MAP?(this._shockPoss=this.mapPoss.concat(),this._shockLength=this._shockPoss.length):this._type==this.SPRITE&&(this._shockPoss=this.spritePoss.concat(),this._shockLength=this._shockPoss.length),this.start(i))},e.prototype.start=function(t){void 0===t&&(t=1),this.repeatCount=t,this._shockCount=0,this._target&&(this._type!=this.MAP&&(this._rx=this._target.x),this._ry=this._target.y,App.TimerManager.doFrame(1,0,this.onShockEnter,this))},e.prototype.stop=function(){this._target&&(this._type!=this.MAP&&(this._target.x=this._rx),this._target.y=this._ry,App.TimerManager.remove(this.onShockEnter,this)),this._target=null},e.prototype.onShockEnter=function(t){var e=this._shockLength*this._repeatCount;if(this._shockCount>=e)return void this.stop();var i=this._shockCount%this._shockLength,o=this._shockPoss[i];this._target&&(this._type!=this.MAP&&(this._target.x=this._rx+o.x),this._target.y=this._ry+o.y),this._shockCount++},Object.defineProperty(e.prototype,"repeatCount",{get:function(){return this._repeatCount},set:function(t){this._repeatCount=t},enumerable:!0,configurable:!0}),e}(BaseClass);__reflect(ShockUtils.prototype,"ShockUtils");var StageUtils=function(t){function e(){var i=t.call(this)||this;return null==e._uiStage&&(e._uiStage=new eui.UILayer,e._uiStage.percentHeight=100,e._uiStage.percentWidth=100,e._uiStage.touchEnabled=!1,i.getStage().addChild(e._uiStage)),i}return __extends(e,t),e.prototype.getHeight=function(){return this.getStage().stageHeight},e.prototype.getWidth=function(){return this.getStage().stageWidth},e.prototype.setTouchChildren=function(t){this.getStage().touchChildren=t},e.prototype.setMaxTouches=function(t){this.getStage().maxTouches=t},e.prototype.setFrameRate=function(t){this.getStage().frameRate=t},e.prototype.setScaleMode=function(t){this.getStage().scaleMode=t},e.prototype.getStage=function(){return egret.MainContext.instance.stage},e.prototype.getUIStage=function(){return e._uiStage},e.prototype.startFullscreenAdaptation=function(t,e,i){this.designWidth=t,this.designHeight=e,this.resizeCallback=i,this.stageOnResize()},e.prototype.stageOnResize=function(){this.getStage().removeEventListener(egret.Event.RESIZE,this.stageOnResize,this);var t=this.designWidth,e=this.designHeight,i=window.innerWidth,o=window.innerHeight,r=i/o,n=t/e,a=r/n;if(r>n){var s=a,h=a;t=Math.floor(t*s),e=Math.floor(e*h)}this.getStage().setContentSize(t,e),this.resizeCallback&&this.resizeCallback(),this.getStage().addEventListener(egret.Event.RESIZE,this.stageOnResize,this)},e}(BaseClass);__reflect(StageUtils.prototype,"StageUtils");var StringBuffer=function(){function t(){this._strings=new Array}return t.prototype.append=function(t){this._strings.push(t)},t.prototype.toString=function(){return this._strings.join("")},t.prototype.clear=function(){this._strings.length=0},t}();__reflect(StringBuffer.prototype,"StringBuffer");var StringUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.trimSpace=function(t){return t.replace(/^\s*(.*?)[\s\n]*$/g,"$1")},e.prototype.getStringLength=function(t){for(var e=t.split(""),i=0,o=0;o<e.length;o++){var r=e[o];i+=this.isChinese(r)?2:1}return i},e.prototype.isChinese=function(t){var e=/^.*[\u4E00-\u9FA5]+.*$/;return e.test(t)},e}(BaseClass);__reflect(StringUtils.prototype,"StringUtils");var TextFlowMaker=function(t){function e(){var e=t.call(this)||this;return e.STYLE_COLOR="C",e.STYLE_SIZE="S",e.PROP_TEXT="T",e}return __extends(e,t),e.prototype.generateTextFlow=function(t){for(var e=t.split("|"),i=[],o=0,r=e.length;r>o;o++)i.push(this.getSingleTextFlow(e[o]));return i},e.prototype.getSingleTextFlow=function(t){for(var e,i=t.split("&"),o={style:{}},r=0,n=i.length;n>r;r++)e=i[r].split(":"),e[0]==this.PROP_TEXT?o.text=e[1]:e[0]==this.STYLE_SIZE?o.style.size=parseInt(e[1]):e[0]==this.STYLE_COLOR?o.style.textColor=parseInt(e[1]):o.text=e[0];return o},e}(BaseClass);__reflect(TextFlowMaker.prototype,"TextFlowMaker");var TimerManager=function(t){function e(){var e=t.call(this)||this;return e._handlers=new Array,e._delHandlers=new Array,e._currTime=egret.getTimer(),e._currFrame=0,e._count=0,e._timeScale=1,egret.Ticker.getInstance().register(e.onEnterFrame,e),e}return __extends(e,t),e.prototype.setTimeScale=function(t){this._timeScale=t},e.prototype.onEnterFrame=function(){this._currFrame++,this._currTime=egret.getTimer(),App.DebugUtils.start("TimerManager:");for(var t=0;t<this._count;t++){var e=this._handlers[t],i=e.userFrame?this._currFrame:this._currTime;i>=e.exeTime&&(App.DebugUtils.start(e.method.toString()),e.method.call(e.methodObj,(this._currTime-e.dealTime)*this._timeScale),App.DebugUtils.stop(e.method.toString()),e.dealTime=this._currTime,e.exeTime+=e.delay,e.repeat||(e.repeatCount>1?e.repeatCount--:(e.complateMethod&&e.complateMethod.apply(e.complateMethodObj),this._delHandlers.push(e))))}for(;this._delHandlers.length;){var e=this._delHandlers.pop();this.remove(e.method,e.methodObj)}App.DebugUtils.stop("TimerManager:")},e.prototype.create=function(t,e,i,o,r,n,a){if(!(0>e||0>i||null==o)){this.remove(o,r);var s=ObjectPool.pop("TimerHandler");s.userFrame=t,s.repeat=0==i,s.repeatCount=i,s.delay=e,s.method=o,s.methodObj=r,s.complateMethod=n,s.complateMethodObj=a,s.exeTime=e+(t?this._currFrame:this._currTime),s.dealTime=this._currTime,this._handlers.push(s),this._count++}},e.prototype.doTimer=function(t,e,i,o,r,n){void 0===r&&(r=null),void 0===n&&(n=null),this.create(!1,t,e,i,o,r,n)},e.prototype.doFrame=function(t,e,i,o,r,n){void 0===r&&(r=null),void 0===n&&(n=null),this.create(!0,t,e,i,o,r,n)},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),e.prototype.remove=function(t,e){for(var i=0;i<this._count;i++){var o=this._handlers[i];if(o.method==t&&o.methodObj==e){this._handlers.splice(i,1),ObjectPool.push(o),this._count--;break}}},e.prototype.removeAll=function(t){for(var e=0;e<this._count;e++){var i=this._handlers[e];i.methodObj==t&&(this._handlers.splice(e,1),ObjectPool.push(i),this._count--,e--)}},e.prototype.isExists=function(t,e){for(var i=0;i<this._count;i++){var o=this._handlers[i];if(o.method==t&&o.methodObj==e)return!0}return!1},e}(BaseClass);__reflect(TimerManager.prototype,"TimerManager");var TimerHandler=function(){function t(){this.delay=0,this.repeatCount=0,this.exeTime=0,this.dealTime=0}return t.prototype.clear=function(){this.method=null,this.methodObj=null,this.complateMethod=null,this.complateMethodObj=null},t}();__reflect(TimerHandler.prototype,"TimerHandler");var ControllerConst;!function(t){t[t.Loading=1e4]="Loading",t[t.Login=10001]="Login",t[t.Home=10002]="Home",t[t.Friend=10003]="Friend",t[t.Shop=10004]="Shop",t[t.Warehouse=10005]="Warehouse",t[t.Factory=10006]="Factory",t[t.Task=10007]="Task",t[t.Mail=10008]="Mail",t[t.Game=10009]="Game",t[t.RpgGame=10010]="RpgGame"}(ControllerConst||(ControllerConst={}));var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),egret.registerImplementation("eui.IAssetAdapter",new AssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),App.StageUtils.startFullscreenAdaptation(650,1e3,this.onResize),this.initScene(),this.initModule(),App.SceneManager.runScene(SceneConsts.LOADING),this.loadResVersionComplate()},e.prototype.onResize=function(){App.ControllerManager.applyFunc(ControllerConst.RpgGame,RpgGameConst.GameResize)},e.prototype.loadResVersionComplate=function(){App.ResourceUtils.addConfig("resource/default.res.json","resource/"),App.ResourceUtils.addConfig("resource/resource_core.json","resource/"),App.ResourceUtils.addConfig("resource/resource_ui.json","resource/"),App.ResourceUtils.addConfig("resource/resource_battle.json","resource/"),App.ResourceUtils.addConfig("resource/resource_rpg.json","resource/"),App.ResourceUtils.loadConfig(this.onConfigComplete,this)},e.prototype.onConfigComplete=function(){var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onThemeLoadComplete=function(){new RpgTest},e.prototype.initScene=function(){App.SceneManager.register(SceneConsts.LOADING,new LoadingScene),App.SceneManager.register(SceneConsts.UI,new UIScene),App.SceneManager.register(SceneConsts.Game,new GameScene),App.SceneManager.register(SceneConsts.RpgGame,new RpgGameScene)},e.prototype.initModule=function(){App.ControllerManager.register(ControllerConst.Loading,new LoadingController)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var SceneConsts;!function(t){t[t.Game=1]="Game",t[t.UI=2]="UI",t[t.LOADING=3]="LOADING",t[t.RpgGame=4]="RpgGame"}(SceneConsts||(SceneConsts={}));var ViewConst;!function(t){t[t.Loading=1e4]="Loading",t[t.Login=10001]="Login",t[t.Home=10002]="Home",t[t.Friend=10003]="Friend",t[t.Shop=10004]="Shop",t[t.Warehouse=10005]="Warehouse",t[t.Factory=10006]="Factory",t[t.Task=10007]="Task",t[t.Daily=10008]="Daily",t[t.Mail=10009]="Mail",t[t.Game=2e4]="Game",t[t.GameUI=20001]="GameUI",t[t.RpgGame=20002]="RpgGame"}(ViewConst||(ViewConst={}));var GuideView=function(t){function e(){var e=t.call(this)||this;return e._objRec=new egret.Rectangle,e._objGlobalPoint=new egret.Point,e._bg=new GuideMaskBackgroud,e.addChild(e._bg),e._maskPic=StarlingSwfUtils.createS9Image("s9_guide_mask"),e.addChild(e._maskPic),e._textBgPic=StarlingSwfUtils.createS9Image("s9_guide_txt"),AnchorUtil.setAnchorY(e._textBgPic,1),e.addChild(e._textBgPic),e._handPic=StarlingSwfUtils.createImage("img_hand"),AnchorUtil.setAnchorX(e._handPic,.5),e.addChild(e._handPic),e._txt=new egret.TextField,e._txt.size=26,e._txt.textColor=5723991,e._txt.lineSpacing=4,AnchorUtil.setAnchorY(e._txt,.5),e.addChild(e._txt),egret.MainContext.instance.stage.addEventListener(egret.Event.RESIZE,e.onResize,e),e}return __extends(e,t),e.prototype.onResize=function(){this.stage&&egret.setTimeout(this.refurbish,this,500)},e.prototype.refurbish=function(){this.setData(this._obj,this._data)},e.prototype.setData=function(t,e){if(null!=t){this._obj=t,this._data=e,this._obj.localToGlobal(0,0,this._objGlobalPoint),this._obj.getBounds(this._objRec),this._objGlobalPoint.x=Math.ceil(this._objGlobalPoint.x),this._objGlobalPoint.y=Math.ceil(this._objGlobalPoint.y);var i=15,o=15;this._objRec.x=this._objGlobalPoint.x-i,this._objRec.y=this._objGlobalPoint.y-o,this._objRec.width+=2*i,this._objRec.height+=2*o,this._bg.init(egret.MainContext.instance.stage.stageWidth,egret.MainContext.instance.stage.stageHeight),this._bg.draw(this._objRec),this._maskPic.cacheAsBitmap=!1,this._maskPic.x=this._objRec.x,this._maskPic.y=this._objRec.y,this._maskPic.width=this._objRec.width,this._maskPic.height=this._objRec.height,this._maskPic.cacheAsBitmap=!0,1==this._data.handDir?(this._handPic.scaleY=1,this._handPic.y=this._objRec.y+this._objRec.height-20):2==this._data.handDir&&(this._handPic.scaleY=-1,this._handPic.y=this._objRec.y+20),this._handPic.x=this._objRec.x+.5*this._objRec.width,this._txt.width=0/0,this._txt.height=0/0,this._txt.text=this._data.txt,this._txt.width>320&&(this._txt.text="",this._txt.width=320,this._txt.text=this._data.txt);var r=15;this._textBgPic.cacheAsBitmap=!1,this._textBgPic.width=this._txt.width+2*r+35,this._textBgPic.height=114,1==this._data.txtdir?(this._textBgPic.scaleX=-1,this._textBgPic.scaleY=1,this._textBgPic.x=this._objRec.x):2==this._data.txtdir?(this._textBgPic.scaleX=-1,this._textBgPic.scaleY=-1,this._textBgPic.x=this._objRec.x):3==this._data.txtdir?(this._textBgPic.scaleX=1,this._textBgPic.scaleY=1,this._textBgPic.x=this._objRec.x+this._objRec.width):4==this._data.txtdir&&(this._textBgPic.scaleX=1,this._textBgPic.scaleY=-1,this._textBgPic.x=this._objRec.x+this._objRec.width),this.checkTextBgX(),this._textBgPic.y=this._objRec.y+.5*this._objRec.height,this._txt.x=this._textBgPic.x-(-1==this._textBgPic.scaleX?this._textBgPic.width:-35)+r,this._txt.y=this._textBgPic.y-this._textBgPic.scaleY*this._textBgPic.height*.5,this._textBgPic.cacheAsBitmap=!0}},e.prototype.checkTextBgX=function(){if(1==this._textBgPic.scaleX){var t=egret.MainContext.instance.stage.stageWidth;this._textBgPic.x+this._textBgPic.width>t&&(this._textBgPic.x=t-this._textBgPic.width)}else-1==this._textBgPic.scaleX&&this._textBgPic.x-this._textBgPic.width<0&&(this._textBgPic.x=this._textBgPic.width)},e}(egret.Sprite);__reflect(GuideView.prototype,"GuideView");var Menu=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(eui.Component);__reflect(Menu.prototype,"Menu");var SaleItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.titleDisplay&&(this.titleDisplay.text=this.data.title),this.priceDisplay&&(this.priceDisplay.text=this.data.price),this.timeDisplay&&(this.timeDisplay.text=this.data.time),this.iconDisplay&&(this.iconDisplay.source=this.data.icon)},e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i),this.data&&(i==this.titleDisplay&&(this.titleDisplay.text=this.data.title),i==this.priceDisplay&&(this.priceDisplay.text=this.data.price),i==this.timeDisplay&&(this.timeDisplay.text=this.data.time),i==this.iconDisplay&&(this.iconDisplay.source=this.data.icon))},e}(eui.ItemRenderer);__reflect(SaleItemRenderer.prototype,"SaleItemRenderer");var TabBarButton=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.mydata},set:function(t){this.mydata=t,this.iconDisplay&&(this.iconDisplay.source=this.data.title),this.iconDisplaySelected&&(this.iconDisplaySelected.source=this.data.titleSelected)},enumerable:!0,configurable:!0}),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i),this.data&&(i==this.iconDisplay&&(this.iconDisplay.source=this.data.title),i==this.iconDisplaySelected&&(this.iconDisplaySelected.source=this.data.titleSelected))},e}(eui.ItemRenderer);__reflect(TabBarButton.prototype,"TabBarButton");var TabBarContainer=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return e||(e="resource/skins/TabBarSkin.exml"),i._tabBarItemRendererSkinName="resource/skins/TabBarButtonSkin.exml",i._tabBarItemRenderer=TabBarButton,i._dp=new eui.ArrayCollection,i._views=[],i.skinName=e,i}return __extends(e,t),e.prototype.onTabBarIndexChanged=function(t){this.viewStack.selectedIndex=this.tabBar.selectedIndex},e.prototype.partAdded=function(e,i){if(t.prototype.partAdded.call(this,e,i),i==this.tabBar)this.tabBar.itemRendererSkinName=this._tabBarItemRendererSkinName,this.tabBar.itemRenderer=this._tabBarItemRenderer,this.tabBar.dataProvider=this._dp,this.tabBar.addEventListener(egret.Event.CHANGE,this.onTabBarIndexChanged,this);else if(i==this.viewStack){for(var o=0;o<this._views.length;o++)this.viewStack.addChild(this._views[o]);this._views.length=0,this.tabBar.selectedIndex=0,this.viewStack.selectedIndex=0}},Object.defineProperty(e.prototype,"tabBarItemRendererSkinName",{set:function(t){this._tabBarItemRendererSkinName=t,this.tabBar&&(this.tabBar.itemRendererSkinName=this._tabBarItemRendererSkinName)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabBarItemRenderer",{set:function(t){this._tabBarItemRenderer=t,this.tabBar&&(this.tabBar.itemRenderer=this._tabBarItemRenderer)},enumerable:!0,configurable:!0}),e.prototype.addViewStackElement=function(t,e,i){this._dp.addItem({title:t,titleSelected:e}),this.viewStack?this.viewStack.addChild(i):this._views.push(i)},e}(eui.Component);__reflect(TabBarContainer.prototype,"TabBarContainer");var TaskItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.iconDisplay&&(this.iconDisplay.source=this.data.icon),this.goldDisplay&&(this.goldDisplay.text=this.data.gold),this.seedDisplay&&(this.seedDisplay.text=this.data.seed),this.progressDisplay&&(this.progressDisplay.text=this.data.progress),this.labelDisplay&&(this.labelDisplay.text=this.data.label)},e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i),this.data&&(i==this.iconDisplay&&(this.iconDisplay.source=this.data.icon),i==this.goldDisplay&&(this.goldDisplay.text=this.data.gold),i==this.seedDisplay&&(this.seedDisplay.text=this.data.seed),i==this.progressDisplay&&(this.progressDisplay.text=this.data.progress),i==this.labelDisplay&&(this.labelDisplay.text=this.data.label))},e}(eui.ItemRenderer);__reflect(TaskItemRenderer.prototype,"TaskItemRenderer");var FactoryController=function(t){function e(){var e=t.call(this)||this;return e.factoryView=new FactoryView(e,LayerManager.UI_Popup),App.ViewManager.register(ViewConst.Factory,e.factoryView),e}return __extends(e,t),e}(BaseController);__reflect(FactoryController.prototype,"FactoryController");var FactoryView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.icon="icon_factory_tittle",o}return __extends(e,t),e}(BasePanelView);__reflect(FactoryView.prototype,"FactoryView");var FriendController=function(t){function e(){var e=t.call(this)||this;return e.friendView=new FriendView(e,LayerManager.UI_Popup),App.ViewManager.register(ViewConst.Friend,e.friendView),e}return __extends(e,t),e}(BaseController);__reflect(FriendController.prototype,"FriendController");var FriendView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.icon="table_tittle",o}return __extends(e,t),e}(BasePanelView);__reflect(FriendView.prototype,"FriendView");var GameConst=function(){function t(){}return t.Get_Hero=1e4,t.Remove_Enemy=10001,t}();__reflect(GameConst.prototype,"GameConst");var GameController=function(t){function e(){var e=t.call(this)||this;return e.checkHitRectangle_Att=new egret.Rectangle,e.checkHitRectangle_Def=new egret.Rectangle,e.canAttackObjs=new Array,e.gameView=new GameView(e,LayerManager.Game_Main),App.ViewManager.register(ViewConst.Game,e.gameView),e.gameUIView=new GameUIView(e,LayerManager.Game_Main),App.ViewManager.register(ViewConst.GameUI,e.gameUIView),e.registerFunc(GameConst.Get_Hero,e.getHero,e),e.registerFunc(GameConst.Remove_Enemy,e.removeEnemy,e),e}return __extends(e,t),e.prototype.getHero=function(){return this.gameView.hero},e.prototype.removeEnemy=function(t){this.gameView.removeEnemy(t)},e.prototype.shock=function(){App.ShockUtils.shock(App.ShockUtils.MAP,this.gameView)},e.prototype.slowMotion=function(){App.ShockUtils.destroy(),AnchorUtil.setAnchor(this.gameView,.5),this.gameView.x=.5*App.StageUtils.getWidth(),this.gameView.y=.5*App.StageUtils.getHeight(),this.gameView.width=App.StageUtils.getWidth(),this.gameView.height=App.StageUtils.getHeight(),App.TimerManager.setTimeScale(.1),egret.Tween.get(this.gameView).to({scaleX:1.1,scaleY:1.1},1200).to({scaleX:1,scaleY:1},300).call(this.slowMotionEnd,this)},e.prototype.slowMotionEnd=function(){AnchorUtil.setAnchor(this.gameView,0),this.gameView.x=0,this.gameView.y=0,App.TimerManager.setTimeScale(1)},e.prototype.getMyAttackObjects=function(t,e){if(this.canAttackObjs.length=0,t instanceof Enemy)!this.gameView.hero.isLand&&this.checkIsInDis(t,this.gameView.hero,e)&&this.canAttackObjs.push(this.gameView.hero);else if(t instanceof Hero)for(var i=0,o=this.gameView.enemys.length;o>i;i++){var r=this.gameView.enemys[i];r.isDie||r.isLand||r.isInScreen&&this.checkIsInDis(t,r,e)&&this.canAttackObjs.push(r)}return this.canAttackObjs},e.prototype.getMyNearAttackObjects=function(t){return t instanceof Enemy?this.gameView.hero:null},e.prototype.checkIsInDis=function(t,e,i){var o=i[0],r=i[1],n=i[2],a=i[3],s=i[4],h=i[5],p=e.y<=t.y?n:a;return this.checkHitRectangle_Att.x=t.x-(1==t.scaleX?r:o),this.checkHitRectangle_Att.y=t.z-s,this.checkHitRectangle_Att.width=o+r,this.checkHitRectangle_Att.height=s+h,this.checkHitRectangle_Def.x=e.x-.5*e.width,this.checkHitRectangle_Def.y=e.z-e.height,this.checkHitRectangle_Def.width=e.width,this.checkHitRectangle_Def.height=e.height,Math.abs(e.y-t.y)<=p&&this.checkHitRectangle_Att.intersects(this.checkHitRectangle_Def)},e}(BaseController);__reflect(GameController.prototype,"GameController");var GameData=function(){function t(){}return t}();__reflect(GameData.prototype,"GameData");var GameUIView=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addChild(this.createImageButton("ui_btnAttack_png","ui_btnAttack1_png",App.StageUtils.getWidth()-55,App.StageUtils.getHeight()-53,this.heroAttack)),this.addChild(this.createImageButton("ui_btnSkill1_png","ui_btnSkill1_1_png",App.StageUtils.getWidth()-120,App.StageUtils.getHeight()-140,this.heroSkill1)),this.addChild(this.createImageButton("ui_btnSkill2_png","ui_btnSkill2_1_png",App.StageUtils.getWidth()-40,App.StageUtils.getHeight()-160,this.heroSkill2)),this.addChild(this.createImageButton("ui_btnSkill3_png","ui_btnSkill3_1_png",App.StageUtils.getWidth()-180,App.StageUtils.getHeight()-40,this.heroSkill3)),this.addChild(this.createImageButton("ui_btnSkill4_png","ui_btnSkill4_1_png",App.StageUtils.getWidth()-200,App.StageUtils.getHeight()-120,this.heroSkill4));var e=120,i=App.StageUtils.getHeight()-120,o=App.DisplayUtils.createBitmap("ui_moveBg_png");AnchorUtil.setAnchor(o,.5),o.x=e,o.y=i,this.addChild(o);var r=App.DisplayUtils.createBitmap("ui_move_png");AnchorUtil.setAnchor(r,.5),r.x=e,r.y=i,this.addChild(r),App.RockerUtils.init(o,r,this.dealKey,this),App.KeyboardUtils.addKeyUp(this.onKeyUp,this)},e.prototype.initData=function(){t.prototype.initData.call(this),this.hero=this.applyFunc(GameConst.Get_Hero)},e.prototype.dealKey=function(t,e){return this.hero.isAttack?!1:this.hero.isJump?!1:this.hero.isHurt?!1:this.hero.isLand?!1:t||e?(this.hero.walk(t,e,7),!0):(this.hero.isMove&&this.hero.stopMove(),!1)},e.prototype.onKeyUp=function(t){switch(t){case Keyboard.J:this.heroAttack();break;case Keyboard.K:break;case Keyboard.U:this.heroSkill1();break;case Keyboard.I:this.heroSkill2();break;case Keyboard.O:this.heroSkill3();break;case Keyboard.P:this.heroSkill4()}},e.prototype.heroAttack=function(){return this.hero.isAttack?void this.hero.addMaxAttackIndex():void this.hero.attack()},e.prototype.heroSkill1=function(){this.hero.skill(1)},e.prototype.heroSkill2=function(){this.hero.skill(2)},e.prototype.heroSkill3=function(){this.hero.skill(3)},e.prototype.heroSkill4=function(){this.hero.skill(4)},e.prototype.createImageButton=function(t,e,i,o,r){var n=App.DisplayUtils.createBitmap(t);return n.touchEnabled=!0,AnchorUtil.setAnchor(n,.5),n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){n.texture=RES.getRes(e)},this),n.addEventListener(egret.TouchEvent.TOUCH_END,function(){n.texture=RES.getRes(t)},this),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r.call(this)},this),n.x=i,n.y=o,n},e}(BaseSpriteView);__reflect(GameUIView.prototype,"GameUIView");var GameView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.controller=e,o}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),GameData.MIN_X=50,GameData.MAX_X=App.StageUtils.getWidth()-50,GameData.MIN_Y=App.StageUtils.getHeight()-300,GameData.MAX_Y=App.StageUtils.getHeight()-10,this.bg=App.DisplayUtils.createBitmap("map_jpg"),AnchorUtil.setAnchorX(this.bg,.5),AnchorUtil.setAnchorY(this.bg,1),this.bg.x=.5*App.StageUtils.getWidth(),this.bg.y=App.StageUtils.getHeight(),this.addChild(this.bg),this.objectContainer=new egret.DisplayObjectContainer,this.addChild(this.objectContainer),this.enemys=new Array;for(var e=0;4>e;e++){var i=ObjectPool.pop("Enemy",this.controller);i.init(),this.enemys.push(i)}for(;this.enemys.length;)this.enemys.pop().destory();var o=ObjectPool.pop("Boss",this.controller);o.destory(),this.hero=ObjectPool.pop("Hero",this.controller),this.hero.init(),this.hero.x=.3*App.StageUtils.getWidth(),this.hero.y=.7*App.StageUtils.getHeight(),this.objectContainer.addChild(this.hero),this.startCreateEnemy(),App.DeviceUtils.IsMobile||(this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)),App.TimerManager.doTimer(3,0,this.sortGameObjs,this)},e.prototype.initData=function(){t.prototype.initData.call(this)},e.prototype.startCreateEnemy=function(){this.enemys.length=0,App.TimerManager.doTimer(100,0,this.createEnemy,this)},e.prototype.createEnemy=function(){this.enemys.push(this.createEnemySingle("Enemy")),this.enemys.length>=4&&App.TimerManager.remove(this.createEnemy,this)},e.prototype.createBoss=function(){for(var t=0,e=this.enemys.length;e>t;t++)if(this.enemys[t]instanceof Boss)return;this.enemys.push(this.createEnemySingle("Boss"))},e.prototype.createEnemySingle=function(t){var e=Math.random()>.5?GameData.MAX_X+200:GameData.MIN_X-200,i=App.RandomUtils.limit(GameData.MIN_Y,GameData.MAX_Y),o=ObjectPool.pop(t,this.controller);o.init(),o.x=e,o.y=i,o.setPos(),o.scaleX=Math.random()<.5?1:-1,this.objectContainer.addChild(o);var r=App.RandomUtils.limit(GameData.MIN_X,GameData.MAX_X),n=i;return o.command_in(3,r,n),o},e.prototype.removeEnemy=function(t){var e=this.enemys.indexOf(t);-1!=e&&(this.enemys.splice(e,1),0==this.enemys.length?this.startCreateEnemy():2==this.enemys.length&&this.createBoss())},e.prototype.sortGameObjs=function(){this.objectContainer.$children.sort(this.sortF)},e.prototype.sortF=function(t,e){return t.y>e.y?1:t.y<e.y?-1:0},e.prototype.onClick=function(t){this.hero.isAttack||t.localX<GameData.MIN_X||t.localX>GameData.MAX_X||t.localY<GameData.MIN_Y||t.localY>GameData.MAX_Y||(App.RockerUtils.stop(),this.hero.walkTo(5,t.localX,t.localY))
},e}(BaseSpriteView);__reflect(GameView.prototype,"GameView");var MyButton=function(t){function e(e,i,o,r,n){var a=t.call(this)||this;a._func=r,a._target=n,a.width=100,a.height=40,a.graphics.beginFill(3355443,1),a.graphics.drawRect(0,0,a.width,a.height),a.graphics.endFill();var s=new egret.TextField;return s.textColor=16777215,s.textAlign=egret.HorizontalAlign.CENTER,s.text=e,s.width=a.width,s.height=20,s.size=20,s.y=.5*(a.height-s.height),a.addChild(s),a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,a.onClick,a),a.x=i,a.y=o,a}return __extends(e,t),e.prototype.onClick=function(t){t.stopPropagation(),this._func&&this._func.call(this._target)},e}(egret.Sprite);__reflect(MyButton.prototype,"MyButton");var EasyLoading=function(t){function e(){var e=t.call(this)||this;return e.content=null,e.speed=.6,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.averageUtils=new AverageUtils,this.content=new egret.Sprite,this.content.graphics.beginFill(0,.2),this.content.graphics.drawRect(0,0,App.StageUtils.getWidth(),App.StageUtils.getHeight()),this.content.graphics.endFill(),this.content.touchEnabled=!0,this.uiImageContainer=new egret.DisplayObjectContainer,this.uiImageContainer.x=.5*this.content.width,this.uiImageContainer.y=.5*this.content.height,this.content.addChild(this.uiImageContainer),RES.getResByUrl("resource/assets/load_Reel.png",function(t){var e=new egret.Bitmap;e.texture=t,e.x=.5*-e.width,e.y=.5*-e.height,this.uiImageContainer.addChild(e)},this,RES.ResourceItem.TYPE_IMAGE)},e.prototype.showLoading=function(){App.StageUtils.getStage().addChild(this.content),App.TimerManager.doFrame(1,0,this.enterFrame,this)},e.prototype.hideLoading=function(){this.content&&this.content.parent&&(App.StageUtils.getStage().removeChild(this.content),this.uiImageContainer.rotation=0),App.TimerManager.remove(this.enterFrame,this)},e.prototype.enterFrame=function(t){this.averageUtils.push(this.speed*t),this.uiImageContainer.rotation+=this.averageUtils.getValue()},e}(BaseClass);__reflect(EasyLoading.prototype,"EasyLoading");var ControllerManager=function(t){function e(){var e=t.call(this)||this;return e._modules={},e}return __extends(e,t),e.prototype.clear=function(){this._modules={}},e.prototype.register=function(t,e){this.isExists(t)||(this._modules[t]=e)},e.prototype.unregister=function(t){this.isExists(t)&&(this._modules[t]=null,delete this._modules[t])},e.prototype.isExists=function(t){return null!=this._modules[t]},e.prototype.applyFunc=function(t,e){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var r=this._modules[t];if(Log.trace(arguments),r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];return r.applyFunc.apply(r,n)}return Log.trace("模块"+t+"不存在"),null},e.prototype.getControllerModel=function(t){var e=this._modules[t];return e?e.getModel():null},e}(BaseClass);__reflect(ControllerManager.prototype,"ControllerManager");var ViewManager=function(t){function e(){var e=t.call(this)||this;return e._views={},e._opens=[],e}return __extends(e,t),e.prototype.clear=function(){this.closeAll(),this._views={}},e.prototype.register=function(t,e){null!=e&&(this._views[t]||(this._views[t]=e))},e.prototype.unregister=function(t){this._views[t]&&(this._views[t]=null,delete this._views[t])},e.prototype.destroy=function(t,e){void 0===e&&(e=null);var i=this.getView(t);i&&(this.unregister(t),i.destroy(),i=null),this.register(t,e)},e.prototype.open=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=this.getView(t);return null==o?void Log.trace("UI_"+t+"不存在"):o.isShow()?(o.open.apply(o,e),o):(o.isInit()?(o.addToParent(),o.open.apply(o,e)):(App.EasyLoading.showLoading(),o.loadResource(function(){o.setVisible(!1),o.addToParent()}.bind(this),function(){o.initUI(),o.initData(),o.open.apply(o,e),o.setVisible(!0),App.EasyLoading.hideLoading()}.bind(this))),this._opens.push(t),o)},e.prototype.close=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(this.isShow(t)){var o=this.getView(t);if(null!=o){var r=this._opens.indexOf(t);t>=0&&this._opens.splice(r,1),o.removeFromParent(),o.close.apply(o,e)}}},e.prototype.closeView=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var o=Object.keys(this._views),r=0,n=o.length;n>r;r++){var a=parseInt(o[r]);if(this._views[a]==t)return void this.close(a,e)}},e.prototype.getView=function(t){return this._views[t]},e.prototype.closeAll=function(){for(;this._opens.length;)this.close(this._opens[0])},e.prototype.currOpenNum=function(){return this._opens.length},e.prototype.isShow=function(t){return-1!=this._opens.indexOf(t)},e}(BaseClass);__reflect(ViewManager.prototype,"ViewManager");var App=function(){function t(){}return Object.defineProperty(t,"Http",{get:function(){return Http.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Socket",{get:function(){return Socket.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ControllerManager",{get:function(){return ControllerManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ViewManager",{get:function(){return ViewManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SceneManager",{get:function(){return SceneManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DebugUtils",{get:function(){return DebugUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MessageCenter",{get:function(){return MessageCenter.getInstance(0)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TimerManager",{get:function(){return TimerManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DateUtils",{get:function(){return DateUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MathUtils",{get:function(){return MathUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RandomUtils",{get:function(){return RandomUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DisplayUtils",{get:function(){return DisplayUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BitmapNumber",{get:function(){return BitmapNumber.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GuideUtils",{get:function(){return GuideUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"StageUtils",{get:function(){return StageUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EffectUtils",{get:function(){return EffectUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"StringUtils",{get:function(){return StringUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CommonUtils",{get:function(){return CommonUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SoundManager",{get:function(){return SoundManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DeviceUtils",{get:function(){return DeviceUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EgretExpandUtils",{get:function(){return EgretExpandUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"KeyboardUtils",{get:function(){return KeyboardUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RockerUtils",{get:function(){return RockerUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ShockUtils",{get:function(){return ShockUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ResourceUtils",{get:function(){return ResourceUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RenderTextureManager",{get:function(){return RenderTextureManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TextFlowMaker",{get:function(){return TextFlowMaker.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"NotificationCenter",{get:function(){return null==t._notificationCenter&&(t._notificationCenter=new MessageCenter(1)),t._notificationCenter},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DelayOptManager",{get:function(){return DelayOptManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ArrayUtils",{get:function(){return ArrayUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EasyLoading",{get:function(){return EasyLoading.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ResVersionManager",{get:function(){return ResVersionManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DragonBonesFactory",{get:function(){return DragonBonesFactory.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"StarlingSwfFactory",{get:function(){return StarlingSwfFactory.getInstance()},enumerable:!0,configurable:!0}),t.Init=function(){t.GlobalData=RES.getRes("global"),t.DebugUtils.isOpen(t.GlobalData.IsDebug),t.DebugUtils.setThreshold(5),t.EgretExpandUtils.init(),t.Http.initServer(t.GlobalData.HttpSerever),t.ProtoFile=dcodeIO.ProtoBuf.loadProto(RES.getRes(t.GlobalData.ProtoFile)),t.ProtoConfig=RES.getRes(t.GlobalData.ProtoConfig),t.Socket.initServer(t.GlobalData.SocketServer,t.GlobalData.SocketPort,new ByteArrayMsgByProtobuf)},t.ProxyUserFlag="",t.GlobalData=null,t.ProtoFile=null,t.ProtoConfig=null,t}();__reflect(App.prototype,"App");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function o(o){e.call(i,o,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?o(r):RES.getResAsync(t,o,this)}else RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Boss=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.move_time=App.RandomUtils.limitInteger(1e3,2e3),this.attack_time=App.RandomUtils.limitInteger(1e3,2e3),this.hp=500,this.setAttackType(1)},e.prototype.createArmature=function(){this.armature.register(App.DragonBonesFactory.makeArmature("guaiwu002","guaiwu002",1.2),[BaseGameObject.ACTION_Idle,BaseGameObject.ACTION_Move,BaseGameObject.ACTION_Hart,BaseGameObject.ACTION_Fly,BaseGameObject.ACTION_Land,BaseGameObject.ACTION_jump,Enemy.ACTION_Attack,Enemy.ACTION_Skill1]),this.armature.register(App.DragonBonesFactory.makeArmature("guaiwu003","guaiwu003",1.2),[Enemy.ACTION_Skill2]),this.armature.addCompleteCallFunc(this.armaturePlayEnd,this),this.initFrameData("guaiwu002"),this.effectArmature=new DragonBonesArmatureContainer,this.effectArmature.register(App.DragonBonesFactory.makeArmature("guaiwu002_effect","guaiwu002_effect",1.2),[Enemy.ACTION_Attack,Enemy.ACTION_Skill1]),this.effectArmature.register(App.DragonBonesFactory.makeArmature("guaiwu003_effect","guaiwu003_effect",1.2),[Enemy.ACTION_Skill2])},e.prototype.setAttackType=function(t){this.attackType=t,1==this.attackType?this.ai_attack_dis=this.attackConfig.attack1.dis:2==this.attackType?this.ai_attack_dis=this.attackConfig.skill1.dis:3==this.attackType&&(this.ai_attack_dis=this.attackConfig.skill2_3.dis)},e.prototype.update=function(e){t.prototype.update.call(this,e)},e.prototype.armaturePlayEnd=function(e,i){t.prototype.armaturePlayEnd.call(this,e,i),i==Enemy.ACTION_Attack?this.setAttackType(2):i==Enemy.ACTION_Skill1?(this.gotoIdle(),this.setAttackType(3)):i==Enemy.ACTION_Skill2&&(this.gotoIdle(),this.setAttackType(1))},e.prototype.playAttackArmature=function(){var t;1==this.attackType?(t=Enemy.ACTION_Attack,App.SoundManager.playEffect("sound_bossAttack")):2==this.attackType?(t=Enemy.ACTION_Skill1,App.SoundManager.playEffect("sound_bossSkill")):3==this.attackType&&(t=Enemy.ACTION_Skill2,App.SoundManager.playEffect("sound_bossSkill")),this.armature.play(t,1),this.playEffect(t)},e.prototype.die=function(){t.prototype.die.call(this),this.jump(-40,-10*this.scaleX),this.gameController.slowMotion()},e.prototype.removeEffect=function(){this.effectArmature.stop(),App.DisplayUtils.removeFromParent(this.effectArmature)},e.prototype.playEffect=function(t){this.effectArmature.play(t,1)?this.addChild(this.effectArmature):this.removeEffect()},e.prototype.leave=function(){t.prototype.leave.call(this),this.stopMove(),this.setAttackType(2),this.gotoAttack()},e.prototype.gotoIdle=function(){t.prototype.gotoIdle.call(this),this.removeEffect()},e.prototype.destory=function(){t.prototype.destory.call(this),this.removeEffect()},e}(Enemy);__reflect(Boss.prototype,"Boss");var MergeJsonAnalyzer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mergeJsons=["MergeConfig_json"],e}return __extends(e,t),e.prototype.analyzeData=function(t,e){var i=t.name;if(!this.fileDic[i]&&e)try{var o=JSON.parse(e);if(-1!=this.mergeJsons.indexOf(i))for(var r in o)this.fileDic[r]=o[r];else this.fileDic[i]=o}catch(n){egret.$warn(1017,t.url,e)}},e}(RES.JsonAnalyzer);__reflect(MergeJsonAnalyzer.prototype,"MergeJsonAnalyzer");var Hero=function(t){function e(i){var o=t.call(this,i)||this;return o.attackMaxIndex=0,o.attackIndex=0,o.armature.register(App.DragonBonesFactory.makeArmature("zhujue1","zhujue1",1.4),[BaseGameObject.ACTION_Idle,BaseGameObject.ACTION_Move,BaseGameObject.ACTION_Hart,BaseGameObject.ACTION_Fly,BaseGameObject.ACTION_Land,BaseGameObject.ACTION_jump,e.ACTION_Attack0,e.ACTION_Attack1,e.ACTION_Attack2,e.ACTION_Attack3,e.ACTION_Skill1]),o.armature.register(App.DragonBonesFactory.makeArmature("zhujue2","zhujue2",1.4),[e.ACTION_Skill2,e.ACTION_Skill3,e.ACTION_Skill4]),o.armature.addCompleteCallFunc(o.armaturePlayEnd,o),o.initFrameData("zhujue1"),o.effectArmature=new DragonBonesArmatureContainer,o.effectArmature.register(App.DragonBonesFactory.makeArmature("jineng1","jineng1",1.4),[e.ACTION_Attack0,e.ACTION_Attack1,e.ACTION_Attack2,e.ACTION_Attack3,e.ACTION_Skill1]),o.effectArmature.register(App.DragonBonesFactory.makeArmature("jineng2","jineng2",1.4),[e.ACTION_Skill2,e.ACTION_Skill3,e.ACTION_Skill4]),o}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.isAi=!1,this.gotoIdle()},e.prototype.destory=function(){t.prototype.destory.call(this),this.removeEffect()},e.prototype.armaturePlayEnd=function(t,i){i==e.ACTION_Attack0||i==e.ACTION_Attack1||i==e.ACTION_Attack2?this.attackMaxIndex>this.attackIndex?this.nextAttack():this.overAttack():i==e.ACTION_Attack3?this.overAttack():i==e.ACTION_Skill1||i==e.ACTION_Skill2||i==e.ACTION_Skill3||i==e.ACTION_Skill4?this.overSkill():i==e.ACTION_Hart&&this.gotoIdle()},e.prototype.addMaxAttackIndex=function(){this.attackMaxIndex++,this.attackMaxIndex>3&&(this.attackMaxIndex=3)},e.prototype.attack=function(){this.isJump||this.isHurt||this.isLand||(this.isMove&&this.stopMove(),this.gotoAttack(),this.armature.play(e["ACTION_Attack"+this.attackIndex],1),this.playEffect(e["ACTION_Attack"+this.attackIndex]),App.SoundManager.playEffect("sound_heroAttack"))},e.prototype.nextAttack=function(){this.attackIndex++,this.attack()},e.prototype.overAttack=function(){this.attackMaxIndex=0,this.attackIndex=0,this.gotoIdle()},e.prototype.skill=function(t){this.isAttack||this.isJump||this.isHurt||this.isLand||(this.isMove&&this.stopMove(),this.gotoAttack(),this.armature.play(e["ACTION_Skill"+t],1),this.playEffect(e["ACTION_Skill"+t]),App.SoundManager.playEffect("sound_heroSkill"))},e.prototype.overSkill=function(){this.gotoIdle()},e.prototype.gotoIdle=function(){t.prototype.gotoIdle.call(this),this.removeEffect()},e.prototype.removeEffect=function(){this.effectArmature.stop(),App.DisplayUtils.removeFromParent(this.effectArmature)},e.prototype.playEffect=function(t){this.effectArmature.play(t,1)?this.addChild(this.effectArmature):this.removeEffect()},e.prototype.die=function(){},e.prototype.fly=function(e,i,o){t.prototype.fly.call(this,e,i,o),App.SoundManager.playEffect("sound_heroBeiji")},e.prototype.hart=function(e,i,o){t.prototype.hart.call(this,e,i,o),App.SoundManager.playEffect("sound_heroBeiji")},e.prototype.hartFly=function(e,i,o){t.prototype.hartFly.call(this,e,i,o),App.SoundManager.playEffect("sound_heroBeiji")},e.ACTION_Attack0="gongji1",e.ACTION_Attack1="gongji2",e.ACTION_Attack2="gongji3",e.ACTION_Attack3="gongji4",e.ACTION_Skill1="jineng1",e.ACTION_Skill2="jineng2",e.ACTION_Skill3="jineng3",e.ACTION_Skill4="jineng4",e}(BaseFrameGameObject);__reflect(Hero.prototype,"Hero");var HomeConst=function(){function t(){}return t}();__reflect(HomeConst.prototype,"HomeConst");var HomeController=function(t){function e(){var e=t.call(this)||this;return e.proxy=new HomeProxy(e),e.homeView=new HomeView(e,LayerManager.UI_Main),App.ViewManager.register(ViewConst.Home,e.homeView),e}return __extends(e,t),e}(BaseController);__reflect(HomeController.prototype,"HomeController");var HomeProxy=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(BaseProxy);__reflect(HomeProxy.prototype,"HomeProxy");var HomeView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.skinName="resource/skins/GuiScreenSkin.exml",o}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.menu.addEventListener(egret.TouchEvent.TOUCH_TAP,this.menuClickHandler,this),this.menuBtn.addEventListener(egret.Event.CHANGE,this.menuBtnChangeHandler,this),this.friendBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.friendClickHandler,this),this.shopBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shopClickHandler,this),this.warehouseBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.warehouseClickHandler,this),this.factoryBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.factoryClickHandler,this),this.moreBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.moreClickHandler,this)},e.prototype.playSound=function(){App.SoundManager.playEffect("sound_dianji")},e.prototype.friendClickHandler=function(t){this.playSound(),App.ViewManager.open(ViewConst.Friend)},e.prototype.shopClickHandler=function(t){this.playSound(),App.ViewManager.open(ViewConst.Shop)},e.prototype.warehouseClickHandler=function(t){this.playSound(),App.ViewManager.open(ViewConst.Warehouse)},e.prototype.factoryClickHandler=function(t){this.playSound(),App.ViewManager.open(ViewConst.Factory)},e.prototype.moreClickHandler=function(t){this.playSound()},e.prototype.menuBtnChangeHandler=function(t){this.playSound(),this.menu&&(this.menu.visible=this.menuBtn.selected)},e.prototype.menuClickHandler=function(t){console.log(t.target),t.target==this.menu.taskBtn?(this.playSound(),App.ViewManager.open(ViewConst.Task),this.menuBtn.selected=!1,this.menu.visible=!1):t.target==this.menu.dailyBtn?(this.playSound(),App.ViewManager.open(ViewConst.Daily),this.menuBtn.selected=!1,this.menu.visible=!1):t.target==this.menu.mailBtn&&(this.playSound(),App.ViewManager.open(ViewConst.Mail),this.menuBtn.selected=!1,this.menu.visible=!1)},e}(BaseEuiView);__reflect(HomeView.prototype,"HomeView");var LoadingConst=function(){function t(){}return t.SetProgress=10001,t}();__reflect(LoadingConst.prototype,"LoadingConst");var LoadingController=function(t){function e(){var e=t.call(this)||this;return e.loadingView=new LoadingView(e,LayerManager.UI_Main),App.ViewManager.register(ViewConst.Loading,e.loadingView),e.registerFunc(LoadingConst.SetProgress,e.setProgress,e),e}return __extends(e,t),e.prototype.setProgress=function(t,e){this.loadingView.setProgress(t,e)},e}(BaseController);__reflect(LoadingController.prototype,"LoadingController");var LoadingView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.skinName="resource/skins/LoadingUISkin.exml",o}return __extends(e,t),e.prototype.setProgress=function(t,e){this.txtMsg.text="资源加载中..."+t+"/"+e},e}(BaseEuiView);__reflect(LoadingView.prototype,"LoadingView");var LoginConst=function(){function t(){}return t.LOGIN_C2S=10001,t.LOGIN_S2C=10002,t}();__reflect(LoginConst.prototype,"LoginConst");var LoginController=function(t){function e(){var e=t.call(this)||this;return e.loginModel=new LoginModel(e),e.loginView=new LoginView(e,LayerManager.UI_Main),App.ViewManager.register(ViewConst.Login,e.loginView),e.loginProxy=new LoginProxy(e),e.registerFunc(LoginConst.LOGIN_C2S,e.onLogin,e),e.registerFunc(LoginConst.LOGIN_S2C,e.loginSuccess,e),e}return __extends(e,t),e.prototype.onLogin=function(t,e){this.loginProxy.login(t,e)},e.prototype.loginSuccess=function(t){this.loginModel.userInfo=t,this.loginView.loginSuccess(),App.ViewManager.close(ViewConst.Login);this.getControllerModel(ControllerConst.Login)},e}(BaseController);__reflect(LoginController.prototype,"LoginController");var LoginModel=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(BaseModel);__reflect(LoginModel.prototype,"LoginModel");var LoginProxy=function(t){function e(e){var i=t.call(this,e)||this;return i.receiveServerMsg(HttpConst.USER_LOGIN,i.loginSuccess,i),i}return __extends(e,t),e.prototype.login=function(t,e){var i={uName:t,uPass:e};this.sendHttpMsg(HttpConst.USER_LOGIN,i)},e.prototype.loginSuccess=function(t){this.applyFunc(LoginConst.LOGIN_S2C,t)},e}(BaseProxy);__reflect(LoginProxy.prototype,"LoginProxy");var LoginView=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLogin,this)},e.prototype.initData=function(){t.prototype.initData.call(this)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e)},e.prototype.close=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.close.call(this,e)},e.prototype.onLogin=function(){var t="yangsong",e="123456";null!=t&&0!=t.length&&null!=e&&0!=e.length&&this.applyFunc(LoginConst.LOGIN_C2S,t,e)},e.prototype.loginSuccess=function(){},e}(BaseEuiView);__reflect(LoginView.prototype,"LoginView");var MailController=function(t){function e(){var e=t.call(this)||this;return e.mailView=new MailView(e,LayerManager.UI_Popup),App.ViewManager.register(ViewConst.Mail,e.mailView),e}return __extends(e,t),e}(BaseController);__reflect(MailController.prototype,"MailController");var MailView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.icon="table_mail",o}return __extends(e,t),e}(BasePanelView);__reflect(MailView.prototype,"MailView");var RpgGameConst=function(){function t(){}return t.GameInit=1e4,t.GameResize=10001,t}();__reflect(RpgGameConst.prototype,"RpgGameConst");var RpgGameController=function(t){function e(){var e=t.call(this)||this;return e.gameView=new RpgGameView(e,LayerManager.Game_Main),App.ViewManager.register(ViewConst.RpgGame,e.gameView),e.gameModel=new RpgGameModel(e),e.registerFunc(RpgGameConst.GameInit,e.gameInit,e),e.registerFunc(RpgGameConst.GameResize,e.gameResize,e),e}return __extends(e,t),e.prototype.gameInit=function(t){this.gameModel.mapId=t,this.gameModel.playerData={mcName:"scenePlayer_0",propertyData:{name:"yangsong",title:"[开发者]",vip:8,attackDis:3,attackInterval:1500,hp:9999999}},this.gameModel.monsterNum=200,App.ViewManager.open(ViewConst.RpgGame,this.gameModel)},e.prototype.gameResize=function(){this.gameView.resize()},e}(BaseController);__reflect(RpgGameController.prototype,"RpgGameController");var RpgGameData=function(){function t(){}return t.GameTileWidth=256,t.GameTileHeight=256,t.GameCellWidth=32,t.GameCellHeight=16,t.GameAoiWidth=256,t.GameAoiHeight=256,t.WalkSpeed=3,t}();__reflect(RpgGameData.prototype,"RpgGameData");var RpgGameModel=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(BaseModel);__reflect(RpgGameModel.prototype,"RpgGameModel");var RpgGameRes=function(){function t(){}return t.clearAvatar=function(t){var e="avatarGroup_"+t;this.LoadingResList[e]&&(this.LoadingResList[e]=null,delete this.LoadingResList[e]),this.ComplateResList[e]&&(this.ComplateResList[e]=null,delete this.ComplateResList[e]),RES.destroyRes(e)},t.loadAvatar=function(t,e,i,o){var r="avatarGroup_"+e;if(this.ComplateResList[r])i.call(o);else if(this.LoadingResList[r])this.LoadingResList[r].push([i,o]);else{this.LoadingResList[r]=[],this.LoadingResList[r].push([i,o]);var n=[];[{name:e+".json",type:"json"},{name:e+".png",type:"image"}].forEach(function(e){var i="avatar_"+e.name;n.push(i),App.ResourceUtils.createResource(i,e.type,t+e.name)}),App.ResourceUtils.createGroup(r,n),App.ResourceUtils.loadGroup(r,this.onLoadGroupComplate,this.onLoadGroupProgress,this)}},t.onLoadGroupComplate=function(t){var e=this.LoadingResList[t];e.forEach(function(t){t[0].call(t[1])}),this.LoadingResList[t]=null,delete this.LoadingResList[t],this.ComplateResList[t]=1},t.onLoadGroupProgress=function(t){},t.ComplateResList={},t.LoadingResList={},t}();__reflect(RpgGameRes.prototype,"RpgGameRes");var RpgGameUtils=function(){function t(){}return t.convertCellToXY=function(t,e){return this._convertUsePoint.x=t*RpgGameData.GameCellWidth+.5*RpgGameData.GameCellWidth,this._convertUsePoint.y=e*RpgGameData.GameCellHeight+.5*RpgGameData.GameCellHeight,this._convertUsePoint},t.convertXYToCell=function(t,e){return this._convertUsePoint.x=Math.floor(t/RpgGameData.GameCellWidth),this._convertUsePoint.y=Math.floor(e/RpgGameData.GameCellHeight),this._convertUsePoint},t.convertXYToAoi=function(t,e){return this._convertUsePoint.x=Math.floor(t/RpgGameData.GameAoiWidth),this._convertUsePoint.y=Math.floor(e/RpgGameData.GameAoiHeight),this._convertUsePoint},t.computeGameObjDir=function(t,e,i,o){var r,n=App.MathUtils.getRadian2(t,e,i,o),a=App.MathUtils.getAngle(n);return 0==a?r=Dir.Right:90==a?r=Dir.Bottom:180==a?r=Dir.Left:-90==a?r=Dir.Top:a>0&&90>a?r=Dir.BottomRight:a>90&&180>a?r=Dir.BottomLeft:a>-180&&-90>a?r=Dir.TopLeft:a>-90&&0>a&&(r=Dir.TopRight),r},t._convertUsePoint=new egret.Point,t}();__reflect(RpgGameUtils.prototype,"RpgGameUtils");var SilzAstar=function(){function t(t){this.WorkMode=8,this.makeGrid(t)}return t.prototype.find=function(t,e,i,o){i=Math.floor(i/RpgGameData.GameCellWidth),o=Math.floor(o/RpgGameData.GameCellHeight),i=Math.min(i,this._grid.numCols-1),o=Math.min(o,this._grid.numRows-1),this._grid.setEndNode(i,o),t=Math.floor(t/RpgGameData.GameCellWidth),e=Math.floor(e/RpgGameData.GameCellHeight),this._grid.setStartNode(t,e);var r=egret.getTimer();return this._astar.findPath()?(this._path=this._astar.path,this._path):(this._grid.setEndNode(i-1,o-1),r=egret.getTimer()-r,console.log("[SilzAstar]",r+"ms 找不到"),null)},t.prototype.makeGrid=function(t){var e=t.length,i=t[0].length;this._grid=new Grid(i,e);var o,r;for(r=0;e>r;r++)for(o=0;i>o;o++)this._grid.setWalkable(o,r,1==t[r][o]);4==this.WorkMode?this._grid.calculateLinks(1):this._grid.calculateLinks(),this._astar=new AStar(this._grid)},t}();__reflect(SilzAstar.prototype,"SilzAstar");var AStar=function(){function t(t){this._straightCost=1,this._diagCost=Math.SQRT2,this._nowversion=1,this.TwoOneTwoZero=2*Math.cos(Math.PI/3),this._grid=t,this._heuristic=this.manhattan}return t.prototype.justMin=function(t,e){return t.f<e.f},t.prototype.findPath=function(){return this._endNode=this._grid.endNode,this._nowversion++,this._startNode=this._grid.startNode,this._open=new BinaryHeap(this.justMin),this._startNode.g=0,this.search()},t.prototype.floyd=function(){if(null!=this.path){this._floydPath=this.path.concat();var t=this._floydPath.length;if(t>2){var e=new PathNode(0,0),i=new PathNode(0,0);this.floydVector(e,this._floydPath[t-1],this._floydPath[t-2]);for(var o=this._floydPath.length-3;o>=0;o--)this.floydVector(i,this._floydPath[o+1],this._floydPath[o]),e.x==i.x&&e.y==i.y?this._floydPath.splice(o+1,1):(e.x=i.x,e.y=i.y)}for(t=this._floydPath.length,o=t-1;o>=0;o--)for(var r=0;o-2>=r;r++)if(this.floydCrossAble(this._floydPath[o],this._floydPath[r])){for(var n=o-1;n>r;n--)this._floydPath.splice(n,1);o=r,t=this._floydPath.length;break}}},t.prototype.floydCrossAble=function(t,e){for(var i=this.bresenhamNodes(new egret.Point(t.x,t.y),new egret.Point(e.x,e.y)),o=i.length-2;o>0;o--)if(!this._grid.getNode(i[o].x,i[o].y).walkable)return!1;return!0},t.prototype.bresenhamNodes=function(t,e){var i=Math.abs(e.y-t.y)>Math.abs(e.x-t.x);if(i){var o=t.x;t.x=t.y,t.y=o,o=e.x,e.x=e.y,e.y=o}var r=e.x>t.x?1:e.x<t.x?-1:0,n=(e.y>t.y?1:e.y<t.y?-1:0,(e.y-t.y)/Math.abs(e.x-t.x)),a=[],s=t.x+r,h=t.y+n;for(i?a.push(new egret.Point(t.y,t.x)):a.push(new egret.Point(t.x,t.y));s!=e.x;){var p=Math.floor(h),l=Math.ceil(h);i?a.push(new egret.Point(p,s)):a.push(new egret.Point(s,p)),p!=l&&(i?a.push(new egret.Point(l,s)):a.push(new egret.Point(s,l))),s+=r,h+=n}return i?a.push(new egret.Point(e.y,e.x)):a.push(new egret.Point(e.x,e.y)),a},t.prototype.floydVector=function(t,e,i){t.x=e.x-i.x,t.y=e.y-i.y},t.prototype.search=function(){var t=this._startNode;for(t.version=this._nowversion;t!=this._endNode;){for(var e=t.links.length,i=0;e>i;i++){var o=t.links[i].node,r=t.links[i].cost,n=t.g+r,a=this._heuristic(o),s=n+a;o.version==this._nowversion?o.f>s&&(o.f=s,o.g=n,o.h=a,o.parent=t):(o.f=s,o.g=n,o.h=a,o.parent=t,this._open.ins(o),o.version=this._nowversion)}if(1==this._open.a.length)return!1;t=this._open.pop()}return this.buildPath(),!0},t.prototype.buildPath=function(){this._path=[];var t=this._endNode;for(this._path.push(t);t!=this._startNode;)t=t.parent,this._path.unshift(t)},Object.defineProperty(t.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"floydPath",{get:function(){return this._floydPath},enumerable:!0,configurable:!0}),t.prototype.manhattan=function(t){return Math.abs(t.x-this._endNode.x)+Math.abs(t.y-this._endNode.y)},t.prototype.manhattan2=function(t){var e=Math.abs(t.x-this._endNode.x),i=Math.abs(t.y-this._endNode.y);return e+i+Math.abs(e-i)/1e3},t.prototype.euclidian=function(t){var e=t.x-this._endNode.x,i=t.y-this._endNode.y;return Math.sqrt(e*e+i*i)},t.prototype.chineseCheckersEuclidian2=function(t){var e=t.y/this.TwoOneTwoZero,i=t.x+t.y/2,o=i-this._endNode.x-this._endNode.y/2,r=e-this._endNode.y/this.TwoOneTwoZero;return this.sqrt(o*o+r*r)},t.prototype.sqrt=function(t){return Math.sqrt(t)},t.prototype.euclidian2=function(t){var e=t.x-this._endNode.x,i=t.y-this._endNode.y;return e*e+i*i},t.prototype.diagonal=function(t){var e=Math.abs(t.x-this._endNode.x),i=Math.abs(t.y-this._endNode.y),o=Math.min(e,i),r=e+i;return this._diagCost*o+this._straightCost*(r-2*o)},t}();__reflect(AStar.prototype,"AStar");var BinaryHeap=function(){function t(t){void 0===t&&(t=null),this.a=[],this.justMinFun=function(t,e){return e>t},this.a.push(-1),null!=t&&(this.justMinFun=t)}return t.prototype.ins=function(t){var e=this.a.length;this.a[e]=t;for(var i=e>>1;e>1&&this.justMinFun(this.a[e],this.a[i]);){var o=this.a[e];this.a[e]=this.a[i],this.a[i]=o,e=i,i=e>>1}},t.prototype.pop=function(){var t=this.a[1];this.a[1]=this.a[this.a.length-1],this.a.pop();for(var e=1,i=this.a.length,o=e<<1,r=o+1;i>o;){if(i>r)var n=this.justMinFun(this.a[r],this.a[o])?r:o;else n=o;if(!this.justMinFun(this.a[n],this.a[e]))break;var a=this.a[e];this.a[e]=this.a[n],this.a[n]=a,e=n,o=e<<1,r=o+1}return t},t}();__reflect(BinaryHeap.prototype,"BinaryHeap");var Grid=function(){function t(t,e){this._straightCost=1,this._diagCost=Math.SQRT2,this._numCols=t,this._numRows=e,this._nodes=[];for(var i=0;i<this._numCols;i++){this._nodes[i]=[];for(var o=0;o<this._numRows;o++)this._nodes[i][o]=new PathNode(i,o)}}return t.prototype.calculateLinks=function(t){void 0===t&&(t=0),this.type=t;for(var e=0;e<this._numCols;e++)for(var i=0;i<this._numRows;i++)this.initNodeLink(this._nodes[e][i],t)},t.prototype.getType=function(){return this.type},t.prototype.initNodeLink=function(t,e){var i=Math.max(0,t.x-1),o=Math.min(this.numCols-1,t.x+1),r=Math.max(0,t.y-1),n=Math.min(this.numRows-1,t.y+1);t.links=[];for(var a=i;o>=a;a++)for(var s=r;n>=s;s++){var h=this.getNode(a,s);if(h!=t&&h.walkable){if(2!=e&&a!=t.x&&s!=t.y){var p=this.getNode(t.x,s);if(!p.walkable)continue;if(p=this.getNode(a,t.y),!p.walkable)continue}var l=this._straightCost;if(t.x!=h.x&&t.y!=h.y){if(1==e)continue;
if(2==e&&(t.x-h.x)*(t.y-h.y)==1)continue;l=2==e?this._straightCost:this._diagCost}t.links.push(new Link(h,l))}}},t.prototype.getNode=function(t,e){return this._nodes[t][e]},t.prototype.setEndNode=function(t,e){this._endNode=this._nodes[t][e]},t.prototype.setStartNode=function(t,e){this._startNode=this._nodes[t][e]},t.prototype.setWalkable=function(t,e,i){this._nodes[t][e].walkable=i},Object.defineProperty(t.prototype,"endNode",{get:function(){return this._endNode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numCols",{get:function(){return this._numCols},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numRows",{get:function(){return this._numRows},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startNode",{get:function(){return this._startNode},enumerable:!0,configurable:!0}),t}();__reflect(Grid.prototype,"Grid");var Link=function(){function t(t,e){this.node=t,this.cost=e}return t}();__reflect(Link.prototype,"Link");var PathNode=function(){function t(t,e){this.walkable=!0,this.version=1,this.x=t,this.y=e}return t.prototype.toString=function(){return"x:"+this.x+" y:"+this.y},t}();__reflect(PathNode.prototype,"PathNode");var AiComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this),this.resetDealInterval()},e.prototype.stop=function(){t.prototype.stop.call(this)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.entity.battleObj||(this.doMove(),this.resetDealInterval())},e.prototype.resetDealInterval=function(){this.dealInterval=App.RandomUtils.limitInteger(5e3,5e4)},e.prototype.doMove=function(){var t=this.entity.col,e=this.entity.row,i=App.RandomUtils.limitInteger(0,7),o=App.RandomUtils.limitInteger(3,8),r=0,n=0;i==Dir.Top?n=-1:i==Dir.TopRight?(r=1,n=-1):i==Dir.Right?r=1:i==Dir.BottomRight?(r=1,n=1):i==Dir.Bottom?n=1:i==Dir.BottomLeft?(r=-1,n=1):i==Dir.Left?r=-1:i==Dir.TopLeft&&(r=-1,n=-1);for(var a=this.entity.gameView.getBlocksData(),s=[],h=1;o>=h;h++){var p=t+r*h,l=e+n*h;if(!a[l])break;if(!a[l][p])break;s.push(new PathNode(p,l))}s.length>1?this.entity.path=s:this.entity.path=null},e}(Component);__reflect(AiComponent.prototype,"AiComponent");var AoiComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this),this.dealInterval=1e3,this.dealTime=this.dealInterval},e.prototype.stop=function(){t.prototype.stop.call(this)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.setEntityAoi()},e.prototype.setEntityAoi=function(){var t=this.entity.gameView.getGameObjcetLayer(),e=-t.x,i=-t.y,o=e+App.StageUtils.getWidth(),r=i+App.StageUtils.getHeight(),n=RpgGameUtils.convertXYToAoi(e,i).clone(),a=RpgGameUtils.convertXYToAoi(o,r).clone(),s=RpgGameUtils.convertXYToAoi(this.entity.x,this.entity.y),h=s.x>=n.x&&s.x<=a.x&&s.y>=n.y&&s.y<=a.y;h?this.entity.getInCamera()||this.entity.setInCamera(!0):this.entity.getInCamera()&&this.entity.setInCamera(!1)},e}(Component);__reflect(AoiComponent.prototype,"AoiComponent");var AutoBattleComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this),this.dealInterval=500},e.prototype.stop=function(){t.prototype.stop.call(this)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.entity.action==Action.Stand&&(this.entity.battleObj||(this.searchBattleObj(),this.moveToBattleObj()))},e.prototype.searchBattleObj=function(){var t=this.entity.gameView.getMonsters();t.forEach(function(t){t.dis=App.MathUtils.getDistance(t.col,t.row,this.entity.col,this.entity.row)}.bind(this)),t.sort(function(t,e){return t.dis<e.dis?-1:1});for(var e=0;e<t.length;e++){var i=t[e];if(i.propertyData.hp){this.entity.battleObj=i;break}}},e.prototype.moveToBattleObj=function(){if(this.entity.battleObj){var t=0;this.entity.x>this.entity.battleObj.x?t=1:this.entity.x<this.entity.battleObj.x&&(t=-1);var e=0;this.entity.y>this.entity.battleObj.y?e=1:this.entity.y<this.entity.battleObj.y&&(e=-1);var i=this.entity.battleObj.x+t*RpgGameData.GameCellWidth,o=this.entity.battleObj.y+e*RpgGameData.GameCellHeight,r=this.entity.getComponent(ComponentType.Control);r.moveTo(i,o)}},e}(Component);__reflect(AutoBattleComponent.prototype,"AutoBattleComponent");var AvatarComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this),this.mc=ObjectPool.pop("RpgMovieClip"),this.mc.setDefault("avatarDefault_png"),this.mc.setComplateAction(this.complateAction,this),this.body=ObjectPool.pop("egret.DisplayObjectContainer"),this.body.addChild(this.mc),this.entity.gameView.getGameObjcetLayer().addChild(this.body),this.startLoad()},e.prototype.stop=function(){t.prototype.stop.call(this),this.mc.destroy(),this.mc=null,App.DisplayUtils.removeFromParent(this.body),ObjectPool.push(this.body),this.body.removeChildren(),this.body=null},e.prototype.update=function(e){t.prototype.update.call(this,e),this.setPos(),(this.entity.action!=this.mc.getCurrAction()||this.entity.dir!=this.mc.getCurrDir())&&this.mc.gotoAction(this.entity.action,this.entity.dir),this.mc.runAction(e)},e.prototype.complateAction=function(){this.mc.getCurrAction()==Action.Die?this.entity.gameView.removeMonster(this.entity):(this.entity.action=Action.Stand,this.mc.gotoAction(this.entity.action,this.entity.dir))},e.prototype.setPos=function(){this.body.x!=this.entity.x&&(this.body.x=this.entity.x),this.body.y!=this.entity.y&&(this.body.y=this.entity.y)},e.prototype.startLoad=function(){RpgGameRes.loadAvatar(this.entity.mcPath,this.entity.mcName,this.onLoadComplate,this)},e.prototype.onLoadComplate=function(){if(this.isRuning){var t=this.entity.mcName,e=RES.getRes("avatar_"+t+".json"),i=RES.getRes("avatar_"+t+".png"),o=new egret.MovieClipDataFactory(e,i);this.mc.setMcData(o.generateMovieClipData(t))}},e}(Component);__reflect(AvatarComponent.prototype,"AvatarComponent");var AvatarSkillComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this);var e=this.entity.getComponent(ComponentType.Avatar);this.mcParent=e.body,this.mc=ObjectPool.pop("RpgMovieClip"),this.mc.setComplateAction(this.complateAction,this),this.startLoad()},e.prototype.stop=function(){t.prototype.stop.call(this),this.mc.destroy(),this.mc=null,this.mcParent=null},e.prototype.update=function(e){t.prototype.update.call(this,e),this.entity.action!=Action.Attack||this.mc.parent?this.entity.action!=Action.Attack&&this.mc.parent&&this.stopMc():this.startMc(),this.mc.parent&&this.mc.runAction(e)},e.prototype.startMc=function(){this.mc.gotoAction(this.entity.action,this.entity.dir,!0),this.entity.dir==Dir.Top||this.entity.dir==Dir.TopLeft||this.entity.dir==Dir.TopRight?this.mcParent.addChildAt(this.mc,0):this.mcParent.addChild(this.mc)},e.prototype.stopMc=function(){App.DisplayUtils.removeFromParent(this.mc)},e.prototype.complateAction=function(){this.stopMc()},e.prototype.startLoad=function(){RpgGameRes.loadAvatar(this.entity.skillPath,this.entity.mcName+"_attack",this.onLoadComplate,this)},e.prototype.onLoadComplate=function(){if(this.isRuning){var t=this.entity.mcName+"_attack",e=RES.getRes("avatar_"+t+".json"),i=RES.getRes("avatar_"+t+".png"),o=new egret.MovieClipDataFactory(e,i);this.mc.setMcData(o.generateMovieClipData(t))}},e}(Component);__reflect(AvatarSkillComponent.prototype,"AvatarSkillComponent");var BattleComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.stop=function(){t.prototype.stop.call(this),this.isAttacking=!1,this.attackTime=null},e.prototype.update=function(e){t.prototype.update.call(this,e),this.entity.battleObj&&this.entity.action==Action.Stand&&(this.isAttacking?this.canAttack()?this.continueAttack():this.stopAttack():this.canAttack()&&this.startAttack())},e.prototype.canAttack=function(){var t=this.entity.propertyData.attackDis;return Math.abs(this.entity.battleObj.col-this.entity.col)<=t&&Math.abs(this.entity.battleObj.row-this.entity.row)<=t},e.prototype.stopAttack=function(){this.isAttacking=!1,this.attackTime=null,this.entity.battleObj=null},e.prototype.startAttack=function(){this.isAttacking=!0,this.attackTime=egret.getTimer(),this.entity.dir=RpgGameUtils.computeGameObjDir(this.entity.x,this.entity.y,this.entity.battleObj.x,this.entity.battleObj.y),this.entity.action=Action.Attack;var t=this.entity.battleObj;t.battleObj||(t.battleObj=this.entity,t.path=null),egret.setTimeout(this.dealHarm,this,500)},e.prototype.dealHarm=function(){if(this.entity){var t=this.entity.battleObj;if(t){var e=App.RandomUtils.limitInteger(200,800);t.propertyData.hp=Math.max(0,t.propertyData.hp-e),t instanceof RpgMonster?this.entity.gameView.showHpChange(t,-e):this.entity.gameView.showHpChange(t,-e,65280),0==t.propertyData.hp?t instanceof RpgMonster&&(this.entity.battleObj=null,this.entity.gameView.removeMonster(t)):t.action==Action.Stand&&(t.action=Action.Attacked)}}},e.prototype.continueAttack=function(){var t=this.entity.propertyData.attackInterval,e=egret.getTimer();e-this.attackTime>=t&&this.startAttack()},e}(Component);__reflect(BattleComponent.prototype,"BattleComponent");var CameraComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this),this.moveObjs=[],this.moveObjs.push(this.entity.gameView.getGameEffectLayer()),this.moveObjs.push(this.entity.gameView.getGameObjcetLayer()),this.moveObjs.push(this.entity.gameView.getBackground()),this.background=this.entity.gameView.getBackground()},e.prototype.stop=function(){t.prototype.stop.call(this),this.moveObjs=null,this.background=null,this.playerX=null,this.playerY=null,this.playerCol=null,this.playerRow=null},e.prototype.update=function(e){t.prototype.update.call(this,e),this.playerPosChange()&&(this.playerX=this.entity.x,this.playerY=this.entity.y,this.dealMoveObjs()),this.playerCellChange()&&(this.playerCol=this.entity.col,this.playerRow=this.entity.row,this.dealBgCamera())},e.prototype.playerPosChange=function(){return this.playerX!=this.entity.x||this.playerY!=this.entity.y},e.prototype.playerCellChange=function(){return this.playerCol!=this.entity.col||this.playerRow!=this.entity.row},e.prototype.dealMoveObjs=function(){var t=Math.max(this.playerX-.5*App.StageUtils.getWidth(),0),e=Math.max(this.playerY-.5*App.StageUtils.getHeight(),0);t=Math.min(this.background.mapWidth-App.StageUtils.getWidth(),t),e=Math.min(this.background.mapHeight-App.StageUtils.getHeight(),e),this.moveObjs.forEach(function(i){i.x=-t,i.y=-e})},e.prototype.dealBgCamera=function(){this.background.updateCameraPos(this.playerX,this.playerY)},e}(Component);__reflect(CameraComponent.prototype,"CameraComponent");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,o){function r(t){e.call(o,t)}function n(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),i.call(o))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var ComponentSystem=function(){function t(){}return t.addComponent=function(t){this._Components[t.type]||(this._Components[t.type]=[]),this._Components[t.type].push(t)},t.removeComponent=function(t){if(this._Components[t.type]){var e=this._Components[t.type].indexOf(t);-1!=e&&this._Components[t.type].splice(e,1)}},t.start=function(){App.TimerManager.doFrame(1,0,this.onEnterFrame,this)},t.stop=function(){App.TimerManager.remove(this.onEnterFrame,this)},t.onEnterFrame=function(t){this.dealComponents(this._Components[ComponentType.Ai],t),this.dealComponents(this._Components[ComponentType.AutoBattle],t),this.dealComponents(this._Components[ComponentType.Move],t),this.dealComponents(this._Components[ComponentType.Aoi],t),this.dealComponents(this._Components[ComponentType.Battle],t),this.dealComponents(this._Components[ComponentType.Avatar],t),this.dealComponents(this._Components[ComponentType.AvatarSkill],t),this.dealComponents(this._Components[ComponentType.Camera],t),this.dealComponents(this._Components[ComponentType.Sort],t)},t.dealComponents=function(t,e){t&&t.forEach(function(t){t.isRuning&&(t.dealTime+=e,t.dealTime>=t.dealInterval&&(t.dealTime=0,t.update(e)))})},t._Components={},t}();__reflect(ComponentSystem.prototype,"ComponentSystem");var ComponentType=function(){function t(){}return t.Ai="AiComponent",t.Aoi="AoiComponent",t.Avatar="AvatarComponent",t.AvatarSkill="AvatarSkillComponent",t.Camera="CameraComponent",t.Move="MoveComponent",t.Control="ControlComponent",t.Sort="SortComponent",t.Head="HeadComponent",t.AutoBattle="AutoBattleComponent",t.Battle="BattleComponent",t}();__reflect(ComponentType.prototype,"ComponentType");var ControlComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this),this.entity.gameView.touchEnabled=!0,this.entity.gameView.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.astar=new SilzAstar(this.entity.gameView.getBlocksData())},e.prototype.stop=function(){t.prototype.stop.call(this),this.entity.gameView.touchEnabled=!1,this.entity.gameView.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.astar=null},e.prototype.update=function(e){t.prototype.update.call(this,e)},e.prototype.onClick=function(t){var e=t.stageX+-this.entity.gameView.getGameObjcetLayer().x,i=t.stageY+-this.entity.gameView.getGameObjcetLayer().y;this.moveTo(e,i),this.entity.battleObj=null},e.prototype.moveTo=function(t,e){var i=this.entity.x,o=this.entity.y,r=this.astar.find(i,o,t,e);r&&r.length>1?(r.shift(),this.entity.path=r):this.entity.path=null},e}(Component);__reflect(ControlComponent.prototype,"ControlComponent");var HeadComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this);var e=this.entity.getComponent(ComponentType.Avatar);this.createNameTxt(e.body),this.createTitleTxt(e.body)},e.prototype.createNameTxt=function(t){this.nameTxt=new egret.TextField,this.nameTxt.size=18,this.nameTxt.textColor=16777215,this.nameTxt.width=100,this.nameTxt.height=20,this.nameTxt.textAlign=egret.HorizontalAlign.CENTER,this.nameTxt.strokeColor=0,this.nameTxt.stroke=2,this.nameTxt.text=this.entity.propertyData.name,this.nameTxt.y=-160,AnchorUtil.setAnchorX(this.nameTxt,.5),t.addChild(this.nameTxt)},e.prototype.createTitleTxt=function(t){this.titleTxt=new egret.TextField,this.titleTxt.size=18,this.titleTxt.textColor=8900331,this.titleTxt.width=100,this.titleTxt.height=20,this.titleTxt.textAlign=egret.HorizontalAlign.CENTER,this.titleTxt.strokeColor=0,this.titleTxt.stroke=2,this.titleTxt.text=this.entity.propertyData.title,this.titleTxt.y=-180,AnchorUtil.setAnchorX(this.titleTxt,.5),t.addChild(this.titleTxt)},e.prototype.stop=function(){t.prototype.stop.call(this),App.DisplayUtils.removeFromParent(this.nameTxt),this.nameTxt=null,App.DisplayUtils.removeFromParent(this.titleTxt),this.titleTxt=null},e.prototype.update=function(e){t.prototype.update.call(this,e)},e}(Component);__reflect(HeadComponent.prototype,"HeadComponent");var MoveComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.stop=function(){t.prototype.stop.call(this),this.endX=null,this.endY=null,this.radian=null,this.distance=null,this.node=null},e.prototype.update=function(e){if(t.prototype.update.call(this,e),this.entity.pathChange&&(this.entity.pathChange=!1,this.node=null),this.node)this.move(e);else{if(!this.entity.path)return;if(!this.entity.path.length)return void(this.entity.path=null);this.nextNode()}},e.prototype.move=function(t){var e=this.entity.speed/(1e3/60)*t;if(this.distance>e){var i=Math.cos(this.radian)*e,o=Math.sin(this.radian)*e;this.entity.x+=i,this.entity.y+=o,this.distance-=e}else this.entity.x=this.endX,this.entity.y=this.endY,this.entity.col=this.node.x,this.entity.row=this.node.y,this.node=null},e.prototype.nextNode=function(){this.node=this.entity.path.shift();var t=RpgGameUtils.convertCellToXY(this.node.x,this.node.y);this.endX=t.x,this.endY=t.y,this.radian=App.MathUtils.getRadian2(this.entity.x,this.entity.y,this.endX,this.endY),this.distance=App.MathUtils.getDistance(this.entity.x,this.entity.y,this.endX,this.endY),this.entity.dir=RpgGameUtils.computeGameObjDir(this.entity.x,this.entity.y,this.endX,this.endY)},e}(Component);__reflect(MoveComponent.prototype,"MoveComponent");var SortComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this),this.dealInterval=500},e.prototype.stop=function(){t.prototype.stop.call(this)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.sortGameObjs()},e.prototype.sortGameObjs=function(){this.entity.gameView.getGameObjcetLayer().$children.sort(this.sortF)},e.prototype.sortF=function(t,e){return t.y>e.y?1:t.y<e.y?-1:0},e}(Component);__reflect(SortComponent.prototype,"SortComponent");var Dir;!function(t){t[t.Top=0]="Top",t[t.TopRight=1]="TopRight",t[t.Right=2]="Right",t[t.BottomRight=3]="BottomRight",t[t.Bottom=4]="Bottom",t[t.BottomLeft=5]="BottomLeft",t[t.Left=6]="Left",t[t.TopLeft=7]="TopLeft"}(Dir||(Dir={}));var Action=function(){function t(){}return t.Prepare="prepare",t.Attack="attack",t.Attacked="attacked",t.Die="die",t.Move="move",t.Stand="stand",t}();__reflect(Action.prototype,"Action");var RpgMovieClip=function(t){function e(){var e=t.call(this)||this;return e.McFrameTime=125,e}return __extends(e,t),e.prototype.setBitmap=function(t,e){this.texture=t,this.scaleX=e,AnchorUtil.setAnchorX(this,.5),AnchorUtil.setAnchorY(this,1)},e.prototype.setDefault=function(t){this.setBitmap(RES.getRes(t),1)},e.prototype.setMcData=function(t){this.mcData=t},e.prototype.runAction=function(t){if(this.mcData&&(this.currFrameTime+=t,this.currFrameTime>=this.McFrameTime))if(this.currFrameTime=0,this.currFrame++,this.currFrame>this.endFrame&&(this.currFrame=this.startFrame,this.currPlayNum++),this.totalPlayNum&&this.currPlayNum>=this.totalPlayNum)this.complateAction&&this.complateAction.apply(this.complateActionObj);else{var e=this.mcData.getTextureByFrame(this.currFrame);this.setBitmap(e,this.scaleX)}},e.prototype.gotoAction=function(t,e,i){if(void 0===i&&(i=!1),this.mcData&&(i||this.currAction!=t||this.currDir!=e)){var o=0;(t==Action.Attack||t==Action.Attacked||t==Action.Die)&&(o=1);var r,n;e==Dir.Top?(r=0,n=1):e==Dir.TopRight?(r=1,n=1):e==Dir.Right?(r=2,n=1):e==Dir.BottomRight?(r=3,n=1):e==Dir.Bottom?(r=4,n=1):e==Dir.BottomLeft?(r=3,n=-1):e==Dir.Left?(r=2,n=-1):e==Dir.TopLeft&&(r=1,n=-1);for(var a,s=t+"_"+r,h=0;h<this.mcData.labels.length;h++)s==this.mcData.labels[h].name&&(a=this.mcData.labels[h]);this.currAction!=t||i?(this.currFrame=a.frame,this.currFrameTime=0):this.currFrame=a.frame+(this.currFrame-this.startFrame),this.startFrame=a.frame,this.endFrame=a.end,this.currAction=t,this.currDir=e,this.totalPlayNum=o,this.currPlayNum=0;var p=this.mcData.getTextureByFrame(this.currFrame);this.setBitmap(p,n)}},e.prototype.setComplateAction=function(t,e){this.complateAction=t,this.complateActionObj=e},e.prototype.destroy=function(){App.DisplayUtils.removeFromParent(this),ObjectPool.push(this),this.texture=null,this.mcData=null,this.currAction=null,this.currDir=null,this.currFrame=null,this.startFrame=null,this.endFrame=null,this.currFrameTime=null,this.totalPlayNum=null,this.currPlayNum=null,this.complateAction=null,this.complateActionObj=null},e.prototype.getCurrAction=function(){return this.currAction},e.prototype.getCurrDir=function(){return this.currDir},e}(egret.Bitmap);__reflect(RpgMovieClip.prototype,"RpgMovieClip");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var RpgMonster=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.addComponent(ComponentType.Aoi),this.addComponent(ComponentType.Ai),this.addComponent(ComponentType.Move)},e.prototype.setInCamera=function(e){t.prototype.setInCamera.call(this,e),e?(this.addComponent(ComponentType.Avatar),this.addComponent(ComponentType.Battle)):(this.removeComponent(ComponentType.Avatar),this.removeComponent(ComponentType.Battle))},e.prototype.destory=function(){t.prototype.destory.call(this)},e}(RpgGameObject);__reflect(RpgMonster.prototype,"RpgMonster");var RpgPlayer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.addComponent(ComponentType.Avatar),this.addComponent(ComponentType.AvatarSkill),this.addComponent(ComponentType.Head),this.addComponent(ComponentType.Move),this.addComponent(ComponentType.Camera),this.addComponent(ComponentType.Sort),this.addComponent(ComponentType.Control),this.addComponent(ComponentType.AutoBattle),this.addComponent(ComponentType.Battle)},e.prototype.destory=function(){t.prototype.destory.call(this)},e}(RpgGameObject);__reflect(RpgPlayer.prototype,"RpgPlayer");var RpgBackground=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t){this.mapId=t;var e=RES.getRes("map_"+t+"_data.json");this.mapWidth=e.width,this.mapHeight=e.height,this.miniBg=new egret.Bitmap,this.miniBg.texture=RES.getRes("map_"+t+"_mini.jpg"),this.miniBg.width=this.mapWidth,this.miniBg.height=this.mapHeight,this.addChild(this.miniBg),this.tiles=new RpgTiles,this.tiles.init(t),this.addChild(this.tiles)},e.prototype.updateCameraPos=function(t,e){this.tiles.updateCameraPos(t,e)},e}(egret.DisplayObjectContainer);__reflect(RpgBackground.prototype,"RpgBackground");var RpgGameView=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.background=new RpgBackground,this.addChild(this.background),this.gameObjcetLayer=new egret.DisplayObjectContainer,this.addChild(this.gameObjcetLayer),this.gameEffectLayer=new egret.DisplayObjectContainer,this.addChild(this.gameEffectLayer)},e.prototype.initData=function(){t.prototype.initData.call(this),this.monsters=[]},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e);var o=e[0];this.initBackground(o.mapId),this.initBlocks(o.mapId),this.createPlayer(o.playerData),this.createMonsters(o.monsterNum)},e.prototype.initBackground=function(t){this.background.init(t)},e.prototype.initBlocks=function(t){var e=RES.getRes("map_"+t+"_data.json");this.blocksData=e.blocks},e.prototype.createPlayer=function(t){var e=App.RandomUtils.limitInteger(1,this.blocksData[0].length-2),i=App.RandomUtils.limitInteger(1,this.blocksData.length-2);this.player=ObjectPool.pop("RpgPlayer"),this.player.init({col:e,row:i,mcName:t.mcName,mcPath:"resource/assets/rpgGame/player/",skillPath:"resource/assets/rpgGame/skill/",gameView:this,propertyData:t.propertyData})},e.prototype.createMonsters=function(t){for(var e=[],i=0;t>i;i++){var o=App.RandomUtils.limitInteger(1,this.blocksData[0].length-2),r=App.RandomUtils.limitInteger(1,this.blocksData.length-2),n="monster_"+App.RandomUtils.limitInteger(0,9),a="resource/assets/rpgGame/monster/";e.push({col:o,row:r,mcName:n,mcPath:a,gameView:this,dis:App.MathUtils.getDistance(o,r,this.player.col,this.player.row),propertyData:{name:"monster_"+App.RandomUtils.limitInteger(1,1e3),attackDis:3,attackInterval:3e3,hp:2e3}})}e.sort(function(t,e){return t.dis<e.dis?-1:1});var s=new FrameExecutor(1);e.forEach(function(t){s.regist(function(){var e=ObjectPool.pop("RpgMonster");e.init(t),this.monsters.push(e)},this)}.bind(this)),s.execute()},e.prototype.showHpChange=function(t,e,i){void 0===i&&(i=16711680);var o=ObjectPool.pop("egret.TextField");o.size=25,o.textColor=i,o.width=100,o.height=20,o.textAlign=egret.HorizontalAlign.CENTER,o.strokeColor=0,o.stroke=2,o.text=e.toString(),o.x=t.x,o.y=t.y-150,o.alpha=1,AnchorUtil.setAnchorX(o,.5),this.gameEffectLayer.addChild(o),egret.Tween.get(o).to({y:t.y-250,alpha:0},1e3).call(function(){App.DisplayUtils.removeFromParent(o),ObjectPool.push(o)})},e.prototype.removeMonster=function(t){var e=this.monsters.indexOf(t);-1!=e&&this.monsters.splice(e,1),t.destory(),t=null},e.prototype.resize=function(){if(this.player){var t=this.player.getComponent(ComponentType.Camera);t.dealMoveObjs(),t.dealBgCamera()}},e.prototype.getBlocksData=function(){return this.blocksData},e.prototype.getGameObjcetLayer=function(){return this.gameObjcetLayer},e.prototype.getGameEffectLayer=function(){return this.gameEffectLayer},e.prototype.getBackground=function(){return this.background},e.prototype.getMonsters=function(){return this.monsters},e}(BaseSpriteView);__reflect(RpgGameView.prototype,"RpgGameView");var RpgTile=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t,e,i){this.col=e,this.row=i,this.x=this.col*RpgGameData.GameTileWidth,this.y=this.row*RpgGameData.GameTileHeight;var o=i+"_"+e+".jpg",r="resource/assets/rpgGame/map/"+t+"/"+o;this.tileResKey="map_"+t+"_"+o,App.ResourceUtils.createResource(this.tileResKey,"image",r),RES.getResAsync(this.tileResKey,function(t){this.texture=t},this)},e.prototype.destory=function(){App.DisplayUtils.removeFromParent(this),RES.destroyRes(this.tileResKey),this.texture=null},e}(egret.Bitmap);__reflect(RpgTile.prototype,"RpgTile");var RpgTiles=function(t){function e(){var e=t.call(this)||this;return e.tiles=[],e.screenTiles=[],e}return __extends(e,t),e.prototype.init=function(t){this.mapId=t;var e=RES.getRes("map_"+t+"_data.json");this.cols=Math.floor(e.width/RpgGameData.GameTileWidth),this.rows=Math.floor(e.height/RpgGameData.GameTileHeight)},e.prototype.updateCameraPos=function(t,e){var i=Math.round(t/RpgGameData.GameTileWidth),o=Math.round(e/RpgGameData.GameTileHeight),r=Math.ceil(App.StageUtils.getWidth()/RpgGameData.GameTileWidth)+1,n=Math.ceil(App.StageUtils.getHeight()/RpgGameData.GameTileHeight)+1,a=Math.ceil(r/2),s=Math.ceil(n/2),h=i-a,p=i+a;0>h&&(p+=-h,h=0),p>this.cols&&(h-=p-this.cols,p=this.cols);var l=o-s,c=o+s;0>l&&(c+=-l,l=0),c>this.rows&&(l-=c-this.rows,c=this.rows);for(var u=[],d=h;p>=d;d++)for(var g=l;c>=g;g++){var f=d+"_"+g,y=this.tiles[f];y||(y=new RpgTile,y.init(this.mapId,d,g),this.tiles[f]=y),y.parent||this.addChild(y),u.push(f)}this.screenTiles.forEach(function(t){if(-1==u.indexOf(t)){var e=this.tiles[t];e&&App.DisplayUtils.removeFromParent(e)}}.bind(this)),this.screenTiles=u},e.prototype.destory=function(){for(var t=Object.keys(this.tiles),e=0;e<t.length;e++){var i=t[e],o=this.tiles[i];o.destory(),this.tiles[i]=null,delete this.tiles[i]}this.screenTiles.splice(0)},e}(egret.DisplayObjectContainer);__reflect(RpgTiles.prototype,"RpgTiles");var ShopController=function(t){function e(){var e=t.call(this)||this;return e.shopView=new ShopView(e,LayerManager.UI_Popup),App.ViewManager.register(ViewConst.Shop,e.shopView),e}return __extends(e,t),e}(BaseController);__reflect(ShopController.prototype,"ShopController");var ShopView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.icon="table_shop",o}return __extends(e,t),e.prototype.initData=function(){t.prototype.initData.call(this);var e=new eui.ArrayCollection;e.addItem({title:"普通化肥",price:"3",time:"-5分钟",icon:"icon_fertilizer02"}),e.addItem({title:"高速化肥",price:"5",time:"-10分钟",icon:"icon_fertilizer03"}),e.addItem({title:"飞速化肥",price:"15",time:"-30分钟",icon:"icon_fertilizer04"}),e.addItem({title:"神速化肥",price:"25",time:"-60分钟",icon:"icon_fertilizer05"}),e.addItem({title:"普通化肥",price:"3",time:"-5分钟",icon:"icon_fertilizer02"}),e.addItem({title:"高速化肥",price:"5",time:"-10分钟",icon:"icon_fertilizer03"}),e.addItem({title:"飞速化肥",price:"15",time:"-30分钟",icon:"icon_fertilizer04"}),e.addItem({title:"神速化肥",price:"25",time:"-60分钟",icon:"icon_fertilizer05"}),e.addItem({title:"普通化肥",price:"3",time:"-5分钟",icon:"icon_fertilizer02"}),e.addItem({title:"高速化肥",price:"5",time:"-10分钟",icon:"icon_fertilizer03"}),e.addItem({title:"飞速化肥",price:"15",time:"-30分钟",icon:"icon_fertilizer04"}),e.addItem({title:"神速化肥",price:"25",time:"-60分钟",icon:"icon_fertilizer05"});var i=new eui.ArrayCollection;i.addItem({title:"神速化肥",price:"25",time:"-60分钟",icon:"icon_fertilizer05"}),i.addItem({title:"普通化肥",price:"3",time:"-5分钟",icon:"icon_fertilizer02"}),i.addItem({title:"高速化肥",price:"5",time:"-10分钟",icon:"icon_fertilizer03"}),i.addItem({title:"飞速化肥",price:"15",time:"-30分钟",icon:"icon_fertilizer04"}),i.addItem({title:"神速化肥",price:"25",time:"-60分钟",icon:"icon_fertilizer05"}),i.addItem({title:"普通化肥",price:"3",time:"-5分钟",icon:"icon_fertilizer02"}),i.addItem({title:"高速化肥",price:"5",time:"-10分钟",icon:"icon_fertilizer03"}),i.addItem({title:"飞速化肥",price:"15",time:"-30分钟",icon:"icon_fertilizer04"}),i.addItem({title:"神速化肥",price:"25",time:"-60分钟",icon:"icon_fertilizer05"}),i.addItem({title:"普通化肥",price:"3",time:"-5分钟",icon:"icon_fertilizer02"}),i.addItem({title:"高速化肥",price:"5",time:"-10分钟",icon:"icon_fertilizer03"}),i.addItem({title:"飞速化肥",price:"15",time:"-30分钟",icon:"icon_fertilizer04"});var o=new TabBarContainer;o.addViewStackElement("text_fertilizer01","text_fertilizer02",this.createList(e)),o.addViewStackElement("text_seed01","text_seed02",this.createList(i)),o.horizontalCenter=0,this.contentGroup.addChild(o)},e.prototype.createList=function(t){var e=new eui.TileLayout;e.requestedColumnCount=2;var i=new eui.List;i.layout=e,i.itemRenderer=SaleItemRenderer,i.itemRendererSkinName="resource/skins/SaleItemSkin.exml",i.dataProvider=t;var o=new eui.Scroller;return o.percentWidth=o.percentHeight=100,o.viewport=i,o},e}(BasePanelView);__reflect(ShopView.prototype,"ShopView");var DailyView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.icon="table_activity",o}return __extends(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.dataProvider.addItem({icon:"icon_experience",gold:"+50",seed:"+200",label:"帮助好友5次",progress:"0/5"}),this.dataProvider.addItem({icon:"icon_fertilization",gold:"+120",seed:"+100",label:"帮助好友10次",progress:"0/10"}),this.dataProvider.addItem({icon:"icon_diamond",gold:"+520",seed:"+500",label:"帮助好友100次",progress:"0/100"}),this.dataProvider.addItem({icon:"icon_experience",gold:"+50",seed:"+200",label:"帮助好友5次",progress:"0/5"}),this.dataProvider.addItem({icon:"icon_fertilization",gold:"+120",seed:"+100",label:"帮助好友10次",progress:"0/10"}),this.dataProvider.addItem({icon:"icon_diamond",gold:"+520",seed:"+500",label:"帮助好友100次",progress:"0/100"}),this.dataProvider.addItem({icon:"icon_experience",gold:"+50",seed:"+200",label:"帮助好友5次",progress:"0/5"}),this.dataProvider.addItem({icon:"icon_fertilization",gold:"+120",seed:"+100",label:"帮助好友10次",progress:"0/10"}),this.dataProvider.addItem({icon:"icon_diamond",gold:"+520",seed:"+500",label:"帮助好友100次",progress:"0/100"}),this.dataProvider.addItem({icon:"icon_experience",gold:"+50",seed:"+200",label:"帮助好友5次",progress:"0/5"}),this.dataProvider.addItem({icon:"icon_fertilization",gold:"+120",seed:"+100",label:"帮助好友10次",progress:"0/10"}),this.dataProvider.addItem({icon:"icon_diamond",gold:"+520",seed:"+500",label:"帮助好友100次",progress:"0/100"}),this.dataProvider.addItem({icon:"icon_experience",gold:"+50",seed:"+200",label:"帮助好友5次",progress:"0/5"}),this.dataProvider.addItem({icon:"icon_fertilization",gold:"+120",seed:"+100",label:"帮助好友10次",progress:"0/10"}),this.dataProvider.addItem({icon:"icon_diamond",gold:"+520",seed:"+500",label:"帮助好友100次",progress:"0/100"})
},e}(BaseTaskView);__reflect(DailyView.prototype,"DailyView");var TaskController=function(t){function e(){var e=t.call(this)||this;return e.taskView=new TaskView(e,LayerManager.UI_Popup),App.ViewManager.register(ViewConst.Task,e.taskView),e.dailyView=new DailyView(e,LayerManager.UI_Popup),App.ViewManager.register(ViewConst.Daily,e.dailyView),e}return __extends(e,t),e}(BaseController);__reflect(TaskController.prototype,"TaskController");var TaskView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.icon="table_task",o}return __extends(e,t),e.prototype.initData=function(){t.prototype.initData.call(this),this.dataProvider.addItem({icon:"icon_experience",gold:"+50",seed:"+200",label:"帮助好友5次",progress:"0/5"}),this.dataProvider.addItem({icon:"icon_fertilization",gold:"+120",seed:"+100",label:"帮助好友10次",progress:"0/10"}),this.dataProvider.addItem({icon:"icon_diamond",gold:"+520",seed:"+500",label:"帮助好友100次",progress:"0/100"}),this.dataProvider.addItem({icon:"icon_experience",gold:"+50",seed:"+200",label:"帮助好友5次",progress:"0/5"}),this.dataProvider.addItem({icon:"icon_fertilization",gold:"+120",seed:"+100",label:"帮助好友10次",progress:"0/10"}),this.dataProvider.addItem({icon:"icon_diamond",gold:"+520",seed:"+500",label:"帮助好友100次",progress:"0/100"}),this.dataProvider.addItem({icon:"icon_experience",gold:"+50",seed:"+200",label:"帮助好友5次",progress:"0/5"}),this.dataProvider.addItem({icon:"icon_fertilization",gold:"+120",seed:"+100",label:"帮助好友10次",progress:"0/10"}),this.dataProvider.addItem({icon:"icon_diamond",gold:"+520",seed:"+500",label:"帮助好友100次",progress:"0/100"}),this.dataProvider.addItem({icon:"icon_experience",gold:"+50",seed:"+200",label:"帮助好友5次",progress:"0/5"}),this.dataProvider.addItem({icon:"icon_fertilization",gold:"+120",seed:"+100",label:"帮助好友10次",progress:"0/10"}),this.dataProvider.addItem({icon:"icon_diamond",gold:"+520",seed:"+500",label:"帮助好友100次",progress:"0/100"}),this.dataProvider.addItem({icon:"icon_experience",gold:"+50",seed:"+200",label:"帮助好友5次",progress:"0/5"}),this.dataProvider.addItem({icon:"icon_fertilization",gold:"+120",seed:"+100",label:"帮助好友10次",progress:"0/10"}),this.dataProvider.addItem({icon:"icon_diamond",gold:"+520",seed:"+500",label:"帮助好友100次",progress:"0/100"})},e}(BaseTaskView);__reflect(TaskView.prototype,"TaskView");var WarehouseController=function(t){function e(){var e=t.call(this)||this;return e.warehouseView=new WarehouseView(e,LayerManager.UI_Popup),App.ViewManager.register(ViewConst.Warehouse,e.warehouseView),e}return __extends(e,t),e}(BaseController);__reflect(WarehouseController.prototype,"WarehouseController");var WarehouseView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.icon="table_warehouse",o.btn="icon_sale",o}return __extends(e,t),e.prototype.initData=function(){t.prototype.initData.call(this);var e=new eui.ArrayCollection;e.addItem({title:"普通化肥",price:"3",time:"-5分钟",icon:"icon_fertilizer02"}),e.addItem({title:"高速化肥",price:"5",time:"-10分钟",icon:"icon_fertilizer03"}),e.addItem({title:"飞速化肥",price:"15",time:"-30分钟",icon:"icon_fertilizer04"}),e.addItem({title:"神速化肥",price:"25",time:"-60分钟",icon:"icon_fertilizer05"}),e.addItem({title:"普通化肥",price:"3",time:"-5分钟",icon:"icon_fertilizer02"}),e.addItem({title:"高速化肥",price:"5",time:"-10分钟",icon:"icon_fertilizer03"}),e.addItem({title:"飞速化肥",price:"15",time:"-30分钟",icon:"icon_fertilizer04"}),e.addItem({title:"神速化肥",price:"25",time:"-60分钟",icon:"icon_fertilizer05"}),e.addItem({title:"普通化肥",price:"3",time:"-5分钟",icon:"icon_fertilizer02"}),e.addItem({title:"高速化肥",price:"5",time:"-10分钟",icon:"icon_fertilizer03"}),e.addItem({title:"飞速化肥",price:"15",time:"-30分钟",icon:"icon_fertilizer04"}),e.addItem({title:"神速化肥",price:"25",time:"-60分钟",icon:"icon_fertilizer05"});var i=new eui.ArrayCollection;i.addItem({title:"神速化肥",price:"25",time:"-60分钟",icon:"icon_fertilizer05"}),i.addItem({title:"普通化肥",price:"3",time:"-5分钟",icon:"icon_fertilizer02"}),i.addItem({title:"高速化肥",price:"5",time:"-10分钟",icon:"icon_fertilizer03"}),i.addItem({title:"飞速化肥",price:"15",time:"-30分钟",icon:"icon_fertilizer04"}),i.addItem({title:"神速化肥",price:"25",time:"-60分钟",icon:"icon_fertilizer05"}),i.addItem({title:"普通化肥",price:"3",time:"-5分钟",icon:"icon_fertilizer02"}),i.addItem({title:"高速化肥",price:"5",time:"-10分钟",icon:"icon_fertilizer03"}),i.addItem({title:"飞速化肥",price:"15",time:"-30分钟",icon:"icon_fertilizer04"}),i.addItem({title:"神速化肥",price:"25",time:"-60分钟",icon:"icon_fertilizer05"}),i.addItem({title:"普通化肥",price:"3",time:"-5分钟",icon:"icon_fertilizer02"}),i.addItem({title:"高速化肥",price:"5",time:"-10分钟",icon:"icon_fertilizer03"}),i.addItem({title:"飞速化肥",price:"15",time:"-30分钟",icon:"icon_fertilizer04"});var o=new TabBarContainer;o.addViewStackElement("text_seed01","text_seed02",this.createList(e)),o.addViewStackElement("text_fruit_01","text_fruit_02",this.createList(i)),o.addViewStackElement("text_fruit_juice_01","text_fruit_juice_02",this.createList(e)),o.horizontalCenter=0,this.contentGroup.addChild(o)},e.prototype.createList=function(t){var e=new eui.TileLayout;e.requestedColumnCount=2;var i=new eui.List;i.layout=e,i.itemRenderer=SaleItemRenderer,i.itemRendererSkinName="resource/skins/SaleItemSkin.exml",i.dataProvider=t;var o=new eui.Scroller;return o.percentWidth=o.percentHeight=100,o.viewport=i,o},e}(BasePanelView);__reflect(WarehouseView.prototype,"WarehouseView");var GameScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayerAt(LayerManager.Game_Main,0),App.ViewManager.open(ViewConst.Game),App.ViewManager.open(ViewConst.GameUI),App.SoundManager.playBg("sound_bg")},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(GameScene.prototype,"GameScene");var LayerManager=function(){function t(){}return t.Game_Bg=new BaseSpriteLayer,t.Game_Main=new BaseSpriteLayer,t.UI_Main=new BaseEuiLayer,t.UI_Popup=new BaseEuiLayer,t.UI_Message=new BaseEuiLayer,t.UI_Tips=new BaseEuiLayer,t}();__reflect(LayerManager.prototype,"LayerManager");var LoadingScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main),App.ViewManager.open(ViewConst.Loading)},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(LoadingScene.prototype,"LoadingScene");var RpgGameScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onEnter=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.onEnter.call(this);var o=e[0];ComponentSystem.start(),this.addLayerAt(LayerManager.Game_Main,0),this.addLayer(LayerManager.UI_Main),this.addLayer(LayerManager.UI_Popup),this.addLayer(LayerManager.UI_Message),this.addLayer(LayerManager.UI_Tips),App.ControllerManager.applyFunc(ControllerConst.RpgGame,RpgGameConst.GameInit,o),App.ViewManager.open(ViewConst.Home),App.SoundManager.playBg("sound_bg")},e.prototype.onExit=function(){t.prototype.onExit.call(this),ComponentSystem.stop()},e}(BaseScene);__reflect(RpgGameScene.prototype,"RpgGameScene");var UIScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main),this.addLayer(LayerManager.UI_Popup),this.addLayer(LayerManager.UI_Message),this.addLayer(LayerManager.UI_Tips);var e=new eui.Rect;e.fillColor=7911743,e.percentHeight=100,e.percentWidth=100,LayerManager.UI_Main.addChild(e),App.ViewManager.open(ViewConst.Home),App.SoundManager.playBg("sound_bg")},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(UIScene.prototype,"UIScene");var ActTest=function(){function t(){var t="preload",e=["preload_core","preload_battle"];App.ResourceUtils.loadGroups(t,e,this.onResourceLoadComplete,this.onResourceLoadProgress,this)}return t.prototype.onResourceLoadComplete=function(){this.initModule(),App.Init(),App.SoundManager.setBgOn(!0),App.SoundManager.setEffectOn(!0),this.initBattleDragonBones(),App.SceneManager.runScene(SceneConsts.Game)},t.prototype.onResourceLoadProgress=function(t,e){App.ControllerManager.applyFunc(ControllerConst.Loading,LoadingConst.SetProgress,t,e)},t.prototype.initBattleDragonBones=function(){for(var t=["zhujue1","zhujue2","guaiwu001","jineng1","jineng2","guaiwu002","guaiwu002_effect","guaiwu003","guaiwu003_effect"],e=0,i=t.length;i>e;e++){var o=t[e],r=RES.getRes(o+"_skeleton_json"),n=RES.getRes(o+"_texture_png"),a=RES.getRes(o+"_texture_json");App.DragonBonesFactory.initArmatureFile(r,n,a)}},t.prototype.initModule=function(){App.ControllerManager.register(ControllerConst.Game,new GameController)},t}();__reflect(ActTest.prototype,"ActTest");var EUITest=function(){function t(){var t="preload",e=["preload_core","preload_ui"];App.ResourceUtils.loadGroups(t,e,this.onResourceLoadComplete,this.onResourceLoadProgress,this)}return t.prototype.onResourceLoadComplete=function(){this.initModule(),App.Init(),App.SoundManager.setBgOn(!0),App.SoundManager.setEffectOn(!App.DeviceUtils.IsHtml5||!App.DeviceUtils.IsMobile),App.SceneManager.runScene(SceneConsts.UI)},t.prototype.onResourceLoadProgress=function(t,e){App.ControllerManager.applyFunc(ControllerConst.Loading,LoadingConst.SetProgress,t,e)},t.prototype.initModule=function(){App.ControllerManager.register(ControllerConst.Login,new LoginController),App.ControllerManager.register(ControllerConst.Home,new HomeController),App.ControllerManager.register(ControllerConst.Friend,new FriendController),App.ControllerManager.register(ControllerConst.Shop,new ShopController),App.ControllerManager.register(ControllerConst.Warehouse,new WarehouseController),App.ControllerManager.register(ControllerConst.Factory,new FactoryController),App.ControllerManager.register(ControllerConst.Task,new TaskController),App.ControllerManager.register(ControllerConst.Mail,new MailController)},t}();__reflect(EUITest.prototype,"EUITest");var ProtoBufTest=function(){function t(){App.ResourceUtils.loadGroup("preload_core",this.onResourceLoadComplete,this.onResourceLoadProgress,this)}return t.prototype.onResourceLoadComplete=function(){App.Init(),this.clientTest(),this.socketTest()},t.prototype.onResourceLoadProgress=function(t,e){App.ControllerManager.applyFunc(ControllerConst.Loading,LoadingConst.SetProgress,t,e)},t.prototype.clientTest=function(){var t=dcodeIO.ProtoBuf.loadProto(RES.getRes("simple_proto")),e=t.build("user_login_c2s"),i=new e({accid:888,tstamp:999,ticket:"yangsong"}),o=i.toArrayBuffer();Log.trace("序列化数据：",o);var r=e.decode(o);Log.trace("反序列化数据：",r)},t.prototype.socketTest=function(){function t(){var t={};t.key="user_login_c2s",t.body={accid:888,tstamp:999,ticket:"yangsong"},App.Socket.send(t)}App.Socket.connect(),App.MessageCenter.addListener(SocketConst.SOCKET_CONNECT,function(){Log.trace("与服务器连接上"),t()},this),App.MessageCenter.addListener(SocketConst.SOCKET_RECONNECT,function(){Log.trace("与服务器重新连接上"),t()},this),App.MessageCenter.addListener(SocketConst.SOCKET_START_RECONNECT,function(){Log.trace("开始与服务器重新连接")},this),App.MessageCenter.addListener(SocketConst.SOCKET_CLOSE,function(){Log.trace("与服务器断开连接")},this),App.MessageCenter.addListener(SocketConst.SOCKET_NOCONNECT,function(){Log.trace("服务器连接不上")},this),App.MessageCenter.addListener("10001",function(t){Log.trace("收到服务器消息:",t)},this)},t}();__reflect(ProtoBufTest.prototype,"ProtoBufTest");var RpgTest=function(){function t(){this.mapId=1193,this.mapGroupKey="map_"+this.mapId,this.initMapResource();var t="preload",e=["preload_core","preload_ui","preload_rpg",this.mapGroupKey];App.ResourceUtils.loadGroups(t,e,this.onResourceLoadComplete,this.onResourceLoadProgress,this)}return t.prototype.initMapResource=function(){var t="resource/assets/rpgGame/map/"+this.mapId+"/",e=this.mapGroupKey+"_",i=[],o=[{name:"data.json",type:"json"},{name:"mini.jpg",type:"image"}];o.forEach(function(o){var r=e+o.name;App.ResourceUtils.createResource(r,o.type,t+o.name),i.push(r)}),App.ResourceUtils.createGroup(this.mapGroupKey,i)},t.prototype.onResourceLoadComplete=function(){this.initModule(),App.Init(),App.SoundManager.setBgOn(!1),App.SoundManager.setEffectOn(!1),App.SceneManager.runScene(SceneConsts.RpgGame,this.mapId)},t.prototype.onResourceLoadProgress=function(t,e){App.ControllerManager.applyFunc(ControllerConst.Loading,LoadingConst.SetProgress,t,e)},t.prototype.initModule=function(){App.ControllerManager.register(ControllerConst.Login,new LoginController),App.ControllerManager.register(ControllerConst.Home,new HomeController),App.ControllerManager.register(ControllerConst.Friend,new FriendController),App.ControllerManager.register(ControllerConst.Shop,new ShopController),App.ControllerManager.register(ControllerConst.Warehouse,new WarehouseController),App.ControllerManager.register(ControllerConst.Factory,new FactoryController),App.ControllerManager.register(ControllerConst.Task,new TaskController),App.ControllerManager.register(ControllerConst.Mail,new MailController),App.ControllerManager.register(ControllerConst.RpgGame,new RpgGameController)},t}();__reflect(RpgTest.prototype,"RpgTest");var StarlingSwfTest=function(){function t(){App.StarlingSwfFactory.addSwf("bossMC",RES.getRes("bossMC_swf_json"),RES.getRes("bossMC_json"));App.StarlingSwfFactory.makeMc("boss_whiteBear")}return t}();__reflect(StarlingSwfTest.prototype,"StarlingSwfTest");